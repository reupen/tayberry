{"version":3,"sources":["/source/node_modules/browserify/node_modules/browser-pack/_prelude.js","/source/src/axis.js","tayberry.min.js","/source/src/base.js","/source/src/core.js","/source/src/defaults.js","/source/src/drawing.js","/source/src/events.js","/source/src/helpers/colour.js","/source/src/helpers/easing.js","/source/src/helpers/rect.js","/source/src/helpers/utils.js","/source/src/renderer.bar.js","/source/src/renderer.base.js","/source/src/renderer.line.js","/source/src/sizing.js","/source/src/tayberry.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","Tayberry","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_classCallCheck","instance","Constructor","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","_createClass","defineProperties","target","props","descriptor","defineProperty","key","protoProps","staticProps","Utils","Axis","tayberry","index","options","axisType","isHorizontal","tickStep","min","max","tickStart","tickEnd","calculatedSize","topAdjustment","rightAdjustment","titleFont","labelFont","numLabelLines","setPlacement","xYSwapped","type","LinearAxis","CategorialAxis","createFontString","font","title","validAndSpecificPlacements","indexOf","placement","isVertical","_this","tb","ticks","getTicks","reduce","Math","x","getTextWidth","labelFormatter","mapLogicalXUnit","mapLogicalYUnit","plotArea","fixedOnly","reset","size","ret","titleFontHeight","getFontHeight","fontHeight","mapLogicalXOrYUnit","elementSmallPadding","text","lastTick","lastTickYStart","y","top","adjustment","maxLabelSize","lastXEnd","tick","textWidth","xStart","xEnd","lastTickXEnd","right","isPlacedAtStart","left","bottom","offsetRect","drawTicksAndLabels","drawTitle","_this2","labelPadding","labelPaddingX","labelPaddingY","xOffset","startProperty","yOffset","labelsCtx","save","fillStyle","colour","textAlign","textBaseline","lastXEnds","tickIndex","maxWidth","enumerateTicks","formattedValue","row","rowOffset","labelsCanvas","width","fillText","gridLines","drawLine","x1","y1","x2","y2","adjustOffsetRect","restore","displacement","labelPaddingSize","yMidpoint","translate","rotate","PI","xMidpoint","visibleOnly","arguments","get","_Axis","getPrototypeOf","apply","callback","categoryCount","categories","clone","swapXY","categoryWidth","factor","labelPosition","floor","_ref","identity","getOrigin","plotDisplacement","ceil","height","_Axis2","labelFormat","createPercentageFormatter","labelPrefix","labelSuffix","createFixedNumberFormatter","currencySymbol","createAutoNumberFormatter","start","end","endProperty","yValue","getValueDisplacement","round","targetTicks","approxStep","scale","targetStart","targetEnd","overriddenStart","isMissingValue","overriddenEnd","_ref2","isYAxis","getDataMinMax","getDataXMinMax","_ref3","dataMin","dataMax","dataRange","tickStepValue","targetRange","plotLength","mapLogicalYOrXUnit","pow","log","scaledStep","snapScaledValue","totalCategories","isRange","axisRange","formatString","abs","./helpers/utils.js",2,"selectedItem","containerElement","renderedSeries","scaleFactor","legendFont","renderers","series","data",3,"Colour","BarRenderer","LineRenderer","currentAutoColourIndex","getAutoColour","defaultColours","getDataValue","dataPoint","getDataXValue","setDataValue","newValue","createCanvas","document","createElement","style","clientWidth","clientHeight","position","appendChild","getElementById","getContext","plotCanvas","plotCtx","yAxes","xAxes","initialise","destroy","parentNode","removeChild","tooltipElement","removeEventListener","onMouseMoveReal","onMouseLeaveReal","onWindowResizeReal","devicePixelRatio","scaleFactorX","scaleFactorY","forDom","autoScale","toFixed","face","updateFonts","labels","legend","map","setOptions","optionOverrides","defaultOptions","presets","deepAssign","tooltips","allAxes","yAxis","xAxis","defaultPrimaryYAxis","defaultSecondaryYAxis","defaultXAxis","swapAxes","createRenderers","addEventListener","onMouseMove","bind","onMouseLeave","throttle","onWindowResize","calculateHighlightColour","newColour","increaseBy","sum","toString","calculateGlowColour","highlightColour","groupedSeries","bar","line","curSeries","glowColour","xAxisIndex","yAxisIndex","plotType","hasOwnProperty","axis","minNormal","maxNormal","minStacked","maxStacked","barPlot","mode","seriesPositiveTotals","seriesNegativeTotals","barSeries","filter","categoryIndex","seriesIndex","seriesMinima","seriesMaxima","createTooltip","className","zIndex","borderRadius","backgroundColor","border","padding","display","innerHTML","body","./axis","./base","./helpers/colour","./helpers/utils","./renderer.bar","./renderer.line",4,"animations","enabled","backgroundColour","barPadding","categorySpacing","linePlot","lineWidth","highlightedLineWidth","showMarkers","noMarkersThreshold","markerSize","highlightedMarkerSize","elementLargePadding","shared","headerTemplate","valueTemplate","footerTemplate","indicatorSize","verticalAlignment","verticalPosition","defaultYAxis","histogram","darkGrid","plotBackgroundColour","./base.js",5,"Rect","fontString","measureText","getMultilineTextHeight","splitMultilineText","lines","lineText","spaceWidth","wordStart","wordEnd","word","substring","wordWidth","drawTextMultiline","lineHeight","render","calculatePlotArea","drawLabelLayer","animator","requestAnimationFrame","onAnimate","animationStart","performance","now","animationLength","drawPlotLayer","clear","plot","clearRect","drawBackground","fillRect","drawPlot","drawLabels","ctx","strokeStyle","beginPath","moveTo","lineTo","stroke","draw","drawLegend","redraw","plotOnly","totalWidth","name","renderer","drawLegendIndicator","./helpers/rect",6,"timestamp","elapsed","onAnimationFrame","event","currentTarget","relatedTarget","handleMouseMove","clientX","clientY","boundingRect","getBoundingClientRect","containsPoint","hitTestResult","hitTest","found","tooltipHtml","aboveZero","rect","category","getCategoryLabel","isXRange","seriesCount","tooltipRect","borderColor","pageXOffset","mapScreenUnit","pageYOffset","oldSelectedItem","assign",7,"arg1","parseString","b","str","regExHex","regExInt","groupsHex","exec","groupsInt","parseHex","parseInt","RangeError","parseFloat","component","clipComponent","number","clip","./utils",8,"linear","time","duration","inQuad","outQuad",9,"_typeof","obj","val","containsX","containsY","clipRect","minX","maxX","minY","maxY",10,"isNaN","array","func","getter","ignoreMissing","retInitialised","sign","innerAssign","targetObject","sourceObjects","concat","to","currentSourceObject","keysArray","keys","nextIndex","len","nextKey","nextValue","desc","getOwnPropertyDescriptor","none","every","elem","formatValues","escapeAsHtml","replace","match","placeholder","stringToHtml","locateDecimalPoint","formatNumberThousands","decimalPlaces","parts","split","join","prefix","suffix","precision","div","createTextNode","fn","threshold","last","deferTimer","context","Date","args","clearTimeout","setTimeout",11,"_renderer$Renderer","barEnumerator","BarEnumerator","selected","drawLabel","matches","sortDistance","priority","realDistance","xDist","yDist","sqrt","distance","sort","normalisedDistance","area","Renderer","_renderer$ByCategoryE","startCategoryIndex","isStacked","isOverlaid","isNormal","barCount","yOrigin","onNewCategory","yBottomPositive","yBottomNegative","yRunningTotalPositive","yRunningTotalNegative","barIndex","categoryXStart","categoryXEnd","barXStart","barXEnd","barWidth","yTop","renderedValue","ByCategoryEnumerator","./renderer.base",12,"Easing","setSeries","slice","actualSeries","dataIndex","elapsedTime","totalTime","baseline","align","mapVerticalPosition","Enumerator","_Enumerator","BySeriesEnumerator","_Enumerator2","./helpers/easing",13,"_get","object","property","receiver","Function","parent","autoMarkerIndex","markers","totalPoints","markerType","arc","fill","closePath","pointEnumerator","PointEnumerator","pt","firstPoint","seriesSelected","lastPoint","drawMarker","inflate","horizontalDistance","e1","e2","_renderer$BySeriesEnu","xValue",14,"MAX_AXIS_CALC_SIZE_ATTEMPTS","adjustSize","calculateExtent","updateFormatter",15,"element","chart","./axis.js","./core.js","./defaults.js","./drawing.js","./events.js","./sizing.js"],"mappings":"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","file":"tayberry.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nvar Utils = require('./helpers/utils.js');\r\n\r\nclass Axis {\r\n    static create(tayberry, options, index, axisType, xYSwapped) {\r\n        const isHorizontal = (axisType === 'x' && !xYSwapped) || (axisType === 'y' && xYSwapped);\r\n        if (options.type === 'linear')\r\n            return new LinearAxis(tayberry, index, options, axisType, isHorizontal);\r\n        else\r\n            return new CategorialAxis(tayberry, index, options, axisType, isHorizontal);\r\n    }\r\n\r\n    constructor(tayberry, index, options, axisType, isHorizontal) {\r\n        this.tayberry = tayberry;\r\n        this.options = options;\r\n        this.axisType = axisType;\r\n        this.isHorizontal = isHorizontal;\r\n        this.index = index;\r\n        this.tickStep = null;\r\n        this.min = null;\r\n        this.max = null;\r\n        this.tickStart = null;\r\n        this.tickEnd = null;\r\n        this.calculatedSize = 0;\r\n        this.topAdjustment = 0;\r\n        this.rightAdjustment = 0;\r\n        this.titleFont = null;\r\n        this.labelFont = null;\r\n        this.numLabelLines = 1;\r\n\r\n        this.setPlacement();\r\n    }\r\n\r\n    updateFonts() {\r\n        this.labelFont = this.tayberry.createFontString(this.options.font);\r\n        this.titleFont = this.tayberry.createFontString(this.options.title.font);\r\n    }\r\n\r\n    setPlacement() {\r\n        const validAndSpecificPlacements = ['left', 'right', 'top', 'bottom', 'start', 'end'];\r\n        if (validAndSpecificPlacements.indexOf(this.options.placement) === -1) {\r\n            this.options.placement = this.isVertical ^ (this.index > 0) ? 'start' : 'end';\r\n        }\r\n    }\r\n\r\n    get isPlacedAtStart() {\r\n        return this.options.placement === \"left\" || this.options.placement === \"bottom\" || this.options.placement === \"start\";\r\n    }\r\n\r\n    get isYAxis() {\r\n        return this.axisType === 'y';\r\n    }\r\n\r\n    get isVertical() {\r\n        return !this.isHorizontal;\r\n    }\r\n\r\n    maxLabelSize() {\r\n        let tb = this.tayberry;\r\n        let ticks = this.getTicks();\r\n        return Utils.reduce(ticks, Math.max, x => tb.getTextWidth(this.options.labelFormatter(x.value), this.labelFont));\r\n    }\r\n\r\n    mapLogicalXOrYUnit(x) {\r\n        return this.isVertical ? this.tayberry.mapLogicalXUnit(x) : this.tayberry.mapLogicalYUnit(x);\r\n    }\r\n\r\n    mapLogicalYOrXUnit(x) {\r\n        return !this.isVertical ? this.tayberry.mapLogicalXUnit(x) : this.tayberry.mapLogicalYUnit(x);\r\n    }\r\n\r\n    adjustSize(plotArea, fixedOnly, reset) {\r\n        let size = 0,\r\n            tb = this.tayberry,\r\n            ret;\r\n\r\n        const titleFontHeight = tb.getFontHeight(this.options.title.font);\r\n        const fontHeight = tb.getFontHeight(this.options.font);\r\n\r\n        if (reset) {\r\n            this.calculatedSize = 0;\r\n            this.topAdjustment = 0;\r\n            this.rightAdjustment = 0;\r\n            this.numLabelLines = 1;\r\n        }\r\n\r\n        size += this.mapLogicalXOrYUnit(tb.options.elementSmallPadding);\r\n        if (this.options.title.text) {\r\n            size += this.mapLogicalXOrYUnit(tb.options.elementSmallPadding) + titleFontHeight;\r\n        }\r\n\r\n        if (!fixedOnly) {\r\n            let ticks = this.getTicks(false);\r\n            if (this.isVertical) {\r\n                if (ticks.length) {\r\n                    const lastTick = ticks[ticks.length - 1];\r\n                    const lastTickYStart = lastTick.y - fontHeight / 2;\r\n                    if (lastTickYStart < plotArea.top - this.topAdjustment) {\r\n                        const adjustment = plotArea.top - lastTickYStart - this.topAdjustment + 1;\r\n                        plotArea.top += adjustment;\r\n                        this.topAdjustment += adjustment;\r\n                    }\r\n                }\r\n                size += this.maxLabelSize()\r\n            } else {\r\n                {\r\n                    let lastXEnd;\r\n                    for (let i = 0; i < ticks.length; i++) {\r\n                        let tick = ticks[i];\r\n                        const textWidth = tb.getTextWidth(this.options.labelFormatter(tick.value), this.labelFont);\r\n                        const xStart = tick.x - textWidth / 2;\r\n                        const xEnd = tick.x + textWidth / 2;\r\n                        if (typeof lastXEnd !== 'undefined' && xStart <= lastXEnd + 1) {\r\n                            this.numLabelLines = 2;\r\n                            break;\r\n                        }\r\n                        lastXEnd = xEnd;\r\n                    }\r\n                }\r\n                if (ticks.length) {\r\n                    const lastTick = ticks[ticks.length - 1];\r\n                    const textWidth = tb.getTextWidth(this.options.labelFormatter(lastTick.value), this.labelFont);\r\n                    const lastTickXEnd = lastTick.x + textWidth / 2;\r\n                    if (lastTickXEnd >= plotArea.right + this.rightAdjustment) {\r\n                        const adjustment = lastTickXEnd - plotArea.right - this.rightAdjustment + 1;\r\n                        plotArea.right -= adjustment;\r\n                        this.rightAdjustment += adjustment;\r\n                    }\r\n                }\r\n                size += fontHeight * this.numLabelLines;\r\n            }\r\n        }\r\n\r\n        if (this.isPlacedAtStart) {\r\n            if (this.isVertical) {\r\n                plotArea.left += size - this.calculatedSize;\r\n            } else {\r\n                plotArea.top += size - this.calculatedSize;\r\n            }\r\n        } else {\r\n            size *= -1;\r\n            if (this.isVertical) {\r\n                plotArea.right += size - this.calculatedSize;\r\n            } else {\r\n                plotArea.bottom += size - this.calculatedSize;\r\n            }\r\n        }\r\n\r\n        ret = this.calculatedSize !== size;\r\n        this.calculatedSize = size;\r\n\r\n        return ret;\r\n    }\r\n\r\n    calculateExtent() {\r\n    }\r\n\r\n    getCategoryLabel() {\r\n    }\r\n\r\n    draw(offsetRect) {\r\n        this.drawTicksAndLabels(offsetRect);\r\n        this.drawTitle(offsetRect);\r\n    }\r\n\r\n    drawTicksAndLabels(offsetRect) {\r\n        let tb = this.tayberry;\r\n        const labelPadding = this.mapLogicalXOrYUnit(tb.options.elementSmallPadding);\r\n        const labelPaddingX = this.isVertical ? labelPadding * (this.isPlacedAtStart ? -1 : 1) : 0;\r\n        const labelPaddingY = !this.isVertical ? labelPadding * (this.isPlacedAtStart ? -1 : 1) : 0;\r\n        const fontHeight = tb.getFontHeight(this.options.font);\r\n        const xOffset = this.isVertical ? offsetRect[this.startProperty] : 0;\r\n        const yOffset = !this.isVertical ? offsetRect[this.startProperty] : 0;\r\n\r\n        tb.labelsCtx.save();\r\n        tb.labelsCtx.font = this.labelFont;\r\n        tb.labelsCtx.fillStyle = this.options.font.colour;\r\n        tb.labelsCtx.textAlign = this.isVertical ? (this.isPlacedAtStart ? 'right' : 'left') : 'center';\r\n        tb.labelsCtx.textBaseline = this.isVertical ? 'middle' : this.isPlacedAtStart ? 'bottom' : 'top';\r\n\r\n        let lastXEnds = [],\r\n            tickIndex = 0,\r\n            maxWidth = 0;\r\n\r\n        this.enumerateTicks((tick) => {\r\n            let xStart, xEnd;\r\n            const formattedValue = this.options.labelFormatter(tick.value);\r\n            const row = tickIndex % this.numLabelLines;\r\n            const rowOffset = this.isVertical ? 0 : fontHeight * row;\r\n            const textWidth = tb.getTextWidth(formattedValue, this.labelFont);\r\n            if (!this.isVertical) {\r\n                xStart = tick.x - textWidth / 2;\r\n                xEnd = tick.x + textWidth / 2;\r\n            }\r\n\r\n            if (this.isVertical || (typeof lastXEnds[row] === 'undefined' || xStart > lastXEnds[row] + 1) && xStart >= 0 && xEnd < tb.labelsCanvas.width) {\r\n                maxWidth = Math.max(maxWidth, textWidth);\r\n                tb.labelsCtx.fillText(formattedValue, tick.x + labelPaddingX + xOffset, tick.y + labelPaddingY + rowOffset + yOffset);\r\n                lastXEnds[row] = xEnd;\r\n            }\r\n            if (this.options.gridLines.colour)\r\n                tb.drawLine(tick.x1, tick.y1, tick.x2, tick.y2, this.options.gridLines.colour);\r\n            tickIndex++;\r\n        });\r\n\r\n        this.adjustOffsetRect(offsetRect, this.isVertical ? maxWidth + labelPadding : fontHeight + labelPadding);\r\n\r\n        tb.labelsCtx.restore();\r\n    }\r\n\r\n    adjustOffsetRect(offsetRect, displacement) {\r\n        offsetRect[this.startProperty] += this.isPlacedAtStart ? -displacement : displacement;\r\n    }\r\n\r\n    get startProperty() {\r\n        if (this.isVertical)\r\n            return this.isPlacedAtStart ? 'left' : 'right';\r\n        else\r\n            return this.isPlacedAtStart ? 'top' : 'bottom';\r\n    }\r\n\r\n    get endProperty() {\r\n        if (this.isVertical)\r\n            return !this.isPlacedAtStart ? 'left' : 'right';\r\n        else\r\n            return !this.isPlacedAtStart ? 'top' : 'bottom';\r\n    }\r\n\r\n    drawTitle(offsetRect) {\r\n        if (this.options.title.text) {\r\n            let tb = this.tayberry;\r\n            tb.labelsCtx.save();\r\n            tb.labelsCtx.font = this.titleFont;\r\n            tb.labelsCtx.fillStyle = this.options.title.font.colour;\r\n            tb.labelsCtx.textAlign = 'center';\r\n\r\n            const labelPaddingSize = this.mapLogicalXOrYUnit(tb.options.elementSmallPadding);\r\n            const labelPadding = labelPaddingSize * (this.isPlacedAtStart ? -1 : 1);\r\n            const xOffset = this.isVertical ? offsetRect[this.startProperty] : 0;\r\n            const yOffset = !this.isVertical ? offsetRect[this.startProperty] : 0;\r\n            const fontHeight = tb.getFontHeight(this.options.title.font);\r\n\r\n            if (this.isVertical) {\r\n                tb.labelsCtx.textBaseline = 'bottom';\r\n                const x = tb.plotArea[this.startProperty] + xOffset + labelPadding;\r\n                const y = tb.plotArea.yMidpoint + yOffset;\r\n                tb.labelsCtx.translate(x, y);\r\n                tb.labelsCtx.rotate((this.isPlacedAtStart ? -1 : 1)*Math.PI / 2);\r\n                tb.labelsCtx.fillText(this.options.title.text, 0, 0);\r\n            } else {\r\n                tb.labelsCtx.textBaseline = this.isPlacedAtStart ? 'bottom' : 'top';\r\n                const x = tb.plotArea.xMidpoint + xOffset;\r\n                const y = tb.plotArea[this.startProperty] + labelPadding + yOffset;\r\n                //tb.mapLogicalYOrXUnit(tb.options.font.size * 2 + tb.options.elementSmallPadding + tb.options.elementLargePadding)\r\n                tb.labelsCtx.fillText(this.options.title.text, x, y);\r\n            }\r\n            this.adjustOffsetRect(offsetRect, fontHeight + labelPaddingSize);\r\n            tb.labelsCtx.restore();\r\n        }\r\n    }\r\n\r\n    getTicks(visibleOnly = true) {\r\n        let ret = [];\r\n        this.enumerateTicks(function (tick) {\r\n            ret.push(tick)\r\n        }, visibleOnly);\r\n        return ret;\r\n    }\r\n\r\n    getOrigin() {\r\n    }\r\n\r\n    updateFormatter() {\r\n    }\r\n}\r\n\r\nclass CategorialAxis extends Axis {\r\n    enumerateTicks(callback) {\r\n        let tb = this.tayberry;\r\n\r\n        const categoryCount = this.options.categories.length;\r\n        let plotArea = tb.plotArea.clone();\r\n        if (this.isVertical)\r\n            plotArea.swapXY();\r\n        const categoryWidth = (plotArea.width / tb.categoryCount);\r\n        let factor = 0.5;\r\n\r\n        if (!this.isVertical) {\r\n            switch (this.options.labelPosition) {\r\n                case 'left':\r\n                    factor = 0;\r\n                    break;\r\n                case 'right':\r\n                    factor = 1;\r\n                    break;\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < categoryCount; i++) {\r\n            const value = this.options.categories[i];\r\n            let y1 = (this.isPlacedAtStart ? plotArea.top : plotArea.bottom);\r\n            let y2 = (!this.isPlacedAtStart ? plotArea.top : plotArea.bottom);\r\n            let x1 = plotArea.left + Math.floor(i * categoryWidth);\r\n            let x2 = x1;\r\n            let x = plotArea.left + Math.floor(i * categoryWidth + categoryWidth * factor);\r\n            let y = y1;\r\n            if (this.isVertical)\r\n                [x1, y1, x2, y2, x, y] = [y1, x1, y2, x2, y, x];\r\n\r\n            callback({\r\n                value: value,\r\n                x1: x1,\r\n                y1: y1,\r\n                x2: x2,\r\n                y2: y2,\r\n                x: x,\r\n                y: y\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    updateFormatter() {\r\n        if (!this.options.labelFormatter) {\r\n            this.options.labelFormatter = Utils.identity;\r\n        }\r\n    }\r\n\r\n    getCategoryLabel(index) {\r\n        return this.options.labelFormatter(this.options.categories[index]);\r\n    }\r\n\r\n    get plotDisplacement() {\r\n        return this.isVertical ? (-this.tayberry.plotArea.height) : (this.tayberry.plotArea.width);\r\n    }\r\n\r\n    getOrigin() {\r\n        return this.tayberry.plotArea[this.isVertical ? 'bottom' : 'left'];\r\n    }\r\n\r\n    getValueDisplacement(value) {\r\n        let ret = this.getOrigin() + this.plotDisplacement * (value + 0.5) / this.options.categories.length;\r\n        ret = this.isVertical ? Math.floor(ret) : Math.ceil(ret);\r\n        return ret;\r\n    }\r\n\r\n}\r\n\r\nclass LinearAxis extends Axis {\r\n    updateFormatter() {\r\n        if (!this.options.labelFormatter) {\r\n            if (this.options.labelFormat === 'percentage') {\r\n                this.options.labelFormatter = Utils.createPercentageFormatter(this.max - this.min, this.options.labelPrefix, this.options.labelSuffix);\r\n            }\r\n            else if (this.options.labelFormat === 'currency') {\r\n                this.options.labelFormatter = Utils.createFixedNumberFormatter(this.max - this.min, this.options.labelPrefix || this.options.currencySymbol, this.options.labelSuffix);\r\n            }\r\n            else {\r\n                this.options.labelFormatter = Utils.createAutoNumberFormatter(this.max - this.min, this.options.labelPrefix, this.options.labelSuffix);\r\n            }\r\n        }\r\n    }\r\n\r\n    enumerateTicks(callback) {\r\n        let tb = this.tayberry;\r\n\r\n        const start = this.startProperty,\r\n            end = this.endProperty;\r\n\r\n        for (let yValue = this.tickStart; yValue <= this.tickEnd && this.tickStep;) {\r\n            let y = this.getValueDisplacement(yValue);\r\n            if (this.isVertical) {\r\n                if (callback({\r\n                        value: yValue,\r\n                        x1: tb.plotArea[start],\r\n                        y1: y,\r\n                        x2: tb.plotArea[end],\r\n                        y2: y,\r\n                        x: tb.plotArea[start],\r\n                        y: y\r\n\r\n                    }))\r\n                    break;\r\n            } else {\r\n                if (callback({\r\n                        value: yValue,\r\n                        y1: tb.plotArea[start],\r\n                        x1: y,\r\n                        y2: tb.plotArea[end],\r\n                        x2: y,\r\n                        y: tb.plotArea[start],\r\n                        x: y\r\n                    }))\r\n                    break;\r\n            }\r\n            yValue = this.tickStart + Math.round((yValue + this.tickStep - this.tickStart) / this.tickStep) * this.tickStep;\r\n        }\r\n    }\r\n\r\n    static snapScaledValue(scaledStep) {\r\n        if (scaledStep < 1)\r\n            scaledStep = 1;\r\n        else if (scaledStep < 2)\r\n            scaledStep = 2;\r\n        else if (scaledStep < 2.5)\r\n            scaledStep = 2.5;\r\n        else if (scaledStep < 5)\r\n            scaledStep = 5;\r\n        else\r\n            scaledStep = 10;\r\n        return scaledStep;\r\n    }\r\n\r\n    calculateExtent() {\r\n        let targetTicks, approxStep, scale;\r\n\r\n        let targetStart = this.options.min;\r\n        let targetEnd = this.options.max;\r\n        const overriddenStart = !Utils.isMissingValue(targetStart);\r\n        const overriddenEnd = !Utils.isMissingValue(targetEnd);\r\n\r\n        if (!overriddenStart || !overriddenEnd) {\r\n            const [dataMin, dataMax] = this.isYAxis ? this.tayberry.getDataMinMax(this) : this.tayberry.getDataXMinMax(this);\r\n            const dataRange = dataMax - dataMin;\r\n            if (!overriddenStart) {\r\n                targetStart = dataMin;\r\n                if (this.isYAxis) {\r\n                    targetStart = targetStart - dataRange * 0.1;\r\n                    if (dataMin >= 0 && targetStart < 0)\r\n                        targetStart = 0;\r\n                }\r\n            }\r\n            if (!overriddenEnd) {\r\n                targetEnd = dataMax;\r\n                if (this.isYAxis) {\r\n                    targetEnd = dataMax + dataRange * 0.1;\r\n                    if (dataMax <= 0 && targetStart > 0)\r\n                        targetEnd = 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.tickStepValue) {\r\n            this.tickStep = this.options.tickStepValue;\r\n            this.min = targetStart;\r\n            this.max = targetEnd;\r\n        } else {\r\n            const targetRange = targetEnd - targetStart;\r\n            targetTicks = this.plotLength / this.mapLogicalYOrXUnit(this.options.tickStep);\r\n            approxStep = targetRange / targetTicks;\r\n            scale = Math.pow(10, Math.floor(Math.log(approxStep) / Math.log(10)));\r\n            let scaledStep = LinearAxis.snapScaledValue(Math.ceil(approxStep / scale));\r\n            this.tickStep = scaledStep * scale;\r\n            this.min = targetStart;\r\n            this.max = targetEnd;\r\n        }\r\n        this.tickStart = this.options.tickStepValue && overriddenStart ? this.min : Math.floor(this.min / this.tickStep) * this.tickStep;\r\n        this.tickEnd = this.options.tickStepValue && overriddenEnd ? this.max : Math.ceil(this.max / this.tickStep) * this.tickStep;\r\n        if (!overriddenStart && this.isYAxis)\r\n            this.min = this.tickStart;\r\n        if (!overriddenEnd && this.isYAxis)\r\n            this.max = this.tickEnd;\r\n    }\r\n\r\n    get plotDisplacement() {\r\n        return this.isVertical ? (this.tayberry.plotArea.height - 1) : -(this.tayberry.plotArea.width - 1);\r\n    }\r\n\r\n    get plotLength() {\r\n        return Math.abs(this.plotDisplacement);\r\n    }\r\n\r\n    getOrigin() {\r\n        let ret = this.tayberry.plotArea[this.isVertical ? 'bottom' : 'left'] - (0 - this.min) * this.plotDisplacement / (this.max - this.min);\r\n        if (this.isVertical) ret--;\r\n        ret = this.isVertical ? Math.floor(ret) : Math.ceil(ret);\r\n        return ret;\r\n    }\r\n\r\n    getValueDisplacement(value) {\r\n        let ret = this.getOrigin() - value * this.plotDisplacement / (this.max - this.min);\r\n        ret = this.isVertical ? Math.floor(ret) : Math.ceil(ret);\r\n        return ret;\r\n    }\r\n\r\n    getCategoryLabel(index, totalCategories, isRange) {\r\n        if (isRange) {\r\n            const start = index / totalCategories;\r\n            const end = (index + 1) / totalCategories;\r\n            const axisRange = this.max - this.min;\r\n            return Utils.formatString('{0} \\u2264 x < {1}', [this.options.labelFormatter(this.min + start * axisRange), this.options.labelFormatter(this.min + end * axisRange)]);\r\n        } else {\r\n            return this.options.labelFormatter(index);\r\n        }\r\n    }\r\n}\r\n\r\nexports.Axis = Axis;","!function(t){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var e;e=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,e.Tayberry=t()}}(function(){return function t(e,i,s){function n(o,a){if(!i[o]){if(!e[o]){var l=\"function\"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error(\"Cannot find module '\"+o+\"'\");throw h.code=\"MODULE_NOT_FOUND\",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return n(i?i:t)},u,u.exports,t,e,i,s)}return i[o].exports}for(var r=\"function\"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,e,i){\"use strict\";function s(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function n(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var o=function(){function t(t,e){var i=[],s=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){n=!0,r=l}finally{try{!s&&a[\"return\"]&&a[\"return\"]()}finally{if(n)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),l=t(\"./helpers/utils.js\"),h=function(){function t(e,i,s,n,o){r(this,t),this.tayberry=e,this.options=s,this.axisType=n,this.isHorizontal=o,this.index=i,this.tickStep=null,this.min=null,this.max=null,this.tickStart=null,this.tickEnd=null,this.calculatedSize=0,this.topAdjustment=0,this.rightAdjustment=0,this.titleFont=null,this.labelFont=null,this.numLabelLines=1,this.setPlacement()}return a(t,null,[{key:\"create\",value:function(t,e,i,s,n){var r=\"x\"===s&&!n||\"y\"===s&&n;return\"linear\"===e.type?new c(t,i,e,s,r):new u(t,i,e,s,r)}}]),a(t,[{key:\"updateFonts\",value:function(){this.labelFont=this.tayberry.createFontString(this.options.font),this.titleFont=this.tayberry.createFontString(this.options.title.font)}},{key:\"setPlacement\",value:function(){var t=[\"left\",\"right\",\"top\",\"bottom\",\"start\",\"end\"];-1===t.indexOf(this.options.placement)&&(this.options.placement=this.isVertical^this.index>0?\"start\":\"end\")}},{key:\"maxLabelSize\",value:function(){var t=this,e=this.tayberry,i=this.getTicks();return l.reduce(i,Math.max,function(i){return e.getTextWidth(t.options.labelFormatter(i.value),t.labelFont)})}},{key:\"mapLogicalXOrYUnit\",value:function(t){return this.isVertical?this.tayberry.mapLogicalXUnit(t):this.tayberry.mapLogicalYUnit(t)}},{key:\"mapLogicalYOrXUnit\",value:function(t){return this.isVertical?this.tayberry.mapLogicalYUnit(t):this.tayberry.mapLogicalXUnit(t)}},{key:\"adjustSize\",value:function(t,e,i){var s=0,n=this.tayberry,r=void 0,o=n.getFontHeight(this.options.title.font),a=n.getFontHeight(this.options.font);if(i&&(this.calculatedSize=0,this.topAdjustment=0,this.rightAdjustment=0,this.numLabelLines=1),s+=this.mapLogicalXOrYUnit(n.options.elementSmallPadding),this.options.title.text&&(s+=this.mapLogicalXOrYUnit(n.options.elementSmallPadding)+o),!e){var l=this.getTicks(!1);if(this.isVertical){if(l.length){var h=l[l.length-1],u=h.y-a/2;if(u<t.top-this.topAdjustment){var c=t.top-u-this.topAdjustment+1;t.top+=c,this.topAdjustment+=c}}s+=this.maxLabelSize()}else{for(var p=void 0,d=0;d<l.length;d++){var f=l[d],g=n.getTextWidth(this.options.labelFormatter(f.value),this.labelFont),y=f.x-g/2,m=f.x+g/2;if(\"undefined\"!=typeof p&&p+1>=y){this.numLabelLines=2;break}p=m}if(l.length){var h=l[l.length-1],g=n.getTextWidth(this.options.labelFormatter(h.value),this.labelFont),b=h.x+g/2;if(b>=t.right+this.rightAdjustment){var c=b-t.right-this.rightAdjustment+1;t.right-=c,this.rightAdjustment+=c}}s+=a*this.numLabelLines}}return this.isPlacedAtStart?this.isVertical?t.left+=s-this.calculatedSize:t.top+=s-this.calculatedSize:(s*=-1,this.isVertical?t.right+=s-this.calculatedSize:t.bottom+=s-this.calculatedSize),r=this.calculatedSize!==s,this.calculatedSize=s,r}},{key:\"calculateExtent\",value:function(){}},{key:\"getCategoryLabel\",value:function(){}},{key:\"draw\",value:function(t){this.drawTicksAndLabels(t),this.drawTitle(t)}},{key:\"drawTicksAndLabels\",value:function(t){var e=this,i=this.tayberry,s=this.mapLogicalXOrYUnit(i.options.elementSmallPadding),n=this.isVertical?s*(this.isPlacedAtStart?-1:1):0,r=this.isVertical?0:s*(this.isPlacedAtStart?-1:1),o=i.getFontHeight(this.options.font),a=this.isVertical?t[this.startProperty]:0,l=this.isVertical?0:t[this.startProperty];i.labelsCtx.save(),i.labelsCtx.font=this.labelFont,i.labelsCtx.fillStyle=this.options.font.colour,i.labelsCtx.textAlign=this.isVertical?this.isPlacedAtStart?\"right\":\"left\":\"center\",i.labelsCtx.textBaseline=this.isVertical?\"middle\":this.isPlacedAtStart?\"bottom\":\"top\";var h=[],u=0,c=0;this.enumerateTicks(function(t){var s=void 0,p=void 0,d=e.options.labelFormatter(t.value),f=u%e.numLabelLines,g=e.isVertical?0:o*f,y=i.getTextWidth(d,e.labelFont);e.isVertical||(s=t.x-y/2,p=t.x+y/2),(e.isVertical||(\"undefined\"==typeof h[f]||s>h[f]+1)&&s>=0&&p<i.labelsCanvas.width)&&(c=Math.max(c,y),i.labelsCtx.fillText(d,t.x+n+a,t.y+r+g+l),h[f]=p),e.options.gridLines.colour&&i.drawLine(t.x1,t.y1,t.x2,t.y2,e.options.gridLines.colour),u++}),this.adjustOffsetRect(t,this.isVertical?c+s:o+s),i.labelsCtx.restore()}},{key:\"adjustOffsetRect\",value:function(t,e){t[this.startProperty]+=this.isPlacedAtStart?-e:e}},{key:\"drawTitle\",value:function(t){if(this.options.title.text){var e=this.tayberry;e.labelsCtx.save(),e.labelsCtx.font=this.titleFont,e.labelsCtx.fillStyle=this.options.title.font.colour,e.labelsCtx.textAlign=\"center\";var i=this.mapLogicalXOrYUnit(e.options.elementSmallPadding),s=i*(this.isPlacedAtStart?-1:1),n=this.isVertical?t[this.startProperty]:0,r=this.isVertical?0:t[this.startProperty],o=e.getFontHeight(this.options.title.font);if(this.isVertical){e.labelsCtx.textBaseline=\"bottom\";var a=e.plotArea[this.startProperty]+n+s,l=e.plotArea.yMidpoint+r;e.labelsCtx.translate(a,l),e.labelsCtx.rotate((this.isPlacedAtStart?-1:1)*Math.PI/2),e.labelsCtx.fillText(this.options.title.text,0,0)}else{e.labelsCtx.textBaseline=this.isPlacedAtStart?\"bottom\":\"top\";var a=e.plotArea.xMidpoint+n,l=e.plotArea[this.startProperty]+s+r;e.labelsCtx.fillText(this.options.title.text,a,l)}this.adjustOffsetRect(t,o+i),e.labelsCtx.restore()}}},{key:\"getTicks\",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],e=[];return this.enumerateTicks(function(t){e.push(t)},t),e}},{key:\"getOrigin\",value:function(){}},{key:\"updateFormatter\",value:function(){}},{key:\"isPlacedAtStart\",get:function(){return\"left\"===this.options.placement||\"bottom\"===this.options.placement||\"start\"===this.options.placement}},{key:\"isYAxis\",get:function(){return\"y\"===this.axisType}},{key:\"isVertical\",get:function(){return!this.isHorizontal}},{key:\"startProperty\",get:function(){return this.isVertical?this.isPlacedAtStart?\"left\":\"right\":this.isPlacedAtStart?\"top\":\"bottom\"}},{key:\"endProperty\",get:function(){return this.isVertical?this.isPlacedAtStart?\"right\":\"left\":this.isPlacedAtStart?\"bottom\":\"top\"}}]),t}(),u=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),a(e,[{key:\"enumerateTicks\",value:function(t){var e=this.tayberry,i=this.options.categories.length,s=e.plotArea.clone();this.isVertical&&s.swapXY();var n=s.width/e.categoryCount,r=.5;if(!this.isVertical)switch(this.options.labelPosition){case\"left\":r=0;break;case\"right\":r=1}for(var o=0;i>o;o++){var a=this.options.categories[o],l=this.isPlacedAtStart?s.top:s.bottom,h=this.isPlacedAtStart?s.bottom:s.top,u=s.left+Math.floor(o*n),c=u,p=s.left+Math.floor(o*n+n*r),d=l;if(this.isVertical){var f=[l,u,h,c,d,p];u=f[0],l=f[1],c=f[2],h=f[3],p=f[4],d=f[5]}t({value:a,x1:u,y1:l,x2:c,y2:h,x:p,y:d})}}},{key:\"updateFormatter\",value:function(){this.options.labelFormatter||(this.options.labelFormatter=l.identity)}},{key:\"getCategoryLabel\",value:function(t){return this.options.labelFormatter(this.options.categories[t])}},{key:\"getOrigin\",value:function(){return this.tayberry.plotArea[this.isVertical?\"bottom\":\"left\"]}},{key:\"getValueDisplacement\",value:function(t){var e=this.getOrigin()+this.plotDisplacement*(t+.5)/this.options.categories.length;return e=this.isVertical?Math.floor(e):Math.ceil(e)}},{key:\"plotDisplacement\",get:function(){return this.isVertical?-this.tayberry.plotArea.height:this.tayberry.plotArea.width}}]),e}(h),c=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),a(e,[{key:\"updateFormatter\",value:function(){this.options.labelFormatter||(\"percentage\"===this.options.labelFormat?this.options.labelFormatter=l.createPercentageFormatter(this.max-this.min,this.options.labelPrefix,this.options.labelSuffix):\"currency\"===this.options.labelFormat?this.options.labelFormatter=l.createFixedNumberFormatter(this.max-this.min,this.options.labelPrefix||this.options.currencySymbol,this.options.labelSuffix):this.options.labelFormatter=l.createAutoNumberFormatter(this.max-this.min,this.options.labelPrefix,this.options.labelSuffix))}},{key:\"enumerateTicks\",value:function(t){for(var e=this.tayberry,i=this.startProperty,s=this.endProperty,n=this.tickStart;n<=this.tickEnd&&this.tickStep;){var r=this.getValueDisplacement(n);if(this.isVertical){if(t({value:n,x1:e.plotArea[i],y1:r,x2:e.plotArea[s],y2:r,x:e.plotArea[i],y:r}))break}else if(t({value:n,y1:e.plotArea[i],x1:r,y2:e.plotArea[s],x2:r,y:e.plotArea[i],x:r}))break;n=this.tickStart+Math.round((n+this.tickStep-this.tickStart)/this.tickStep)*this.tickStep}}},{key:\"calculateExtent\",value:function(){var t=void 0,i=void 0,s=void 0,n=this.options.min,r=this.options.max,a=!l.isMissingValue(n),h=!l.isMissingValue(r);if(!a||!h){var u=this.isYAxis?this.tayberry.getDataMinMax(this):this.tayberry.getDataXMinMax(this),c=o(u,2),p=c[0],d=c[1],f=d-p;a||(n=p,this.isYAxis&&(n-=.1*f,p>=0&&0>n&&(n=0))),h||(r=d,this.isYAxis&&(r=d+.1*f,0>=d&&n>0&&(r=0)))}if(this.options.tickStepValue)this.tickStep=this.options.tickStepValue,this.min=n,this.max=r;else{var g=r-n;t=this.plotLength/this.mapLogicalYOrXUnit(this.options.tickStep),i=g/t,s=Math.pow(10,Math.floor(Math.log(i)/Math.log(10)));var y=e.snapScaledValue(Math.ceil(i/s));this.tickStep=y*s,this.min=n,this.max=r}this.tickStart=this.options.tickStepValue&&a?this.min:Math.floor(this.min/this.tickStep)*this.tickStep,this.tickEnd=this.options.tickStepValue&&h?this.max:Math.ceil(this.max/this.tickStep)*this.tickStep,!a&&this.isYAxis&&(this.min=this.tickStart),!h&&this.isYAxis&&(this.max=this.tickEnd)}},{key:\"getOrigin\",value:function(){var t=this.tayberry.plotArea[this.isVertical?\"bottom\":\"left\"]-(0-this.min)*this.plotDisplacement/(this.max-this.min);return this.isVertical&&t--,t=this.isVertical?Math.floor(t):Math.ceil(t)}},{key:\"getValueDisplacement\",value:function(t){var e=this.getOrigin()-t*this.plotDisplacement/(this.max-this.min);return e=this.isVertical?Math.floor(e):Math.ceil(e)}},{key:\"getCategoryLabel\",value:function(t,e,i){if(i){var s=t/e,n=(t+1)/e,r=this.max-this.min;return l.formatString(\"{0}  x < {1}\",[this.options.labelFormatter(this.min+s*r),this.options.labelFormatter(this.min+n*r)])}return this.options.labelFormatter(t)}},{key:\"plotDisplacement\",get:function(){return this.isVertical?this.tayberry.plotArea.height-1:-(this.tayberry.plotArea.width-1)}},{key:\"plotLength\",get:function(){return Math.abs(this.plotDisplacement)}}],[{key:\"snapScaledValue\",value:function(t){return t=1>t?1:2>t?2:2.5>t?2.5:5>t?5:10}}]),e}(h);i.Axis=h},{\"./helpers/utils.js\":10}],2:[function(t,e,i){\"use strict\";function s(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=function(){function t(){s(this,t),this.selectedItem={},this.containerElement=null,this.labelsCanvas=null,this.labelsCtx=null,this.renderedSeries=null,this.options=null,this.scaleFactor=null,this.titleFont=null,this.plotArea=null,this.categories=[],this.titleFont=null,this.labelFont=null,this.legendFont=null,this.renderers=[]}return n(t,[{key:\"seriesCount\",get:function(){return this.options.series.length}},{key:\"categoryCount\",get:function(){return this.options.series.length?this.options.series[0].data.length:0}}]),t}();i.Tayberry=r},{}],3:[function(t,e,i){\"use strict\";var s=t(\"./helpers/colour\").Colour,n=t(\"./helpers/utils\"),r=t(\"./base\").Tayberry,o=t(\"./axis\").Axis,a=t(\"./renderer.bar\").BarRenderer,l=t(\"./renderer.line\").LineRenderer,h=0;r.getAutoColour=function(){var t=r.defaultColours[h%r.defaultColours.length];return h++,t},r.getDataValue=function(t){var e=void 0;return e=Array.isArray(t)?t[1]:t},r.getDataXValue=function(t,e){var i=void 0;return i=Array.isArray(t[e])?t[e][0]:e},r.setDataValue=function(t,e,i){Array.isArray(t[e])?t[e][1]=i:t[e]=i},r.prototype.createCanvas=function(){var t=document.createElement(\"canvas\");return t.style.width=Math.floor(this.containerElement.clientWidth)+\"px\",t.style.width=Math.floor(this.containerElement.clientWidth)+\"px\",t.style.height=Math.floor(this.containerElement.clientHeight)+\"px\",t.style.position=\"absolute\",this.containerElement.appendChild(t),t},r.prototype.create=function(t){\"string\"==typeof t?this.containerElement=document.getElementById(t):this.containerElement=t,this.labelsCanvas=this.createCanvas(),this.labelsCtx=this.labelsCanvas.getContext(\"2d\"),this.plotCanvas=this.createCanvas(),this.plotCtx=this.plotCanvas.getContext(\"2d\"),this.renderedSeries=null,this.options={},this.yAxes=null,this.xAxes=null,this.initialise()},r.prototype.destroy=function(){this.labelsCanvas.parentNode.removeChild(this.labelsCanvas),this.tooltipElement.parentNode.removeChild(this.tooltipElement),this.options={},this.plotCanvas.removeEventListener(\"mousemove\",this.onMouseMoveReal),this.plotCanvas.removeEventListener(\"mouseleave\",this.onMouseLeaveReal),window.removeEventListener(\"resize\",this.onWindowResizeReal)},r.prototype.initialise=function(){this.scaleFactor=window.devicePixelRatio||1,this.labelsCanvas.width=Math.round(this.labelsCanvas.clientWidth*this.scaleFactor),this.labelsCanvas.height=Math.round(this.labelsCanvas.clientHeight*this.scaleFactor),this.plotCanvas.width=this.labelsCanvas.width,this.plotCanvas.height=this.labelsCanvas.height,this.scaleFactorX=this.labelsCanvas.width/this.labelsCanvas.clientWidth,this.scaleFactorY=this.labelsCanvas.height/this.labelsCanvas.clientHeight,this.selectedItem={},this.plotArea=null},r.prototype.getFontHeight=function(t,e){var i=t.size;return t.autoScale&&(i*=Math.pow(this.labelsCanvas.width/800,.25)),e||(i=this.mapLogicalYUnit(i)),i},r.prototype.createFontString=function(t,e){return(t.style?t.style+\" \":\"\")+this.getFontHeight(t,e).toFixed(1)+\"px \"+t.face},r.prototype.updateFonts=function(){this.titleFont=this.createFontString(this.options.title.font),this.labelFont=this.createFontString(this.options.labels.font),this.legendFont=this.createFontString(this.options.legend.font),this.yAxes.map(function(t){return t.updateFonts()}),this.xAxes.map(function(t){return t.updateFonts()})},r.prototype.setOptions=function(t){var e=[this.defaultOptions()];if(t.presets||(t.presets=[\"default\"]),t.presets)for(var i=0;i<t.presets.length;i++)e.push(r.presets[t.presets[i]]);e.push(t),this.options=n.deepAssign({},e),this.options.title.font=n.deepAssign({},[this.options.font,this.options.title.font]),this.options.tooltips.font=n.deepAssign({},[this.options.font,this.options.tooltips.font]),this.options.labels.font=n.deepAssign({},[this.options.font,this.options.labels.font]),this.options.legend.font=n.deepAssign({},[this.options.font,this.options.legend.font]),this.options.allAxes.font=n.deepAssign({},[this.options.font,this.options.allAxes.font]),this.options.allAxes.title.font=n.deepAssign({},[this.options.font,this.options.allAxes.title.font]),Array.isArray(this.options.yAxis)||(this.options.yAxis=[this.options.yAxis||{}]),Array.isArray(this.options.xAxis)||(this.options.xAxis=[this.options.xAxis||{}]);for(var s=0;s<this.options.yAxis.length;s++)this.options.yAxis[s]=n.deepAssign({},[0===s?r.defaultPrimaryYAxis:r.defaultSecondaryYAxis,this.options.allAxes,this.options.yAxis[s]]);for(var s=0;s<this.options.xAxis.length;s++)this.options.xAxis[s]=n.deepAssign({},[r.defaultXAxis,this.options.allAxes,this.options.xAxis[s]]);this.yAxes=[],this.xAxes=[];for(var s=0;s<this.options.xAxis.length;s++)this.xAxes.push(o.create(this,this.options.xAxis[s],s,\"x\",this.options.swapAxes));for(var s=0;s<this.options.yAxis.length;s++)this.yAxes.push(o.create(this,this.options.yAxis[s],s,\"y\",this.options.swapAxes));this.createRenderers(),this.updateFonts(),this.plotCanvas.addEventListener(\"mousemove\",this.onMouseMoveReal=this.onMouseMove.bind(this)),this.plotCanvas.addEventListener(\"mouseleave\",this.onMouseLeaveReal=this.onMouseLeave.bind(this)),window.addEventListener(\"resize\",this.onWindowResizeReal=n.throttle(this.onWindowResize,50).bind(this))},r.calculateHighlightColour=function(t){var e=new s(t);return e.increaseBy(30*(e.sum>=540?-1:1)).toString()},r.calculateGlowColour=function(t){var e=new s(t);return e.a=.4,e.toString()},r.prototype.createRenderers=function(){var t=void 0,e={bar:[],line:[]};t=Array.isArray(this.options.series)?this.options.series:[this.options.series];for(var i=0;i<t.length;i++){var s=t[i];s.index=i,s.colour=s.colour||r.getAutoColour(),s.highlightColour=s.highlightColour||r.calculateHighlightColour(s.colour),s.glowColour=s.glowColour||r.calculateGlowColour(s.highlightColour),s.xAxis=this.xAxes[s.xAxisIndex||0],s.yAxis=this.yAxes[s.yAxisIndex||0],s.plotType=s.plotType||this.options.plotType,e.hasOwnProperty(s.plotType)&&e[s.plotType].push(s)}e.bar.length&&this.renderers.push(new a(this.plotCtx,this,e.bar)),e.line.length&&this.renderers.push(new l(this.plotCtx,this,e.line))},r.prototype.getDataMinMax=function(t){var e,i,s,o;if(\"stacked\"===this.options.barPlot.mode){var a=[],l=[],h=this.options.series.filter(function(e){return\"bar\"===e.plotType&&e.yAxis===t});if(h.length)for(var u=0;u<h[0].data.length;u++){a[u]=0,l[u]=0;for(var c=0;c<h.length;c++){var p=r.getDataValue(h[c].data[u]);n.isMissingValue(p)||(0>p?l[u]+=p:a[u]+=p)}}s=Math.min(0,n.reduce(l,Math.min,void 0,!0)),o=Math.max(n.reduce(a,Math.max,void 0,!0),0)}for(var d=[],f=[],g=0;g<this.options.series.length;g++){var y=this.options.series[g];y.yAxis!==t||\"bar\"===y.plotType&&\"stacked\"===this.options.barPlot.mode||(d.push(n.reduce(y.data,Math.min,r.getDataValue,!0)),f.push(n.reduce(y.data,Math.max,r.getDataValue,!0)))}e=n.reduce(d,Math.min,void 0,!0),i=n.reduce(f,Math.max,void 0,!0);var m=n.reduce([e,s],Math.min,void 0,!0),b=n.reduce([i,o],Math.max,void 0,!0);return[m,b]},r.prototype.getDataXMinMax=function(t){for(var e,i,s=[],o=[],a=0;a<this.options.series.length;a++){var l=this.options.series[a];l.xAxis===t&&(s.push(n.reduce(l.data,Math.min,r.getDataXValue,!0)),o.push(n.reduce(l.data,Math.max,r.getDataXValue,!0)))}return e=n.reduce(s,Math.min,void 0,!0),i=n.reduce(o,Math.max,void 0,!0),[e,i]},r.prototype.createTooltip=function(){this.tooltipElement&&(this.tooltipElement.parentNode.removeChild(this.tooltipElement),this.tooltipElement=null),this.tooltipElement=document.createElement(\"div\"),this.tooltipElement.className=\"tayberry-tooltip\",this.tooltipElement.style.position=\"absolute\",this.tooltipElement.style.left=\"0px\",this.tooltipElement.style.top=\"0px\",this.tooltipElement.style.zIndex=\"99999\",this.tooltipElement.style.font=this.createFontString(this.options.tooltips.font,!0),this.tooltipElement.style.borderRadius=\"3px\",this.tooltipElement.style.backgroundColor=\"white\",this.tooltipElement.style.border=\"2px solid #bbb\",this.tooltipElement.style.padding=\"0.15em 0.4em\",this.tooltipElement.style.display=\"none\",this.tooltipElement.innerHTML=\"\",document.body.appendChild(this.tooltipElement),this.tooltipElement.addEventListener(\"mousemove\",this.onMouseMove.bind(this)),this.tooltipElement.addEventListener(\"mouseleave\",this.onMouseLeave.bind(this))}},{\"./axis\":1,\"./base\":2,\"./helpers/colour\":7,\"./helpers/utils\":10,\"./renderer.bar\":11,\"./renderer.line\":13}],4:[function(t,e,i){\"use strict\";var s=t(\"./base.js\").Tayberry,n=t(\"./helpers/utils\");s.prototype.defaultOptions=function(){return{title:{text:\"\",font:{size:20}},font:{colour:\"#444\",size:12,face:\"sans-serif\",style:\"\",autoScale:!0},allAxes:{font:{},title:{font:{}}},xAxis:[],yAxis:[],animations:{enabled:!0},series:[],backgroundColour:void 0,swapAxes:!1,plotType:\"bar\",barPlot:{mode:\"normal\",barPadding:2,categorySpacing:.3},linePlot:{lineWidth:2,highlightedLineWidth:4,showMarkers:\"auto\",noMarkersThreshold:100,markerSize:10,highlightedMarkerSize:18},elementSmallPadding:5,elementLargePadding:10,presets:[],tooltips:{shared:!1,headerTemplate:\"<strong>{category}</strong><table>\",valueTemplate:'<tr><td style=\"padding-right: 0.5em\"><span style=\"color: {colour}\"></span> {name}</td><td style=\"text-align: right\">{value}</td></tr>',footerTemplate:\"</table>\",font:{}},legend:{enabled:!0,indicatorSize:15,font:{}},labels:{enabled:!1,verticalAlignment:\"top\",verticalPosition:\"outside\",font:{}}}},s.defaultXAxis={title:{text:\"\",font:{}},type:\"categorial\",min:null,max:null,tickStep:40,tickStepValue:null,font:{},categories:[],labelPosition:\"middle\",placement:\"auto\",gridLines:{}},s.defaultYAxis={title:{text:\"\",font:{}},min:void 0,max:void 0,tickStep:40,tickStepValue:null,font:{},labelFormat:\"number\",labelFormatter:void 0,labelPrefix:void 0,labelSuffix:void 0,currencySymbol:\"\",placement:\"auto\",type:\"linear\",gridLines:{}},s.defaultPrimaryYAxis=n.deepAssign({},[s.defaultYAxis,{gridLines:{colour:\"#ccc\"}}]),s.defaultSecondaryYAxis=s.defaultYAxis,s.presets={histogram:{barPlot:{mode:\"overlaid\",categorySpacing:0,barPadding:1}},darkGrid:{allAxes:{gridLines:{colour:\"rgba(255, 255, 255, 0.6)\"}},plotBackgroundColour:\"#E5E5E5\"}},s.defaultColours=[\"#6FE87B\",\"#FFAB51\",\"#51A8FF\",\"#B651FF\",\"#FF6051\",\"#636363\",\"#FFE314\",\"#A88572\",\"#B7B7B7\"]},{\"./base.js\":2,\"./helpers/utils\":10}],5:[function(t,e,i){\"use strict\";var s=t(\"./base\").Tayberry,n=t(\"./helpers/rect\").Rect;t(\"./helpers/utils\");s.prototype.getTextWidth=function(t,e){var i=void 0;return e&&(this.labelsCtx.save(),this.labelsCtx.font=e),i=this.labelsCtx.measureText(t).width,e&&this.labelsCtx.restore(),i},s.prototype.getMultilineTextHeight=function(t,e,i){var s=void 0;return t&&(this.labelsCtx.save(),this.labelsCtx.font=t),s=this.splitMultilineText(e,i).length,t&&this.labelsCtx.restore(),s},s.prototype.splitMultilineText=function(t,e){for(var i=[],s=0,n=\"\",r=this.labelsCtx.measureText(\" \").width,o=0;o<e.length;){for(var a=o;o<e.length&&\" \"!==e[o]&&\"\\r\"!==e[o]&&\"\\n\"!==e[o];)o++;for(var l=o;o<e.length&&(\" \"===e[o]||\"\\r\"===e[o]||\"\\n\"===e[o]);)o++;if(l>a){var h=e.substring(a,l),u=this.labelsCtx.measureText(h).width;s+u>t?(s||(n=h),i.push(n),s&&(s=0,n=h)):(n+=(n?\" \":\"\")+h,s+=u+r)}}return n&&i.push(n),i},s.prototype.drawTextMultiline=function(t,e,i,s,n){for(var r=this.splitMultilineText(s,n),o=0;o<r.length;o++){var a=r[o];this.labelsCtx.fillText(a,e,i+t*o)}},s.prototype.render=function(){this.calculatePlotArea(),this.drawLabelLayer(),this.createTooltip(),this.options.animations.enabled?(this.animator=requestAnimationFrame(this.onAnimate.bind(this)),this.animationStart=\"undefined\"!=typeof performance&&\"undefined\"!=typeof performance.now?performance.now():null,this.animationLength=500):this.drawPlotLayer()},s.prototype.clear=function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];t&&this.plotCtx.clearRect(0,0,this.plotCanvas.width,this.plotCanvas.height),e&&this.labelsCtx.clearRect(0,0,this.labelsCanvas.width,this.labelsCanvas.height)},s.prototype.drawBackground=function(){this.options.plotBackgroundColour&&(this.labelsCtx.save(),this.labelsCtx.fillStyle=this.options.plotBackgroundColour,this.labelsCtx.fillRect(this.plotArea.left,this.plotArea.top,this.plotArea.width,this.plotArea.height),this.labelsCtx.restore())},s.prototype.drawTitle=function(){if(this.options.title.text){var t=this.labelsCanvas.width/2,e=0;this.labelsCtx.save(),this.labelsCtx.textAlign=\"center\",this.labelsCtx.textBaseline=\"top\",this.labelsCtx.font=this.titleFont,this.labelsCtx.fillStyle=this.options.title.font.colour,this.drawTextMultiline(this.getFontHeight(this.options.title.font),t,e,this.labelsCanvas.width,this.options.title.text),this.labelsCtx.restore()}},s.prototype.drawPlotLayer=function(){for(var t=0;t<this.renderers.length;t++)this.renderers[t].drawPlot();for(var t=0;t<this.renderers.length;t++)this.renderers[t].drawLabels()},s.prototype.drawLine=function(t,e,i,s,n){var r=arguments.length<=5||void 0===arguments[5]?this.labelsCtx:arguments[5];r.save(),n&&(r.strokeStyle=n),r.beginPath(),r.moveTo(t+.5,e+.5),r.lineTo(i+.5,s+.5),r.stroke(),r.restore()},s.prototype.drawLabelLayer=function(){this.drawBackground(),this.drawTitle();var t=new n(0);this.xAxes.map(function(e){return e.draw(t)}),this.yAxes.map(function(e){return e.draw(t)}),this.drawLegend()},s.prototype.redraw=function(t){this.clear(!0,!t),t||this.drawLabelLayer(),this.drawPlotLayer()},s.prototype.drawLegend=function(){if(this.options.legend.enabled){this.labelsCtx.save(),this.labelsCtx.font=this.legendFont;for(var t=0,e=this.mapLogicalXUnit(this.options.legend.indicatorSize),i=0;i<this.options.series.length;i++){var s=this.options.series[i];s.name&&(t+=this.getTextWidth(s.name,this.legendFont)+e+this.mapLogicalXUnit(this.options.elementSmallPadding+this.options.elementLargePadding))}for(var r=this.plotArea.left+this.plotArea.width/2-t/2,o=this.labelsCanvas.height-e,i=0;i<this.options.series.length;i++){var s=this.options.series[i];s.name&&(s.renderer.drawLegendIndicator(this.labelsCtx,s,new n(r,o,r+e,o+e)),this.labelsCtx.textBaseline=\"middle\",this.labelsCtx.fillStyle=this.options.legend.font.colour,r+=e+this.mapLogicalXUnit(this.options.elementSmallPadding),this.labelsCtx.fillText(s.name,r,o+e/2),r+=this.getTextWidth(s.name,this.legendFont)+this.mapLogicalXUnit(this.options.elementLargePadding))}this.labelsCtx.restore()}}},{\"./base\":2,\"./helpers/rect\":9,\"./helpers/utils\":10}],6:[function(t,e,i){\"use strict\";var s=t(\"./helpers/rect\").Rect,n=t(\"./helpers/utils\"),r=t(\"./base\").Tayberry;r.prototype.onAnimate=function(t){var e;null===this.animationStart&&(this.animationStart=t),e=t-this.animationStart;for(var i=0;i<this.renderers.length;i++)this.renderers[i].onAnimationFrame(e,this.animationLength);this.redraw(!0),e<this.animationLength&&(this.animator=requestAnimationFrame(this.onAnimate.bind(this)))},r.prototype.onMouseLeave=function(t){(t.currentTarget==this.plotCanvas&&t.relatedTarget!==this.tooltipElement||t.currentTarget==this.tooltipElement&&t.relatedTarget!==this.plotCanvas)&&(this.selectedItem={},this.tooltipElement.style.display=\"none\",this.redraw())},r.prototype.handleMouseMove=function(t,e){var i=new s(this.plotCanvas.getBoundingClientRect()),o=!1;if(i.containsPoint(t,e)){var a=t-i.left,l=e-i.top,h=this.hitTest(this.mapLogicalXUnit(a),this.mapLogicalYUnit(l));if(h.found){var u=\"\",c=h.rect.top<h.rect.bottom;if(this.tooltipElement.style.display=\"block\",this.options.tooltips.shared){var p=this.xAxes[0].getCategoryLabel(h.categoryIndex,this.categoryCount,h.isXRange);u+=n.formatString(this.options.tooltips.headerTemplate,{category:p},!0);for(var d=0;d<this.seriesCount;d++){var f=this.options.series[d],g=r.getDataValue(f.data[h.categoryIndex]);u+=n.formatString(this.options.tooltips.valueTemplate,{value:f.yAxis.options.labelFormatter(g),name:f.name,colour:f.colour},!0)}}else{var f=h.series,g=h.value,p=f.xAxis.getCategoryLabel(h.categoryIndex,this.categoryCount,h.isXRange);u+=n.formatString(this.options.tooltips.headerTemplate,{category:p},!0),u+=n.formatString(this.options.tooltips.valueTemplate,{value:f.yAxis.options.labelFormatter(g),name:f.name,colour:f.colour},!0)}u+=this.options.tooltips.footerTemplate,this.tooltipElement.innerHTML=u;var y=this.tooltipElement.getBoundingClientRect();this.options.tooltips.shared||(this.tooltipElement.style.borderColor=h.series.colour),this.tooltipElement.style.left=window.pageXOffset+i.left+this.mapScreenUnit(h.rect.width)/2+h.rect.left/this.scaleFactor-y.width/2+\"px\",this.tooltipElement.style.top=window.pageYOffset+i.top+this.mapScreenUnit(h.rect.top)-y.height*(c?1:0)-this.options.elementSmallPadding*(c?1:-1)+\"px\",this.selectedItem=h,o=!0}}return o},r.prototype.onMouseMove=function(t){var e=n.assign({},this.selectedItem);this.handleMouseMove(t.clientX,t.clientY)||(this.selectedItem={}),(e.categoryIndex!==this.selectedItem.categoryIndex||e.series!==this.selectedItem.series)&&this.redraw()},r.prototype.onWindowResize=function(){this.tooltipElement.style.display=\"none\",this.labelsCanvas.style.width=Math.floor(this.containerElement.clientWidth)+\"px\",this.labelsCanvas.style.height=Math.floor(this.containerElement.clientHeight)+\"px\",this.plotCanvas.style.width=Math.floor(this.containerElement.clientWidth)+\"px\",this.plotCanvas.style.height=Math.floor(this.containerElement.clientHeight)+\"px\",this.initialise(),this.updateFonts(),this.calculatePlotArea(),this.createTooltip(),this.redraw()}},{\"./base\":2,\"./helpers/rect\":9,\"./helpers/utils\":10}],7:[function(t,e,i){\"use strict\";function s(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=t(\"./utils\"),o=function(){function t(){if(s(this,t),1===arguments.length){var e=arguments[0];\"string\"==typeof e?this.parseString(e):(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}}return n(t,[{key:\"parseString\",value:function(t){var e=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,i=/^rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})(\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*)?\\)$/i,s=e.exec(t),n=i.exec(t);if(s){var r=function(t){var e=parseInt(t,16);return e=16*e+e};this.r=s[1]?parseInt(s[1],16):r(s[4]),this.g=s[2]?parseInt(s[2],16):r(s[5]),this.b=s[3]?parseInt(s[3],16):r(s[6]),this.a=null}else{if(!n)throw new RangeError(t+\" is not a valid HTML colour\");this.r=parseInt(n[1]),this.g=parseInt(n[2]),this.b=parseInt(n[3]),this.a=n[5]?parseFloat(n[5]):null}return this}},{key:\"clipComponent\",value:function(t){return this[t]=Math.round(this[t]),this[t]=Math.min(this[t],255),this[t]=Math.max(this[t],0),this}},{key:\"clip\",value:function(){return this.clipComponent(\"r\"),this.clipComponent(\"g\"),this.clipComponent(\"b\"),this}},{key:\"increaseBy\",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this.clip(),this}},{key:\"toString\",value:function(){var t;return t=this.a?r.formatString(\"rgba({r},{g},{b},{a})\",this):r.formatString(\"rgb({r},{g},{b})\",this)}},{key:\"sum\",get:function(){return this.r+this.g+this.b}}]),t}();i.Colour=o},{\"./utils\":10}],8:[function(t,e,i){\"use strict\";i.linear=function(t,e){return t/e},i.linear=function(t,e){return t/e},i.inQuad=function(t,e){var i=t/e;return i*i},i.outQuad=function(t,e){var i=t/e;return i*(2-i)}},{}],9:[function(t,e,i){\n\"use strict\";function s(t){return t&&\"undefined\"!=typeof Symbol&&t.constructor===Symbol?\"symbol\":typeof t}function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=function(){function t(){if(n(this,t),1===arguments.length)if(\"object\"===s(arguments[0])){var e=arguments[0];this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom}else{var i=arguments[0];this.left=i,this.top=i,this.right=i,this.bottom=i}else 4===arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.right=arguments[2],this.bottom=arguments[3])}return r(t,[{key:\"containsPoint\",value:function(t,e){return this.containsX(t)&&this.containsY(e)}},{key:\"containsY\",value:function(t){return t>=this.top&&t<this.bottom||t>=this.bottom&&t<this.top}},{key:\"containsX\",value:function(t){return t>=this.left&&t<this.right||t>=this.right&&t<this.left}},{key:\"inflate\",value:function(t){return this.left-=t,this.top-=t,this.right+=t,this.bottom+=t,this}},{key:\"clip\",value:function(t){return this.left<t.minX?this.left=t.minX:this.left>t.maxX&&(this.left=t.maxX),this.right<t.minX?this.right=t.minX:this.right>t.maxX&&(this.right=t.maxX),this.top<t.minY?this.top=t.minY:this.top>t.maxY&&(this.top=t.maxY),this.bottom>t.maxY?this.bottom=t.maxY:this.bottom<t.minY&&(this.bottom=t.minY),this}},{key:\"clone\",value:function(){return new t(this)}},{key:\"swapXY\",value:function(){var t=[this.top,this.left];this.left=t[0],this.top=t[1];var e=[this.right,this.bottom];return this.bottom=e[0],this.right=e[1],this}},{key:\"width\",get:function(){return this.right-this.left}},{key:\"height\",get:function(){return this.bottom-this.top}},{key:\"maxY\",get:function(){return Math.max(this.bottom,this.top)}},{key:\"minY\",get:function(){return Math.min(this.bottom,this.top)}},{key:\"minX\",get:function(){return Math.min(this.left,this.right)}},{key:\"maxX\",get:function(){return Math.max(this.left,this.right)}},{key:\"xMidpoint\",get:function(){return(this.left+this.right)/2}},{key:\"yMidpoint\",get:function(){return(this.top+this.bottom)/2}},{key:\"area\",get:function(){return this.width*this.height}}]),t}();i.Rect=o},{}],10:[function(t,e,i){\"use strict\";function s(t){return t&&\"undefined\"!=typeof Symbol&&t.constructor===Symbol?\"symbol\":typeof t}!function(){i.identity=function(t){return t},i.isMissingValue=function(t){return null===t||\"undefined\"==typeof t||isNaN(t)&&\"number\"==typeof t},i.reduce=function(t,e,s){var n,r,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(!t.reduce||s||o){var a=!1;for(s=s||i.identity,r=0;r<t.length;r++){var l=s(t[r],r);o&&i.isMissingValue(l)||(n=a?e(n,l):l,a=!0)}}else n=t.reduce(function(t,i){return e(t,i)});return n},i.sign=Math.sign||function(t){return t>0?1:0>t?-1:0};var t=function e(t,i,n){if(Array.isArray(n)||(n=[n]),!t&&Object.assign)return Object.assign.apply(Object,[i].concat(n));if(void 0===i||null===i)throw new TypeError(\"Cannot convert first argument to object\");for(var r=Object(i),o=0;o<n.length;o++){var a=n[o];if(void 0!==a&&null!==a){a=Object(a);for(var l=Object.keys(a),h=0,u=l.length;u>h;h++){var c=l[h],p=a[c],d=Object.getOwnPropertyDescriptor(a,c);void 0!==d&&d.enumerable&&(t&&!Array.isArray(p)&&\"object\"===(\"undefined\"==typeof p?\"undefined\":s(p))&&null!==p?r[c]=e(!0,{},[r[c],p]):r[c]=p)}}}return r};i.none=function(t){return t.every(function(t){return!t})},i.assign=function(e,i){return t(!1,e,i)},i.deepAssign=function(e,i){return t(!0,e,i)},i.formatString=function(t,e,s){return t.replace(/{(\\w+)}/g,function(t,n){var r=e[n];return\"undefined\"!=typeof r?s?i.stringToHtml(r):r:t})},i.locateDecimalPoint=function(t){return Math.floor(Math.log(t)/Math.log(10))},i.formatNumberThousands=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=t.toFixed(e).split(\".\");return i[0]=i[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\"),i.join(\".\")},i.createAutoNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],s=arguments.length<=2||void 0===arguments[2]?\"\":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(t);return r=0>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(t,r)+s}},i.createFixedNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],s=arguments.length<=2||void 0===arguments[2]?\"\":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3];return function(t){return e+i.formatNumberThousands(t,n)+s}},i.createPercentageFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],s=arguments.length<=2||void 0===arguments[2]?\"%\":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(100*t);return r=n>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(100*t,r)+s}},i.stringToHtml=function(t){var e=document.createElement(\"div\");return e.appendChild(document.createTextNode(t)),e.innerHTML},i.throttle=function(t,e){var i,s;return function(){var n=this,r=Date.now(),o=arguments;i&&i+e>r?(clearTimeout(s),s=setTimeout(function(){i=r,t.apply(n,o)},e)):(i=r,t.apply(n,o))}}}()},{}],11:[function(t,e,i){\"use strict\";function s(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function n(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function r(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=t(\"./helpers/rect\").Rect,l=t(\"./helpers/utils\"),h=t(\"./renderer.base\"),u=t(\"./base.js\").Tayberry,c=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:\"drawPlot\",value:function(){this.ctx.save();for(var t=new p(this),e=void 0;e=t.next();)this.ctx.fillStyle=e.selected?e.renderedSeries.highlightColour:e.renderedSeries.colour,this.ctx.fillRect(e.rect.left,e.rect.top,e.rect.width,e.rect.height);this.ctx.restore()}},{key:\"drawLabels\",value:function(){if(this.tb.options.labels.enabled){this.ctx.save();for(var t=new p(this),e=void 0;e=t.next();)this.ctx.font=this.tb.labelFont,this.ctx.fillStyle=this.tb.options.labels.font.colour,this.drawLabel(e.value,e.series.yAxis.options.labelFormatter(e.value),e.rect);this.ctx.restore()}}},{key:\"hitTest\",value:function(t,e){var i={found:!1,plotType:\"bar\",isXRange:!0},s=this.renderedSeries[0].data.length,n=this.tb.options.swapAxes,r=this.tb.plotArea.clone();n&&r.swapXY();for(var o=Math.floor(s*((n?e:t)-r.left)/r.width),a=[],h=new p(this,o),c=void 0;(c=h.next())&&!(c.categoryIndex>o);){var d=void 0,f=void 0,g=void 0;if(c.rect.containsPoint(t,e))d=0,f=0;else if(c.rect.containsX(t))d=e<c.rect.top?c.rect.top-e:e-c.rect.bottom,f=n?2:1;else if(c.rect.containsY(e))d=t<c.rect.left?c.rect.left-t:t-c.rect.right,f=n?1:2;else{var y=Math.min(Math.abs(t-c.rect.left),Math.abs(t-c.rect.right)),m=Math.min(Math.abs(e-c.rect.top),Math.abs(e-c.rect.bottom));g=Math.sqrt(Math.pow(y,2)+Math.pow(m,2)),d=n?m:y,f=3}\"undefined\"==typeof g&&(g=d),a.push({sortDistance:d,distance:g,priority:f,data:{categoryIndex:c.categoryIndex,seriesIndex:c.seriesIndex,rect:c.rect,series:this.series[c.seriesIndex],value:u.getDataValue(this.series[c.seriesIndex].data[c.categoryIndex])}})}return a.length&&(a.sort(function(t,e){var i=t.priority-e.priority;return i||(i=t.sortDistance-e.sortDistance),i||(i=t.data.rect.height-e.data.rect.height),i}),i.found=!0,i.normalisedDistance=a[0].distance+Math.sqrt(a[0].data.rect.area),i=l.assign(i,a[0].data)),i}}]),e}(h.Renderer),p=function(t){function e(t){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];s(this,e);var r=n(this,Object.getPrototypeOf(e).call(this,t,i));return r.categoryCount&&(r.isStacked=\"stacked\"===r.tb.options.barPlot.mode,r.isOverlaid=\"overlaid\"===r.tb.options.barPlot.mode,r.isNormal=!r.isStacked&&!r.isOverlaid,r.barCount=r.isStacked||r.isOverlaid?1:r.seriesCount,r.categoryWidth=r.plotArea.width/r.categoryCount,r.yOrigin=r.renderer.series[0].yAxis.getOrigin(),r.onNewCategory()),r}return r(e,t),o(e,[{key:\"onNewCategory\",value:function(){this.yBottomPositive=this.yOrigin,this.yBottomNegative=this.yOrigin,this.yRunningTotalPositive=0,this.yRunningTotalNegative=0,this.barIndex=0}},{key:\"next\",value:function(){var t=void 0;if(this.categoryIndex<this.categoryCount){var e=this.renderer.renderedSeries[this.seriesIndex],i=u.getDataValue(e.data[this.categoryIndex]),s=this.plotArea.left+Math.floor(this.categoryIndex*this.categoryWidth),n=this.plotArea.left+Math.floor((this.categoryIndex+1)*this.categoryWidth),r=s+Math.ceil(this.categoryWidth*this.tb.options.barPlot.categorySpacing/2),o=n-Math.floor(this.categoryWidth*this.tb.options.barPlot.categorySpacing/2),l=Math.floor((o-r)/this.barCount),h=Math.floor(r+this.barIndex*l),c=Math.ceil(r+(this.barIndex+1)*l),p=e.yAxis.getValueDisplacement(i+(i>0?this.yRunningTotalPositive:this.yRunningTotalNegative)),d=new a(h,p,c,this.isStacked?i>0?this.yBottomPositive:this.yBottomNegative:e.yAxis.getOrigin());d.left+=Math.ceil(e.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding)/2),d.right-=Math.floor(e.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding)/2),d.right<d.left&&(d.right=d.left),this.isHorizontal&&d.swapXY(),d.clip(this.tb.plotArea),t={seriesIndex:this.seriesIndex,categoryIndex:this.categoryIndex,series:this.renderer.series[this.seriesIndex],renderedSeries:this.renderer.renderedSeries[this.seriesIndex],value:u.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),renderedValue:u.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),rect:d,selected:this.tb.selectedItem.categoryIndex===this.categoryIndex&&(this.tb.options.tooltips.shared||this.tb.selectedItem.series===this.renderer.series[this.seriesIndex])},this.isStacked?i>0?(this.yRunningTotalPositive+=i,this.yBottomPositive=p):(this.yRunningTotalNegative+=i,this.yBottomNegative=p):this.isNormal&&this.barIndex++,this.nextValue()}return t}}]),e}(h.ByCategoryEnumerator);i.BarRenderer=c},{\"./base.js\":2,\"./helpers/rect\":9,\"./helpers/utils\":10,\"./renderer.base\":12}],12:[function(t,e,i){\"use strict\";function s(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function n(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=t(\"./helpers/utils\"),l=t(\"./helpers/easing\"),h=t(\"./base\").Tayberry,u=function(){function t(e,i,s){r(this,t),this.ctx=e,this.tb=i,this.series=null,this.renderedSeries=null,this.setSeries(s)}return o(t,[{key:\"setSeries\",value:function(t){var e;for(this.series=t,this.renderedSeries=t.slice(0),e=0;e<this.renderedSeries.length;e++){var i=this.series[e];i.renderer=this;var s=a.assign({},i);if(s.data=this.renderedSeries[e].data.slice(0),s.data.length&&Array.isArray(s.data[0]))for(var n=0;n<s.data.length;n++)s.data[n]=s.data[n].slice(0);this.renderedSeries[e]=s}}},{key:\"onAnimationFrame\",value:function(t,e){var i;i=Math.min(l.inQuad(t,e),1);for(var s=0;s<this.series[0].data.length;s++)for(var n=0;n<this.series.length;n++){var r=this.series[n],o=h.getDataValue(r.data[s]),a=r.yAxis.min<=0&&0<=r.yAxis.max?0:r.yAxis.min>0?r.yAxis.min:r.yAxis.max;h.setDataValue(this.renderedSeries[n].data,s,a+i*(o-a))}}},{key:\"drawLegendIndicator\",value:function(t,e,i){t.fillStyle=e.colour,t.fillRect(i.left,i.top,i.width,i.height)}},{key:\"drawLabel\",value:function(t,e,i){this.tb.options.swapAxes&&(i=i.clone().swapXY());var s=(i.left+i.right)/2,n=void 0;n=\"top\"===this.tb.options.labels.verticalAlignment?i.top:\"bottom\"===this.tb.options.labels.verticalAlignment?i.bottom:(i.top+i.bottom)/2;var r=\"middle\",o=\"center\";if(this.tb.options.swapAxes){var a=[n,s];s=a[0],n=a[1],\"outside\"===this.tb.options.labels.verticalPosition?o=\"left\":\"inside\"===this.tb.options.labels.verticalPosition&&(o=\"right\")}else r=h.mapVerticalPosition(t,this.tb.options.labels.verticalPosition);this.tb.plotArea.containsPoint(s,n)&&(this.ctx.save(),this.ctx.textAlign=o,this.ctx.textBaseline=r,this.ctx.fillText(e,s,n),this.ctx.restore())}},{key:\"drawPlot\",value:function(){}},{key:\"drawLabels\",value:function(){}},{key:\"hitTest\",value:function(){}}]),t}(),c=function(){function t(e){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];r(this,t),this.renderer=e,this.tb=e.tb,this.categoryCount=this.renderer.renderedSeries[0].data.length,this.categoryIndex=0,this.seriesIndex=0,this.seriesCount=this.renderer.renderedSeries.length,this.categoryCount&&(this.isHorizontal=this.tb.options.swapAxes,this.plotArea=this.tb.plotArea.clone(),this.isHorizontal&&this.plotArea.swapXY(),this.startCategoryIndex=Math.max(i,0),this.startCategoryIndex=Math.min(this.startCategoryIndex,this.categoryCount-1),this.categoryIndex=this.startCategoryIndex)}return o(t,[{key:\"nextValue\",value:function(){}}]),t}(),p=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),o(e,[{key:\"onNewCategory\",value:function(){}},{key:\"nextValue\",value:function(){var t=void 0;do{if(this.seriesIndex+1===this.seriesCount){if(this.seriesIndex=0,this.categoryIndex++,this.categoryIndex>=this.categoryCount)break;this.onNewCategory()}else this.seriesIndex++;t=h.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex])}while(a.isMissingValue(t))}}]),e}(c),d=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),o(e,[{key:\"nextValue\",value:function(){var t=void 0;do{if(this.categoryIndex+1===this.categoryCount){if(this.categoryIndex=this.startCategoryIndex,this.seriesIndex++,this.seriesIndex>=this.seriesCount)break}else this.categoryIndex++;t=h.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex])}while(a.isMissingValue(t))}}]),e}(c);i.Renderer=u,i.ByCategoryEnumerator=p,i.BySeriesEnumerator=d},{\"./base\":2,\"./helpers/easing\":8,\"./helpers/utils\":10}],13:[function(t,e,i){\"use strict\";function s(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}function n(t,e){if(!t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?t:e}function r(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=function y(t,e,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:y(n,e,i)}if(\"value\"in s)return s.value;var r=s.get;return void 0===r?void 0:r.call(i)},l=t(\"./helpers/utils\"),h=t(\"./helpers/rect\").Rect,u=t(\"./renderer.base\"),c=t(\"./base\").Tayberry,p=0,d=[\"square\",\"diamond\",\"circle\",\"triangle\",\"triangle-inversed\"],f=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:\"setSeries\",value:function(t){for(var i=0,s=0;s<t.length;s++)t[s].markerType||(t[s].markerType=d[p%d.length],p++),i+=t[s].data.length;var n=this.tb.options.linePlot.showMarkers;this.showMarkers=\"auto\"===n?i<this.tb.options.linePlot.noMarkersThreshold:n,a(Object.getPrototypeOf(e.prototype),\"setSeries\",this).call(this,t)}},{key:\"drawMarker\",value:function(t,e,i,s){var n=arguments.length<=4||void 0===arguments[4]?this.ctx:arguments[4];\"square\"===t?n.fillRect(e-s/2,i-s/2,s,s):\"diamond\"===t?(n.save(),n.translate(e,i),n.rotate(-Math.PI/4),n.fillRect(0-s/2,0-s/2,s,s),n.restore()):\"circle\"===t?(s=Math.round(1.2*s),n.beginPath(),n.arc(e,i,s/2,0,2*Math.PI),n.fill()):(\"triangle\"===t||\"triangle-inversed\"===t&&(s=-s))&&(s=Math.round(1.2*s),n.beginPath(),n.moveTo(e-s/2,i+s/2),n.lineTo(e,i-s/2),n.lineTo(e+s/2,i+s/2),n.closePath(),n.fill())}},{key:\"drawPlot\",value:function(){this.ctx.save();for(var t=new g(this),e=void 0;e=t.next();)e.firstPoint?(this.ctx.lineWidth=e.seriesSelected?this.tb.options.linePlot.highlightedLineWidth:this.tb.options.linePlot.lineWidth,this.ctx.strokeStyle=e.seriesSelected?e.renderedSeries.highlightColour:e.renderedSeries.colour,this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y)):this.ctx.lineTo(e.x,e.y),e.lastPoint&&this.ctx.stroke();if(this.showMarkers)for(t=new g(this);e=t.next();)e.selected&&(this.ctx.fillStyle=e.renderedSeries.glowColour,this.drawMarker(e.renderedSeries.markerType,e.x,e.y,this.tb.options.linePlot.highlightedMarkerSize)),this.ctx.fillStyle=e.renderedSeries.colour,this.drawMarker(e.renderedSeries.markerType,e.x,e.y,this.tb.options.linePlot.markerSize);this.ctx.restore()}},{key:\"drawLegendIndicator\",value:function(t,e,i){t.save(),t.lineWidth=2,t.strokeStyle=e.colour,this.tb.drawLine(i.left,i.yMidpoint,i.right,i.yMidpoint),t.fillStyle=e.colour,this.drawMarker(e.markerType,i.xMidpoint,i.yMidpoint,this.tb.options.linePlot.markerSize,t),t.restore()}},{key:\"drawLabels\",value:function(){if(this.tb.options.labels.enabled){this.ctx.save(),this.ctx.font=this.tb.labelFont,this.ctx.fillStyle=this.tb.options.labels.font.colour;for(var t=new g(this),e=void 0;e=t.next();){var i=new h(e.x,e.y,e.x,e.y).inflate(this.tb.options.linePlot.markerSize/2);this.drawLabel(e.value,e.series.yAxis.options.labelFormatter(e.value),i)}this.ctx.restore()}}},{key:\"hitTest\",value:function(t,e){for(var i={found:!1,plotType:\"line\",isXRange:!1},s=[],n=new g(this),r=void 0;r=n.next();){var o=Math.sqrt(Math.pow(r.x-t,2)+Math.pow(r.y-e,2)),a=Math.abs(this.tb.options.swapAxes?r.y-e:r.x-t);s.push({distance:o,horizontalDistance:a,priority:0,data:r})}if(s.length){s.sort(function(t,e){return t.horizontalDistance-e.horizontalDistance||t.distance-e.distance}),r=s[0].data;var u=new h(r.x,r.y,r.x,r.y).inflate(this.tb.options.linePlot.markerSize/2);l.assign(i,[{found:!0,rect:u,normalisedDistance:s[0].distance+Math.sqrt(u.area)},r])}return i}}]),e}(u.Renderer),g=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:\"next\",value:function(){var t=void 0;if(this.seriesIndex<this.seriesCount){var e=this.renderer.renderedSeries[this.seriesIndex],i=c.getDataValue(e.data[this.categoryIndex]),s=c.getDataXValue(e.data,this.categoryIndex),n=e.xAxis.getValueDisplacement(s),r=e.yAxis.getValueDisplacement(i);if(this.isHorizontal){var o=[r,n];n=o[0],r=o[1]}t={firstPoint:0===this.categoryIndex,lastPoint:this.categoryIndex+1===this.categoryCount,seriesIndex:this.seriesIndex,categoryIndex:this.categoryIndex,series:this.renderer.series[this.seriesIndex],renderedSeries:this.renderer.renderedSeries[this.seriesIndex],value:c.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),renderedValue:c.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),x:n,y:r,seriesSelected:!this.tb.options.tooltips.shared&&this.tb.selectedItem.series===this.renderer.series[this.seriesIndex],selected:this.tb.selectedItem.categoryIndex===this.categoryIndex&&(this.tb.options.tooltips.shared||this.tb.selectedItem.series===this.renderer.series[this.seriesIndex])},this.nextValue()}return t}}]),e}(u.BySeriesEnumerator);i.LineRenderer=f},{\"./base\":2,\"./helpers/rect\":9,\"./helpers/utils\":10,\"./renderer.base\":12}],14:[function(t,e,i){\"use strict\";var s=t(\"./helpers/rect\").Rect,n=t(\"./base.js\").Tayberry,r=t(\"./helpers/utils\");n.mapVerticalPosition=function(t,e){switch(e){case\"outside\":return t>0?\"bottom\":\"top\";case\"inside\":return t>0?\"top\":\"bottom\";default:return\"middle\"}},n.prototype.mapLogicalXUnit=function(t){return this.scaleFactorX*t},n.prototype.mapLogicalYUnit=function(t){return this.scaleFactorY*t},n.prototype.mapScreenUnit=function(t){return t/this.scaleFactor},n.prototype.calculatePlotArea=function(){var t=this,e=5;this.plotArea=new s(0,0,this.labelsCanvas.width,this.labelsCanvas.height),this.options.title.text&&(this.plotArea.top+=this.mapLogicalYUnit(this.options.elementSmallPadding),this.plotArea.top+=this.getFontHeight(this.options.title.font)*this.getMultilineTextHeight(this.titleFont,this.labelsCanvas.width,this.options.title.text)),this.options.legend.enabled&&(this.plotArea.bottom-=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.elementLargePadding+this.options.legend.indicatorSize)),this.yAxes.map(function(e){return e.adjustSize(t.plotArea,!0,!0)}),this.xAxes.map(function(e){return e.adjustSize(t.plotArea,!0,!0)});for(var i=0;e>i&&(this.yAxes.map(function(t){return t.calculateExtent()}),this.xAxes.map(function(t){return t.calculateExtent()}),this.yAxes.map(function(t){return t.updateFormatter()}),this.xAxes.map(function(t){return t.updateFormatter()}),!r.none(this.yAxes.map(function(e){return e.adjustSize(t.plotArea)}))||!r.none(this.xAxes.map(function(e){return e.adjustSize(t.plotArea)})));i++);this.plotArea.left=Math.ceil(this.plotArea.left),this.plotArea.top=Math.ceil(this.plotArea.top),this.plotArea.right=Math.floor(this.plotArea.right),this.plotArea.bottom=Math.floor(this.plotArea.bottom)},n.prototype.hitTest=function(t,e){for(var i={found:!1},s=[],n=0;n<this.renderers.length;n++){var r=this.renderers[n].hitTest(t,e);r.found&&s.push(r)}return s.length&&(s.sort(function(t,e){return t.normalisedDistance-e.normalisedDistance}),i=s[0]),i}},{\"./base.js\":2,\"./helpers/rect\":9,\"./helpers/utils\":10}],15:[function(t,e,i){\"use strict\";!function(){var i=t(\"./base.js\").Tayberry;t(\"./axis.js\"),t(\"./core.js\"),t(\"./drawing.js\"),t(\"./events.js\"),t(\"./defaults.js\"),t(\"./sizing.js\"),e.exports={create:function(t,e){var s=new i;s.create(t),s.setOptions(e),s.render()}}}()},{\"./axis.js\":1,\"./base.js\":2,\"./core.js\":3,\"./defaults.js\":4,\"./drawing.js\":5,\"./events.js\":6,\"./sizing.js\":14}]},{},[15])(15)});\n//# sourceMappingURL=tayberry.min.js.map\n","class Tayberry {\r\n    constructor() {\r\n        this.selectedItem = {};\r\n        this.containerElement = null;\r\n        this.labelsCanvas = null;\r\n        this.labelsCtx = null;\r\n        this.renderedSeries = null;\r\n        this.options = null;\r\n        this.scaleFactor = null;\r\n        this.titleFont = null;\r\n        this.plotArea = null;\r\n        this.categories = [];\r\n        this.titleFont = null;\r\n        this.labelFont = null;\r\n        this.legendFont = null;\r\n        this.renderers = [];\r\n    }\r\n\r\n    get seriesCount() {\r\n        return this.options.series.length;\r\n    }\r\n\r\n    get categoryCount() {\r\n        return this.options.series.length ? this.options.series[0].data.length : 0;\r\n    }\r\n}\r\n\r\nexports.Tayberry = Tayberry;\r\n\r\n\r\n","'use strict';\r\nvar Colour = require('./helpers/colour').Colour;\r\nvar Utils = require('./helpers/utils');\r\n\r\nvar Tayberry = require('./base').Tayberry;\r\nvar Axis = require('./axis').Axis;\r\nvar BarRenderer = require('./renderer.bar').BarRenderer;\r\nvar LineRenderer = require('./renderer.line').LineRenderer;\r\n\r\nvar currentAutoColourIndex = 0;\r\n\r\nTayberry.getAutoColour = function () {\r\n    let ret = Tayberry.defaultColours[currentAutoColourIndex % Tayberry.defaultColours.length];\r\n    currentAutoColourIndex++;\r\n    return ret;\r\n};\r\n\r\nTayberry.getDataValue = function (dataPoint) {\r\n    let ret;\r\n    if (Array.isArray(dataPoint)) {\r\n        ret = dataPoint[1];\r\n    } else {\r\n        ret = dataPoint;\r\n    }\r\n    return ret;\r\n};\r\n\r\nTayberry.getDataXValue = function (data, index) {\r\n    let ret;\r\n    if (Array.isArray(data[index])) {\r\n        ret = data[index][0];\r\n    } else {\r\n        ret = index;\r\n    }\r\n    return ret;\r\n};\r\n\r\nTayberry.setDataValue = function (data, index, newValue) {\r\n    if (Array.isArray(data[index])) {\r\n        data[index][1] = newValue;\r\n    } else {\r\n        data[index] = newValue;\r\n    }\r\n};\r\n\r\nTayberry.prototype.createCanvas = function () {\r\n    let ret = document.createElement('canvas');\r\n    // IE11 hack-fix - clientWidth sometimes incorrect on first access\r\n    ret.style.width = Math.floor(this.containerElement.clientWidth) + 'px';\r\n    ret.style.width = Math.floor(this.containerElement.clientWidth) + 'px';\r\n    ret.style.height = Math.floor(this.containerElement.clientHeight) + 'px';\r\n    ret.style.position = 'absolute';\r\n    this.containerElement.appendChild(ret);\r\n    return ret;\r\n};\r\n\r\nTayberry.prototype.create = function (containerElement) {\r\n    if (typeof containerElement == 'string') {\r\n        this.containerElement = document.getElementById(containerElement);\r\n    } else {\r\n        this.containerElement = containerElement;\r\n    }\r\n    this.labelsCanvas = this.createCanvas();\r\n    this.labelsCtx = this.labelsCanvas.getContext('2d');\r\n    this.plotCanvas = this.createCanvas();\r\n    this.plotCtx = this.plotCanvas.getContext('2d');\r\n    this.renderedSeries = null;\r\n    this.options = {};\r\n    this.yAxes = null;\r\n    this.xAxes = null;\r\n    this.initialise();\r\n};\r\n\r\nTayberry.prototype.destroy = function () {\r\n    this.labelsCanvas.parentNode.removeChild(this.labelsCanvas);\r\n    this.tooltipElement.parentNode.removeChild(this.tooltipElement);\r\n    this.options = {};\r\n    this.plotCanvas.removeEventListener('mousemove', this.onMouseMoveReal);\r\n    this.plotCanvas.removeEventListener('mouseleave', this.onMouseLeaveReal);\r\n    // this.plotCanvas.removeEventListener('touchstart', this.onTouchStartReal);\r\n    window.removeEventListener('resize', this.onWindowResizeReal);\r\n};\r\n\r\nTayberry.prototype.initialise = function () {\r\n    this.scaleFactor = window.devicePixelRatio || 1.0;\r\n    this.labelsCanvas.width = Math.round(this.labelsCanvas.clientWidth * this.scaleFactor);\r\n    this.labelsCanvas.height = Math.round(this.labelsCanvas.clientHeight * this.scaleFactor);\r\n    this.plotCanvas.width = this.labelsCanvas.width;\r\n    this.plotCanvas.height = this.labelsCanvas.height;\r\n    this.scaleFactorX = this.labelsCanvas.width / this.labelsCanvas.clientWidth;\r\n    this.scaleFactorY = this.labelsCanvas.height / this.labelsCanvas.clientHeight;\r\n    this.selectedItem = {};\r\n    this.plotArea = null;\r\n};\r\n\r\nTayberry.prototype.getFontHeight = function (font, forDom) {\r\n    let ret = font.size;\r\n    if (font.autoScale)\r\n        ret *= Math.pow(this.labelsCanvas.width / 800, 0.25);\r\n    if (!forDom) ret = this.mapLogicalYUnit(ret);\r\n    return ret;\r\n};\r\n\r\nTayberry.prototype.createFontString = function (font, forDom) {\r\n    return (font.style ? font.style + ' ' : '') + this.getFontHeight(font, forDom).toFixed(1) + 'px ' + font.face;\r\n};\r\n\r\nTayberry.prototype.updateFonts = function () {\r\n    //this.labelsCtx.font = this.createFontString(this.options.font);\r\n    this.titleFont = this.createFontString(this.options.title.font);\r\n    this.labelFont = this.createFontString(this.options.labels.font);\r\n    this.legendFont = this.createFontString(this.options.legend.font);\r\n    this.yAxes.map(e => e.updateFonts());\r\n    this.xAxes.map(e => e.updateFonts());\r\n};\r\n\r\nTayberry.prototype.setOptions = function (options) {\r\n    let optionOverrides = [this.defaultOptions()];\r\n    if (!options.presets) {\r\n        options.presets = ['default'];\r\n    }\r\n    if (options.presets) {\r\n        for (let index = 0; index < options.presets.length; index++) {\r\n            optionOverrides.push(Tayberry.presets[options.presets[index]]);\r\n        }\r\n    }\r\n    optionOverrides.push(options);\r\n    this.options = Utils.deepAssign({}, optionOverrides);\r\n    this.options.title.font = Utils.deepAssign({}, [this.options.font, this.options.title.font]);\r\n    this.options.tooltips.font = Utils.deepAssign({}, [this.options.font, this.options.tooltips.font]);\r\n    this.options.labels.font = Utils.deepAssign({}, [this.options.font, this.options.labels.font]);\r\n    this.options.legend.font = Utils.deepAssign({}, [this.options.font, this.options.legend.font]);\r\n    this.options.allAxes.font = Utils.deepAssign({}, [this.options.font, this.options.allAxes.font]);\r\n    this.options.allAxes.title.font = Utils.deepAssign({}, [this.options.font, this.options.allAxes.title.font]);\r\n    if (!Array.isArray(this.options.yAxis))\r\n        this.options.yAxis = [this.options.yAxis || {}];\r\n    if (!Array.isArray(this.options.xAxis))\r\n        this.options.xAxis = [this.options.xAxis || {}];\r\n    for (let i = 0; i < this.options.yAxis.length; i++) {\r\n        this.options.yAxis[i] = Utils.deepAssign({}, [i === 0 ? Tayberry.defaultPrimaryYAxis : Tayberry.defaultSecondaryYAxis, this.options.allAxes, this.options.yAxis[i]]);\r\n    }\r\n    for (let i = 0; i < this.options.xAxis.length; i++) {\r\n        this.options.xAxis[i] = Utils.deepAssign({}, [Tayberry.defaultXAxis, this.options.allAxes, this.options.xAxis[i]]);\r\n    }\r\n\r\n    this.yAxes = [];\r\n    this.xAxes = [];\r\n    for (let i = 0; i < this.options.xAxis.length; i++) {\r\n        this.xAxes.push(Axis.create(this, this.options.xAxis[i], i, 'x', this.options.swapAxes));\r\n    }\r\n    for (let i = 0; i < this.options.yAxis.length; i++) {\r\n        this.yAxes.push(Axis.create(this, this.options.yAxis[i], i, 'y', this.options.swapAxes));\r\n    }\r\n    this.createRenderers();\r\n    this.updateFonts();\r\n    this.plotCanvas.addEventListener('mousemove', this.onMouseMoveReal = this.onMouseMove.bind(this));\r\n    this.plotCanvas.addEventListener('mouseleave', this.onMouseLeaveReal = this.onMouseLeave.bind(this));\r\n    //this.plotCanvas.addEventListener('touchstart', this.onTouchStartReal = this.onTouchStart.bind(this));\r\n    window.addEventListener('resize', this.onWindowResizeReal = Utils.throttle(this.onWindowResize, 50).bind(this));\r\n};\r\n\r\nTayberry.calculateHighlightColour = function (colour) {\r\n    let newColour = new Colour(colour);\r\n    return newColour.increaseBy(30 * (newColour.sum >= 180 * 3 ? -1 : 1)).toString();\r\n};\r\n\r\nTayberry.calculateGlowColour = function (highlightColour) {\r\n    let newColour = new Colour(highlightColour);\r\n    newColour.a = 0.4;\r\n    return newColour.toString();\r\n};\r\n\r\nTayberry.prototype.createRenderers = function () {\r\n    let series, groupedSeries = {'bar': [], 'line': []};\r\n    if (!Array.isArray(this.options.series)) {\r\n        series = [this.options.series];\r\n    } else {\r\n        series = this.options.series;\r\n    }\r\n\r\n    for (let i = 0; i < series.length; i++) {\r\n        const curSeries = series[i];\r\n        curSeries.index = i;\r\n        curSeries.colour = curSeries.colour || Tayberry.getAutoColour();\r\n        curSeries.highlightColour = curSeries.highlightColour || Tayberry.calculateHighlightColour(curSeries.colour);\r\n        curSeries.glowColour = curSeries.glowColour || Tayberry.calculateGlowColour(curSeries.highlightColour);\r\n        curSeries.xAxis = this.xAxes[curSeries.xAxisIndex || 0];\r\n        curSeries.yAxis = this.yAxes[curSeries.yAxisIndex || 0];\r\n        curSeries.plotType = curSeries.plotType || this.options.plotType;\r\n        if (groupedSeries.hasOwnProperty(curSeries.plotType)) {\r\n            groupedSeries[curSeries.plotType].push(curSeries);\r\n        }\r\n    }\r\n    if (groupedSeries['bar'].length) {\r\n        this.renderers.push(new BarRenderer(this.plotCtx, this, groupedSeries['bar']));\r\n    }\r\n    if (groupedSeries['line'].length) {\r\n        this.renderers.push(new LineRenderer(this.plotCtx, this, groupedSeries['line']));\r\n    }\r\n};\r\n\r\nTayberry.prototype.getDataMinMax = function (axis) {\r\n    var minNormal, maxNormal, minStacked, maxStacked;\r\n    if (this.options.barPlot.mode === 'stacked') {\r\n        let seriesPositiveTotals = [];\r\n        let seriesNegativeTotals = [];\r\n        const barSeries = this.options.series.filter(series => series.plotType === 'bar' && series.yAxis === axis);\r\n        if (barSeries.length) {\r\n            for (let categoryIndex = 0; categoryIndex < barSeries[0].data.length; categoryIndex++) {\r\n                seriesPositiveTotals[categoryIndex] = 0;\r\n                seriesNegativeTotals[categoryIndex] = 0;\r\n                for (let seriesIndex = 0; seriesIndex < barSeries.length; seriesIndex++) {\r\n                    const value = Tayberry.getDataValue(barSeries[seriesIndex].data[categoryIndex]);\r\n                    if (!Utils.isMissingValue(value)) {\r\n                        if (value < 0) {\r\n                            seriesNegativeTotals[categoryIndex] += value;\r\n                        } else {\r\n                            seriesPositiveTotals[categoryIndex] += value;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        minStacked = Math.min(0, Utils.reduce(seriesNegativeTotals, Math.min, undefined, true));\r\n        maxStacked = Math.max(Utils.reduce(seriesPositiveTotals, Math.max, undefined, true), 0);\r\n    }\r\n    {\r\n        let seriesMinima = [];\r\n        let seriesMaxima = [];\r\n        for (let index = 0; index < this.options.series.length; index++) {\r\n            const series = this.options.series[index];\r\n            if (series.yAxis === axis && (series.plotType !== 'bar' || this.options.barPlot.mode !== 'stacked')) {\r\n                seriesMinima.push(Utils.reduce(series.data, Math.min, Tayberry.getDataValue, true));\r\n                seriesMaxima.push(Utils.reduce(series.data, Math.max, Tayberry.getDataValue, true));\r\n            }\r\n        }\r\n        minNormal = Utils.reduce(seriesMinima, Math.min, undefined, true);\r\n        maxNormal = Utils.reduce(seriesMaxima, Math.max, undefined, true);\r\n    }\r\n    const min = Utils.reduce([minNormal, minStacked], Math.min, undefined, true);\r\n    const max = Utils.reduce([maxNormal, maxStacked], Math.max, undefined, true);\r\n    return [min, max];\r\n};\r\n\r\nTayberry.prototype.getDataXMinMax = function (axis) {\r\n    var min, max;\r\n    const seriesMinima = [];\r\n    const seriesMaxima = [];\r\n    for (let index = 0; index < this.options.series.length; index++) {\r\n        const series = this.options.series[index];\r\n        if (series.xAxis === axis) {\r\n            seriesMinima.push(Utils.reduce(series.data, Math.min, Tayberry.getDataXValue, true));\r\n            seriesMaxima.push(Utils.reduce(series.data, Math.max, Tayberry.getDataXValue, true));\r\n        }\r\n    }\r\n    min = Utils.reduce(seriesMinima, Math.min, undefined, true);\r\n    max = Utils.reduce(seriesMaxima, Math.max, undefined, true);\r\n    return [min, max];\r\n};\r\n\r\n\r\nTayberry.prototype.createTooltip = function () {\r\n    if (this.tooltipElement) {\r\n        this.tooltipElement.parentNode.removeChild(this.tooltipElement);\r\n        this.tooltipElement = null;\r\n    }\r\n    this.tooltipElement = document.createElement('div');\r\n    this.tooltipElement.className = 'tayberry-tooltip';\r\n    this.tooltipElement.style.position = 'absolute';\r\n    this.tooltipElement.style.left = '0px';\r\n    this.tooltipElement.style.top = '0px';\r\n    this.tooltipElement.style.zIndex = '99999';\r\n    this.tooltipElement.style.font = this.createFontString(this.options.tooltips.font, true);\r\n    this.tooltipElement.style.borderRadius = '3px';\r\n    this.tooltipElement.style.backgroundColor = 'white';\r\n    this.tooltipElement.style.border = '2px solid #bbb';\r\n    this.tooltipElement.style.padding = '0.15em 0.4em';\r\n    this.tooltipElement.style.display = 'none';\r\n    this.tooltipElement.innerHTML = '';\r\n    document.body.appendChild(this.tooltipElement);\r\n    this.tooltipElement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n    this.tooltipElement.addEventListener('mouseleave', this.onMouseLeave.bind(this));\r\n};\r\n","'use strict';\r\nvar Tayberry = require('./base.js').Tayberry;\r\nvar Utils = require('./helpers/utils');\r\n\r\nTayberry.prototype.defaultOptions = function () {\r\n    return {\r\n        title: {\r\n            text: '',\r\n            font: {\r\n                size: 20\r\n            }\r\n        },\r\n        font: {\r\n            colour: '#444',\r\n            size: 12,\r\n            face: 'sans-serif',\r\n            style: '',\r\n            autoScale: true\r\n        },\r\n        allAxes: {\r\n            font: {},\r\n            title: {\r\n                font: {}\r\n            }\r\n        },\r\n        xAxis: [],\r\n        yAxis: [],\r\n        animations: {\r\n            enabled: true\r\n        },\r\n        series: [],\r\n        backgroundColour: undefined,\r\n        swapAxes: false,\r\n        plotType: 'bar',\r\n        barPlot: {\r\n            mode: 'normal', //[normal|stacked|overlaid]\r\n            barPadding: 2,\r\n            categorySpacing: 0.3\r\n        },\r\n        linePlot: {\r\n            lineWidth: 2,\r\n            highlightedLineWidth: 4,\r\n            showMarkers: 'auto',\r\n            noMarkersThreshold: 100,\r\n            markerSize: 10,\r\n            highlightedMarkerSize: 18\r\n        },\r\n        elementSmallPadding: 5,\r\n        elementLargePadding: 10,\r\n        presets: [],\r\n        tooltips: {\r\n            shared: false,\r\n            headerTemplate: '<strong>{category}</strong><table>',\r\n            valueTemplate: '<tr><td style=\"padding-right: 0.5em\"><span style=\"color: {colour}\">\\u25CF</span> {name}</td><td style=\"text-align: right\">{value}</td></tr>',\r\n            footerTemplate: '</table>',\r\n            font: {}\r\n        },\r\n        legend: {\r\n            enabled: true,\r\n            indicatorSize: 15,\r\n            font: {}\r\n        },\r\n        labels: {\r\n            enabled: false,\r\n            verticalAlignment: 'top',\r\n            verticalPosition: 'outside',\r\n            font: {}\r\n        }\r\n    }\r\n};\r\n\r\nTayberry.defaultXAxis = {\r\n    title: {\r\n        text: '',\r\n        font: {}\r\n    },\r\n    type: 'categorial',\r\n    min: null,\r\n    max: null,\r\n    tickStep: 40,\r\n    tickStepValue: null,\r\n    font: {},\r\n    categories: [],\r\n    labelPosition: 'middle', //left|middle|right\r\n    placement: 'auto',\r\n    gridLines: {}\r\n};\r\n\r\nTayberry.defaultYAxis = {\r\n    title: {\r\n        text: '',\r\n        font: {}\r\n    },\r\n    min: undefined,\r\n    max: undefined,\r\n    tickStep: 40,\r\n    tickStepValue: null,\r\n    font: {},\r\n    labelFormat: 'number', //[number|percentage|currency],\r\n    labelFormatter: undefined,\r\n    labelPrefix: undefined,\r\n    labelSuffix: undefined,\r\n    currencySymbol: '',\r\n    placement: 'auto',\r\n    type: 'linear',\r\n    gridLines: {}\r\n\r\n};\r\n\r\nTayberry.defaultPrimaryYAxis = Utils.deepAssign({}, [Tayberry.defaultYAxis, {\r\n    gridLines: {\r\n        colour: '#ccc'\r\n    }\r\n}]);\r\n\r\nTayberry.defaultSecondaryYAxis = Tayberry.defaultYAxis;\r\n\r\nTayberry.presets = {\r\n    histogram: {\r\n        barPlot: {\r\n            mode: 'overlaid',\r\n            categorySpacing: 0,\r\n            barPadding: 1\r\n        }\r\n    },\r\n    darkGrid: {\r\n        allAxes: {\r\n            gridLines: {\r\n                colour: 'rgba(255, 255, 255, 0.6)'\r\n            }\r\n        },\r\n        plotBackgroundColour: '#E5E5E5'\r\n    }\r\n};\r\n\r\nTayberry.defaultColours = [\r\n    '#6FE87B', //green\r\n    '#FFAB51', //orange\r\n    '#51A8FF', //blue\r\n    '#B651FF', //purple\r\n    '#FF6051', //red\r\n    '#636363', //dark grey\r\n    '#FFE314', //yellow\r\n    '#A88572', //brown\r\n    '#B7B7B7' //light grey\r\n];\r\n","'use strict';\r\nvar Tayberry = require('./base').Tayberry;\r\nvar Rect = require('./helpers/rect').Rect;\r\nvar Utils = require('./helpers/utils');\r\n\r\nTayberry.prototype.getTextWidth = function (text, fontString) {\r\n    let ret;\r\n    if (fontString) {\r\n        this.labelsCtx.save();\r\n        this.labelsCtx.font = fontString;\r\n    }\r\n    ret = this.labelsCtx.measureText(text).width;\r\n    if (fontString) {\r\n        this.labelsCtx.restore();\r\n    }\r\n    return ret;\r\n};\r\n\r\nTayberry.prototype.getMultilineTextHeight = function (fontString, maxWidth, text) {\r\n    let ret;\r\n    if (fontString) {\r\n        this.labelsCtx.save();\r\n        this.labelsCtx.font = fontString;\r\n    }\r\n    ret = this.splitMultilineText(maxWidth, text).length;\r\n    if (fontString) {\r\n        this.labelsCtx.restore();\r\n    }\r\n    return ret;\r\n};\r\n\r\n\r\nTayberry.prototype.splitMultilineText = function (maxWidth, text) {\r\n    let lines = [];\r\n    let lineWidth = 0;\r\n    let lineText = '';\r\n    const spaceWidth = this.labelsCtx.measureText(' ').width;\r\n    for (let i = 0; i < text.length;) {\r\n        const wordStart = i;\r\n        while (i < text.length && text[i] !== ' ' && text[i] !== '\\r' && text[i] !== '\\n') i++;\r\n        const wordEnd = i;\r\n        while (i < text.length && (text[i] === ' ' || text[i] === '\\r' || text[i] === '\\n')) i++;\r\n        if (wordEnd > wordStart) {\r\n            const word = text.substring(wordStart, wordEnd);\r\n            const wordWidth = this.labelsCtx.measureText(word).width;\r\n            if (lineWidth + wordWidth > maxWidth) {\r\n                if (!lineWidth) {\r\n                    lineText = word;\r\n                }\r\n                lines.push(lineText);\r\n                if (lineWidth) {\r\n                    lineWidth = 0;\r\n                    lineText = word;\r\n                }\r\n            } else {\r\n                lineText += (lineText ? ' ' : '') + word;\r\n                lineWidth += wordWidth + spaceWidth;\r\n            }\r\n        }\r\n    }\r\n    if (lineText) {\r\n        lines.push(lineText);\r\n    }\r\n    return lines;\r\n};\r\n\r\nTayberry.prototype.drawTextMultiline = function (lineHeight, x, y, maxWidth, text) {\r\n    let lines = this.splitMultilineText(maxWidth, text);\r\n\r\n    for (let i = 0; i < lines.length; i++) {\r\n        let line = lines[i];\r\n        this.labelsCtx.fillText(line, x, y + lineHeight * i);\r\n    }\r\n};\r\n\r\nTayberry.prototype.render = function () {\r\n    this.calculatePlotArea();\r\n    this.drawLabelLayer();\r\n    this.createTooltip();\r\n    if (this.options.animations.enabled) {\r\n        this.animator = requestAnimationFrame(this.onAnimate.bind(this));\r\n        this.animationStart = (typeof performance !== 'undefined' && typeof performance.now !== 'undefined') ? performance.now() : null;\r\n        this.animationLength = 500;\r\n    } else {\r\n        this.drawPlotLayer();\r\n    }\r\n};\r\n\r\nTayberry.prototype.clear = function (plot = true, labels = true) {\r\n    if (plot) this.plotCtx.clearRect(0, 0, this.plotCanvas.width, this.plotCanvas.height);\r\n    if (labels) this.labelsCtx.clearRect(0, 0, this.labelsCanvas.width, this.labelsCanvas.height);\r\n};\r\n\r\nTayberry.prototype.drawBackground = function () {\r\n    if (this.options.plotBackgroundColour) {\r\n        this.labelsCtx.save();\r\n        this.labelsCtx.fillStyle = this.options.plotBackgroundColour;\r\n        this.labelsCtx.fillRect(this.plotArea.left, this.plotArea.top, this.plotArea.width, this.plotArea.height);\r\n        this.labelsCtx.restore();\r\n    }\r\n};\r\n\r\nTayberry.prototype.drawTitle = function () {\r\n    if (this.options.title.text) {\r\n        const x = (this.labelsCanvas.width) / 2, y = 0;\r\n        this.labelsCtx.save();\r\n        this.labelsCtx.textAlign = 'center';\r\n        this.labelsCtx.textBaseline = 'top';\r\n        this.labelsCtx.font = this.titleFont;\r\n        this.labelsCtx.fillStyle = this.options.title.font.colour;\r\n        this.drawTextMultiline(this.getFontHeight(this.options.title.font), x, y, this.labelsCanvas.width, this.options.title.text);\r\n        // this.labelsCtx.fillText(this.options.title.text, x, y);\r\n        this.labelsCtx.restore();\r\n    }\r\n};\r\n\r\nTayberry.prototype.drawPlotLayer = function () {\r\n    for (let i = 0; i < this.renderers.length; i++) {\r\n        this.renderers[i].drawPlot();\r\n    }\r\n    for (let i = 0; i < this.renderers.length; i++) {\r\n        this.renderers[i].drawLabels();\r\n    }\r\n};\r\n\r\n\r\nTayberry.prototype.drawLine = function (x1, y1, x2, y2, colour, ctx = this.labelsCtx) {\r\n    ctx.save();\r\n    if (colour) {\r\n        ctx.strokeStyle = colour;\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x1 + 0.5, y1 + 0.5);\r\n    ctx.lineTo(x2 + 0.5, y2 + 0.5);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n};\r\n\r\nTayberry.prototype.drawLabelLayer = function () {\r\n    this.drawBackground();\r\n    this.drawTitle();\r\n    let offsetRect = new Rect(0);\r\n    this.xAxes.map(e => e.draw(offsetRect));\r\n    this.yAxes.map(e => e.draw(offsetRect));\r\n    this.drawLegend();\r\n};\r\n\r\nTayberry.prototype.redraw = function (plotOnly) {\r\n    this.clear(true, !plotOnly);\r\n    if (!plotOnly) {\r\n        this.drawLabelLayer();\r\n    }\r\n    this.drawPlotLayer();\r\n};\r\n\r\n\r\nTayberry.prototype.drawLegend = function () {\r\n    if (this.options.legend.enabled) {\r\n        this.labelsCtx.save();\r\n        this.labelsCtx.font = this.legendFont;\r\n        let totalWidth = 0;\r\n        const indicatorSize = this.mapLogicalXUnit(this.options.legend.indicatorSize);\r\n        for (let index = 0; index < this.options.series.length; index++) {\r\n            const series = this.options.series[index];\r\n            if (series.name) {\r\n                totalWidth += this.getTextWidth(series.name, this.legendFont) + indicatorSize + this.mapLogicalXUnit(this.options.elementSmallPadding + this.options.elementLargePadding);\r\n            }\r\n        }\r\n        let x = this.plotArea.left + this.plotArea.width / 2 - totalWidth / 2,\r\n            y = this.labelsCanvas.height - indicatorSize;\r\n\r\n        for (let index = 0; index < this.options.series.length; index++) {\r\n            const series = this.options.series[index];\r\n            if (series.name) {\r\n                series.renderer.drawLegendIndicator(this.labelsCtx, series, new Rect(x, y, x + indicatorSize, y + indicatorSize));\r\n                this.labelsCtx.textBaseline = 'middle';\r\n                this.labelsCtx.fillStyle = this.options.legend.font.colour;\r\n                x += indicatorSize + this.mapLogicalXUnit(this.options.elementSmallPadding);\r\n                this.labelsCtx.fillText(series.name, x, y + indicatorSize / 2);\r\n                x += this.getTextWidth(series.name, this.legendFont) + this.mapLogicalXUnit(this.options.elementLargePadding);\r\n            }\r\n        }\r\n        this.labelsCtx.restore();\r\n    }\r\n};\r\n","'use strict';\r\nvar Rect = require('./helpers/rect').Rect;\r\nvar Utils = require('./helpers/utils');\r\n\r\nvar Tayberry = require('./base').Tayberry;\r\n\r\nTayberry.prototype.onAnimate = function (timestamp) {\r\n    var elapsed;\r\n    if (this.animationStart === null) {\r\n        this.animationStart = timestamp;\r\n    }\r\n    elapsed = timestamp - this.animationStart;\r\n    for (let i = 0; i < this.renderers.length; i++) {\r\n        this.renderers[i].onAnimationFrame(elapsed, this.animationLength);\r\n    }\r\n    this.redraw(true);\r\n    if (elapsed < this.animationLength) {\r\n        this.animator = requestAnimationFrame(this.onAnimate.bind(this));\r\n    }\r\n};\r\n\r\nTayberry.prototype.onMouseLeave = function (event) {\r\n    if ((event.currentTarget == this.plotCanvas && event.relatedTarget !== this.tooltipElement) || (event.currentTarget == this.tooltipElement && event.relatedTarget !== this.plotCanvas)) {\r\n        this.selectedItem = {};\r\n        this.tooltipElement.style.display = 'none';\r\n        this.redraw();\r\n    }\r\n};\r\n\r\nTayberry.prototype.handleMouseMove = function (clientX, clientY) {\r\n    let boundingRect = new Rect(this.plotCanvas.getBoundingClientRect());\r\n    let ret = false;\r\n    if (boundingRect.containsPoint(clientX, clientY)) {\r\n        let x = clientX - boundingRect.left;\r\n        let y = clientY - boundingRect.top;\r\n\r\n        let hitTestResult = this.hitTest(this.mapLogicalXUnit(x), this.mapLogicalYUnit(y));\r\n        if (hitTestResult.found) {\r\n            let tooltipHtml = '';\r\n            const aboveZero = hitTestResult.rect.top < hitTestResult.rect.bottom;\r\n            this.tooltipElement.style.display = 'block';\r\n            if (this.options.tooltips.shared) {\r\n                const category = this.xAxes[0].getCategoryLabel(hitTestResult.categoryIndex, this.categoryCount, hitTestResult.isXRange);\r\n                tooltipHtml += Utils.formatString(this.options.tooltips.headerTemplate, {category: category}, true);\r\n                for (let index = 0; index < this.seriesCount; index++) {\r\n                    const series = this.options.series[index];\r\n                    const value = Tayberry.getDataValue(series.data[hitTestResult.categoryIndex]);\r\n                    tooltipHtml += Utils.formatString(this.options.tooltips.valueTemplate, {\r\n                        value: series.yAxis.options.labelFormatter(value),\r\n                        name: series.name,\r\n                        colour: series.colour\r\n                    }, true);\r\n                }\r\n            } else {\r\n                const series = hitTestResult.series;\r\n                const value = hitTestResult.value;\r\n                const category = series.xAxis.getCategoryLabel(hitTestResult.categoryIndex, this.categoryCount, hitTestResult.isXRange);\r\n                tooltipHtml += Utils.formatString(this.options.tooltips.headerTemplate, {category: category}, true);\r\n                tooltipHtml += Utils.formatString(this.options.tooltips.valueTemplate, {\r\n                    value: series.yAxis.options.labelFormatter(value),\r\n                    name: series.name,\r\n                    colour: series.colour\r\n                }, true);\r\n            }\r\n            tooltipHtml += this.options.tooltips.footerTemplate;\r\n            this.tooltipElement.innerHTML = tooltipHtml;\r\n            let tooltipRect = this.tooltipElement.getBoundingClientRect();\r\n            if (!this.options.tooltips.shared) {\r\n                this.tooltipElement.style.borderColor = hitTestResult.series.colour;\r\n            }\r\n            this.tooltipElement.style.left = window.pageXOffset + boundingRect.left + this.mapScreenUnit(hitTestResult.rect.width) / 2 + hitTestResult.rect.left / this.scaleFactor - tooltipRect.width / 2 + 'px';\r\n            this.tooltipElement.style.top = window.pageYOffset + boundingRect.top + this.mapScreenUnit(hitTestResult.rect.top) - tooltipRect.height * (aboveZero ? 1 : 0) - this.options.elementSmallPadding * (aboveZero ? 1 : -1) + 'px';\r\n            this.selectedItem = hitTestResult;\r\n            ret = true;\r\n        }\r\n    }\r\n    return ret;\r\n};\r\n\r\n\r\n//Tayberry.prototype.onTouchStart = function (event) {\r\n//    for (let index = 0; index < event.targetTouches.length; index++) {\r\n//        let touch = event.targetTouches[index];\r\n//        if (this.handleMouseMove(touch.clientX, touch.clientY)) {\r\n//            // event.preventDefault();\r\n//            this.redraw();\r\n//            break;\r\n//        }\r\n//    }\r\n//};\r\n\r\n\r\nTayberry.prototype.onMouseMove = function (event) {\r\n    let oldSelectedItem = Utils.assign({}, this.selectedItem);\r\n    if (!this.handleMouseMove(event.clientX, event.clientY)) {\r\n        this.selectedItem = {};\r\n    }\r\n\r\n    if (oldSelectedItem.categoryIndex !== this.selectedItem.categoryIndex || oldSelectedItem.series !== this.selectedItem.series) {\r\n        this.redraw();\r\n    }\r\n};\r\n\r\nTayberry.prototype.onWindowResize = function () {\r\n    this.tooltipElement.style.display = 'none';\r\n    this.labelsCanvas.style.width = Math.floor(this.containerElement.clientWidth) + 'px';\r\n    this.labelsCanvas.style.height = Math.floor(this.containerElement.clientHeight) + 'px';\r\n    this.plotCanvas.style.width = Math.floor(this.containerElement.clientWidth) + 'px';\r\n    this.plotCanvas.style.height = Math.floor(this.containerElement.clientHeight) + 'px';\r\n    this.initialise();\r\n    this.updateFonts();\r\n    this.calculatePlotArea();\r\n    this.createTooltip();\r\n    this.redraw();\r\n};\r\n","var Utils = require('./utils');\r\nclass Colour {\r\n    /**\r\n     * Constructs a Colour object.\r\n     *\r\n     * @param colourCode    an HTML colour code in hex or integer (rgb) form\r\n     */\r\n    constructor() {\r\n        if (arguments.length === 1) {\r\n            let arg1 = arguments[0];\r\n            if (typeof arg1 === 'string')\r\n                this.parseString(arg1);\r\n            else {\r\n                this.r = arg1.r;\r\n                this.g = arg1.g;\r\n                this.b = arg1.b;\r\n                this.a = arg1.a;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Parses an HTML colour code\r\n     * @param str\r\n     * @returns {Colour}\r\n     */\r\n    parseString(str) {\r\n        let regExHex = /^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;\r\n        let regExInt = /^rgba?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})(\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*)?\\)$/i;\r\n        const groupsHex = regExHex.exec(str);\r\n        const groupsInt = regExInt.exec(str);\r\n        if (groupsHex) {\r\n            let parseHex = function (value) {\r\n                let ret = parseInt(value, 16);\r\n                ret = ret * 0x10 + ret;\r\n                return ret;\r\n            };\r\n            this.r = groupsHex[1] ? parseInt(groupsHex[1], 16) : parseHex(groupsHex[4]);\r\n            this.g = groupsHex[2] ? parseInt(groupsHex[2], 16) : parseHex(groupsHex[5]);\r\n            this.b = groupsHex[3] ? parseInt(groupsHex[3], 16) : parseHex(groupsHex[6]);\r\n            this.a = null;\r\n        }\r\n        else if (groupsInt) {\r\n            this.r = parseInt(groupsInt[1]);\r\n            this.g = parseInt(groupsInt[2]);\r\n            this.b = parseInt(groupsInt[3]);\r\n            this.a = groupsInt[5] ? parseFloat(groupsInt[5]) : null;\r\n        } else {\r\n            throw new RangeError(str + \" is not a valid HTML colour\");\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clips a colour component to be in the range [0, 255], and round it them to\r\n     * the nearest integer\r\n     * @param component\r\n     * @returns {Colour}\r\n     */\r\n    clipComponent(component) {\r\n        this[component] = Math.round(this[component]);\r\n        this[component] = Math.min(this[component], 255);\r\n        this[component] = Math.max(this[component], 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clips r,g,b colour components to be in the range [0, 255], and rounds them to\r\n     * the nearest integer\r\n     * @returns {Colour}\r\n     */\r\n    clip() {\r\n        this.clipComponent('r');\r\n        this.clipComponent('g');\r\n        this.clipComponent('b');\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds a number to each colour component\r\n     * @param number\r\n     * @returns {Colour}\r\n     */\r\n    increaseBy(number) {\r\n        this.r += number;\r\n        this.g += number;\r\n        this.b += number;\r\n        this.clip();\r\n        return this;\r\n    }\r\n\r\n    get sum() {\r\n        return this.r + this.g + this.b;\r\n    }\r\n\r\n    /**\r\n     * Formats this colour as a string\r\n     * @returns {String}\r\n     */\r\n    toString() {\r\n        var ret;\r\n        if (this.a) {\r\n            ret = Utils.formatString('rgba({r},{g},{b},{a})', this);\r\n        } else {\r\n            ret = Utils.formatString('rgb({r},{g},{b})', this);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n}\r\n\r\nexports.Colour = Colour;","exports.linear = function (time, duration) {\r\n    return (time / duration);\r\n};\r\n\r\nexports.linear = function (time, duration) {\r\n    return (time / duration);\r\n};\r\n\r\nexports.inQuad = function (time, duration) {\r\n    var factor = time / duration;\r\n    return factor * factor;\r\n};\r\n\r\nexports.outQuad = function (time, duration) {\r\n    var factor = time / duration;\r\n    return factor * (2 - factor);\r\n};\r\n","class Rect {\r\n    constructor() {\r\n        if (arguments.length === 1) {\r\n            if (typeof arguments[0] === 'object') {\r\n                const rect = arguments[0];\r\n                this.left = rect.left;\r\n                this.top = rect.top;\r\n                this.right = rect.right;\r\n                this.bottom = rect.bottom;\r\n            } else {\r\n                const val = arguments[0];\r\n                this.left = val;\r\n                this.top = val;\r\n                this.right = val;\r\n                this.bottom = val;\r\n            }\r\n        } else if (arguments.length === 4) {\r\n            this.left = arguments[0];\r\n            this.top = arguments[1];\r\n            this.right = arguments[2];\r\n            this.bottom = arguments[3];\r\n        }\r\n    }\r\n\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n\r\n    get maxY() {\r\n        return Math.max(this.bottom, this.top);\r\n    }\r\n\r\n    get minY() {\r\n        return Math.min(this.bottom, this.top);\r\n    }\r\n\r\n    get minX() {\r\n        return Math.min(this.left, this.right);\r\n    }\r\n\r\n    get maxX() {\r\n        return Math.max(this.left, this.right);\r\n    }\r\n\r\n    get xMidpoint() {\r\n        return (this.left + this.right) / 2;\r\n    }\r\n\r\n    get yMidpoint() {\r\n        return (this.top + this.bottom) / 2;\r\n    }\r\n\r\n    get area() {\r\n        return this.width * this.height;\r\n    }\r\n\r\n    containsPoint(x, y) {\r\n        return this.containsX(x) && this.containsY(y);\r\n    }\r\n\r\n    containsY(y) {\r\n        return (y >= this.top && y < this.bottom) || (y >= this.bottom && y < this.top);\r\n    }\r\n\r\n    containsX(x) {\r\n        return (x >= this.left && x < this.right) || (x >= this.right && x < this.left);\r\n    }\r\n\r\n    inflate(val) {\r\n        this.left -= val;\r\n        this.top -= val;\r\n        this.right += val;\r\n        this.bottom += val;\r\n        return this;\r\n    }\r\n\r\n    clip(clipRect) {\r\n        //FIXME: In theory, we should be more careful about how we handle rects where right < left or bottom < top\r\n        if (this.left < clipRect.minX) this.left = clipRect.minX;\r\n        else if (this.left > clipRect.maxX) this.left = clipRect.maxX;\r\n\r\n        if (this.right < clipRect.minX) this.right = clipRect.minX;\r\n        else if (this.right > clipRect.maxX) this.right = clipRect.maxX;\r\n\r\n        if (this.top < clipRect.minY)\r\n            this.top = clipRect.minY;\r\n        else if (this.top > clipRect.maxY)\r\n            this.top = clipRect.maxY;\r\n\r\n        if (this.bottom > clipRect.maxY)\r\n            this.bottom = clipRect.maxY;\r\n        else if (this.bottom < clipRect.minY)\r\n            this.bottom = clipRect.minY;\r\n\r\n        return this;\r\n    }\r\n\r\n    clone() {\r\n        return new Rect(this);\r\n    }\r\n\r\n    swapXY() {\r\n        [this.left, this.top] = [this.top, this.left];\r\n        [this.bottom, this.right] = [this.right, this.bottom];\r\n        return this;\r\n    }\r\n}\r\n\r\nexports.Rect = Rect;","(function () {\r\n    \"use strict\";\r\n\r\n    exports.identity = function (obj) {\r\n        return obj;\r\n    };\r\n\r\n    exports.isMissingValue = function (n) {\r\n        return n === null || typeof n === 'undefined' || (isNaN(n) && typeof n === 'number');\r\n    };\r\n\r\n    exports.reduce = function (array, func, getter, ignoreMissing = false) {\r\n        var ret, i;\r\n        if (array.reduce && !getter && !ignoreMissing) {\r\n            ret = array.reduce(function (a, b) {\r\n                return func(a, b);\r\n            });\r\n        } else {\r\n            let retInitialised = false;\r\n            getter = getter || exports.identity;\r\n            for (i = 0; i < array.length; i++) {\r\n                const value = getter(array[i], i);\r\n                if (!ignoreMissing || !exports.isMissingValue(value)) {\r\n                    ret = retInitialised ? func(ret, value) : value;\r\n                    retInitialised = true;\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n\r\n    exports.sign = Math.sign || function (n) {\r\n            return n > 0 ? 1 : (n < 0 ? -1 : 0);\r\n        };\r\n\r\n    var innerAssign = function (deepAssign, targetObject, sourceObjects) {\r\n        if (!Array.isArray(sourceObjects))\r\n            sourceObjects = [sourceObjects];\r\n        if (!deepAssign && Object.assign) {\r\n            return Object.assign.apply(Object, [targetObject].concat(sourceObjects));\r\n        } else {\r\n            if (targetObject === undefined || targetObject === null) {\r\n                throw new TypeError('Cannot convert first argument to object');\r\n            }\r\n\r\n            var to = Object(targetObject);\r\n            for (let i = 0; i < sourceObjects.length; i++) {\r\n                let currentSourceObject = sourceObjects[i];\r\n                if (currentSourceObject === undefined || currentSourceObject === null) {\r\n                    continue;\r\n                }\r\n                currentSourceObject = Object(currentSourceObject);\r\n\r\n                const keysArray = Object.keys(currentSourceObject);\r\n                for (let nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n                    const nextKey = keysArray[nextIndex];\r\n                    const nextValue = currentSourceObject[nextKey];\r\n                    const desc = Object.getOwnPropertyDescriptor(currentSourceObject, nextKey);\r\n                    if (desc !== undefined && desc.enumerable) {\r\n                        if (deepAssign && !Array.isArray(nextValue) && typeof nextValue === 'object' && nextValue !== null)\r\n                            to[nextKey] = innerAssign(true, {}, [to[nextKey], nextValue]);\r\n                        else\r\n                            to[nextKey] = nextValue;\r\n                    }\r\n                }\r\n            }\r\n            return to;\r\n        }\r\n    };\r\n\r\n    exports.none = function(array) {\r\n        return array.every(elem => !elem);\r\n    };\r\n\r\n    exports.assign = function (targetObject, sourceObjects) {\r\n        return innerAssign(false, targetObject, sourceObjects);\r\n    };\r\n\r\n    exports.deepAssign = function (targetObject, sourceObjects) {\r\n        return innerAssign(true, targetObject, sourceObjects);\r\n    };\r\n\r\n    exports.formatString = function (formatString, formatValues, escapeAsHtml) {\r\n        return formatString.replace(/{(\\w+)}/g, function (match, placeholder) {\r\n            const value = formatValues[placeholder];\r\n            return typeof value !== 'undefined' ? (escapeAsHtml ? exports.stringToHtml(value) : value) : match;\r\n        });\r\n    };\r\n\r\n    exports.locateDecimalPoint = function (number) {\r\n        return Math.floor(Math.log(number) / Math.log(10));\r\n    };\r\n\r\n    exports.formatNumberThousands = function (number, decimalPlaces = 0) {\r\n        var parts = number.toFixed(decimalPlaces).split(\".\");\r\n        parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n        return parts.join(\".\");\r\n    };\r\n\r\n    exports.createAutoNumberFormatter = function (scale, prefix = '', suffix = '', precision = 2) {\r\n        let decimalPlaces = exports.locateDecimalPoint(scale);\r\n        decimalPlaces = decimalPlaces < 0 ? -decimalPlaces + precision - 1 : 0;\r\n        return x => prefix + exports.formatNumberThousands(x, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.createFixedNumberFormatter = function (scale, prefix = '', suffix = '', decimalPlaces = 2) {\r\n        return x => prefix + exports.formatNumberThousands(x, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.createPercentageFormatter = function (scale, prefix = '', suffix = '%', precision = 2) {\r\n        let decimalPlaces = exports.locateDecimalPoint(scale * 100);\r\n        decimalPlaces = decimalPlaces < precision ? -decimalPlaces + precision - 1 : 0;\r\n        return x => prefix + exports.formatNumberThousands(x * 100, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.stringToHtml = function (str) {\r\n        var div = document.createElement('div');\r\n        div.appendChild(document.createTextNode(str));\r\n        return div.innerHTML;\r\n    };\r\n\r\n    exports.throttle = function (fn, threshold) {\r\n        var last,\r\n            deferTimer;\r\n        return function () {\r\n            var context = this;\r\n\r\n            var now = Date.now(),\r\n                args = arguments;\r\n            if (last && now < last + threshold) {\r\n                clearTimeout(deferTimer);\r\n                deferTimer = setTimeout(function () {\r\n                    last = now;\r\n                    fn.apply(context, args);\r\n                }, threshold);\r\n            } else {\r\n                last = now;\r\n                fn.apply(context, args);\r\n            }\r\n        };\r\n    }\r\n\r\n})();\r\n","'use strict';\r\nvar Rect = require('./helpers/rect').Rect;\r\nvar Utils = require('./helpers/utils');\r\nvar renderer = require('./renderer.base');\r\nvar Tayberry = require('./base.js').Tayberry;\r\n\r\nclass BarRenderer extends renderer.Renderer {\r\n    drawPlot() {\r\n        this.ctx.save();\r\n        let barEnumerator = new BarEnumerator(this);\r\n        let bar;\r\n        while ((bar = barEnumerator.next())) {\r\n            this.ctx.fillStyle = bar.selected ? bar.renderedSeries.highlightColour : bar.renderedSeries.colour;\r\n            this.ctx.fillRect(bar.rect.left, bar.rect.top, bar.rect.width, bar.rect.height);\r\n        }\r\n        this.ctx.restore();\r\n    }\r\n\r\n    drawLabels() {\r\n        if (this.tb.options.labels.enabled) {\r\n            this.ctx.save();\r\n            let barEnumerator = new BarEnumerator(this);\r\n            let bar;\r\n            while ((bar = barEnumerator.next())) {\r\n                this.ctx.font = this.tb.labelFont;\r\n                this.ctx.fillStyle = this.tb.options.labels.font.colour;\r\n                this.drawLabel(bar.value, bar.series.yAxis.options.labelFormatter(bar.value), bar.rect);\r\n            }\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n\r\n    hitTest(x, y) {\r\n        // TODO: Optimise\r\n        let ret = {\r\n            found: false,\r\n            plotType: 'bar',\r\n            isXRange: true\r\n        };\r\n\r\n        const categoryCount = this.renderedSeries[0].data.length;\r\n        const isHorizontal = this.tb.options.swapAxes;\r\n        let plotArea = this.tb.plotArea.clone();\r\n        if (isHorizontal)\r\n            plotArea.swapXY();\r\n        const categoryIndex = Math.floor(categoryCount * ((isHorizontal ? y : x) - plotArea.left) / plotArea.width);\r\n\r\n        let matches = [];\r\n\r\n        let barEnumerator = new BarEnumerator(this, categoryIndex);\r\n        let bar;\r\n        while ((bar = barEnumerator.next())) {\r\n            if (bar.categoryIndex > categoryIndex)\r\n                break;\r\n            let sortDistance, priority, realDistance;\r\n            if (bar.rect.containsPoint(x, y)) {\r\n                sortDistance = 0;\r\n                priority = 0;\r\n            }\r\n            else if (bar.rect.containsX(x)) {\r\n                sortDistance = y < bar.rect.top ? bar.rect.top - y : y - bar.rect.bottom;\r\n                priority = isHorizontal ? 2 : 1;\r\n            }\r\n            else if (bar.rect.containsY(y)) {\r\n                sortDistance = x < bar.rect.left ? bar.rect.left - x : x - bar.rect.right;\r\n                priority = isHorizontal ? 1 : 2;\r\n            }\r\n            else {\r\n                const xDist = Math.min(Math.abs(x - bar.rect.left), Math.abs(x - bar.rect.right));\r\n                const yDist = Math.min(Math.abs(y - bar.rect.top), Math.abs(y - bar.rect.bottom));\r\n                realDistance = Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));\r\n                sortDistance = isHorizontal ? yDist : xDist;\r\n                priority = 3;\r\n            }\r\n\r\n            if (typeof realDistance === 'undefined')\r\n                realDistance = sortDistance;\r\n\r\n            matches.push({\r\n                sortDistance: sortDistance,\r\n                distance: realDistance,\r\n                priority: priority,\r\n                data: {\r\n                    categoryIndex: bar.categoryIndex,\r\n                    seriesIndex: bar.seriesIndex,\r\n                    rect: bar.rect,\r\n                    series: this.series[bar.seriesIndex],\r\n                    value: Tayberry.getDataValue(this.series[bar.seriesIndex].data[bar.categoryIndex])\r\n                }\r\n            });\r\n        }\r\n\r\n        if (matches.length) {\r\n            matches.sort((a, b) => {\r\n                let ret = a.priority - b.priority;\r\n                if (!ret) ret = a.sortDistance - b.sortDistance;\r\n                if (!ret) ret = a.data.rect.height - b.data.rect.height;\r\n                return ret;\r\n            });\r\n            ret.found = true;\r\n            ret.normalisedDistance = matches[0].distance + Math.sqrt(matches[0].data.rect.area);\r\n            ret = Utils.assign(ret, matches[0].data);\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nclass BarEnumerator extends renderer.ByCategoryEnumerator {\r\n    constructor(renderer, startCategoryIndex = 0) {\r\n        super(renderer, startCategoryIndex);\r\n        if (this.categoryCount) {\r\n            this.isStacked = this.tb.options.barPlot.mode === 'stacked';\r\n            this.isOverlaid = this.tb.options.barPlot.mode === 'overlaid';\r\n            this.isNormal = !this.isStacked && !this.isOverlaid;\r\n            this.barCount = (this.isStacked || this.isOverlaid) ? 1 : this.seriesCount;\r\n            this.categoryWidth = (this.plotArea.width / this.categoryCount);\r\n            // used for stacked bar charts - must be on single y-axis\r\n            this.yOrigin = this.renderer.series[0].yAxis.getOrigin();\r\n\r\n            this.onNewCategory();\r\n        }\r\n    }\r\n\r\n    onNewCategory() {\r\n        this.yBottomPositive = this.yOrigin;\r\n        this.yBottomNegative = this.yOrigin;\r\n        this.yRunningTotalPositive = 0;\r\n        this.yRunningTotalNegative = 0;\r\n        this.barIndex = 0;\r\n    }\r\n\r\n    next() {\r\n        let ret;\r\n\r\n        if (this.categoryIndex < this.categoryCount) {\r\n            const series = this.renderer.renderedSeries[this.seriesIndex];\r\n            const value = Tayberry.getDataValue(series.data[this.categoryIndex]);\r\n            let categoryXStart = this.plotArea.left + Math.floor(this.categoryIndex * this.categoryWidth);\r\n            let categoryXEnd = this.plotArea.left + Math.floor((this.categoryIndex + 1) * this.categoryWidth);\r\n            let barXStart = categoryXStart + Math.ceil(this.categoryWidth * this.tb.options.barPlot.categorySpacing / 2);\r\n            let barXEnd = categoryXEnd - Math.floor(this.categoryWidth * this.tb.options.barPlot.categorySpacing / 2);\r\n\r\n            const barWidth = Math.floor((barXEnd - barXStart) / this.barCount);\r\n            const xStart = Math.floor(barXStart + this.barIndex * barWidth);\r\n            const xEnd = Math.ceil(barXStart + (this.barIndex + 1) * barWidth);\r\n\r\n            const yTop = series.yAxis.getValueDisplacement(value + (value > 0 ? this.yRunningTotalPositive : this.yRunningTotalNegative));\r\n            let rect = new Rect(xStart, yTop, xEnd, this.isStacked ? (value > 0 ? this.yBottomPositive : this.yBottomNegative) : series.yAxis.getOrigin());\r\n            rect.left += Math.ceil(series.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding) / 2);\r\n            rect.right -= Math.floor(series.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding) / 2);\r\n            if (rect.right < rect.left)\r\n                rect.right = rect.left;\r\n            if (this.isHorizontal)\r\n                rect.swapXY();\r\n            rect.clip(this.tb.plotArea);\r\n\r\n            ret = {\r\n                seriesIndex: this.seriesIndex,\r\n                categoryIndex: this.categoryIndex,\r\n                series: this.renderer.series[this.seriesIndex],\r\n                renderedSeries: this.renderer.renderedSeries[this.seriesIndex],\r\n                value: Tayberry.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),\r\n                renderedValue: Tayberry.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),\r\n                rect: rect,\r\n                selected: this.tb.selectedItem.categoryIndex === this.categoryIndex && (this.tb.options.tooltips.shared || this.tb.selectedItem.series === this.renderer.series[this.seriesIndex])\r\n            };\r\n\r\n            if (this.isStacked) {\r\n                if (value > 0) {\r\n                    this.yRunningTotalPositive += value;\r\n                    this.yBottomPositive = yTop;\r\n                }\r\n                else {\r\n                    this.yRunningTotalNegative += value;\r\n                    this.yBottomNegative = yTop;\r\n                }\r\n            } else if (this.isNormal) {\r\n                this.barIndex++;\r\n            }\r\n\r\n            this.nextValue();\r\n\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nexports.BarRenderer = BarRenderer;","'use strict';\r\nvar Utils = require('./helpers/utils');\r\nvar Easing = require('./helpers/easing');\r\nvar Tayberry = require('./base').Tayberry;\r\n\r\nclass Renderer {\r\n    constructor(ctx, tayberry, series) {\r\n        this.ctx = ctx;\r\n        this.tb = tayberry;\r\n        this.series = null;\r\n        this.renderedSeries = null;\r\n        this.setSeries(series);\r\n    }\r\n\r\n    setSeries(series) {\r\n        var seriesIndex;\r\n        this.series = series;\r\n        this.renderedSeries = series.slice(0);\r\n        for (seriesIndex = 0; seriesIndex < this.renderedSeries.length; seriesIndex++) {\r\n            let actualSeries = this.series[seriesIndex];\r\n            actualSeries.renderer = this;\r\n            let elem = Utils.assign({}, actualSeries);\r\n            elem.data = this.renderedSeries[seriesIndex].data.slice(0);\r\n            if (elem.data.length && Array.isArray(elem.data[0])) {\r\n                for (var dataIndex = 0; dataIndex < elem.data.length; dataIndex++) {\r\n                    elem.data[dataIndex] = elem.data[dataIndex].slice(0);\r\n                }\r\n            }\r\n            this.renderedSeries[seriesIndex] = elem;\r\n        }\r\n    }\r\n\r\n    onAnimationFrame(elapsedTime, totalTime) {\r\n        var scaleFactor;\r\n        scaleFactor = Math.min(Easing.inQuad(elapsedTime, totalTime), 1);\r\n        for (let categoryIndex = 0; categoryIndex < this.series[0].data.length; categoryIndex++) {\r\n            for (let seriesIndex = 0; seriesIndex < this.series.length; seriesIndex++) {\r\n                const series = this.series[seriesIndex];\r\n                const value = Tayberry.getDataValue(series.data[categoryIndex]);\r\n                const yOrigin = series.yAxis.min <= 0 && 0 <= series.yAxis.max ? 0 : (series.yAxis.min > 0 ? series.yAxis.min : series.yAxis.max);\r\n                Tayberry.setDataValue(this.renderedSeries[seriesIndex].data, categoryIndex, yOrigin + scaleFactor * ((value - yOrigin)));\r\n            }\r\n        }\r\n    }\r\n\r\n    drawLegendIndicator(ctx, series, rect) {\r\n        ctx.fillStyle = series.colour;\r\n        ctx.fillRect(rect.left, rect.top, rect.width, rect.height);\r\n    }\r\n\r\n    drawLabel(sign, text, rect) {\r\n        if (this.tb.options.swapAxes)\r\n            rect = rect.clone().swapXY();\r\n        let x = (rect.left + rect.right) / 2;\r\n        let y;\r\n        if (this.tb.options.labels.verticalAlignment === 'top')\r\n            y = rect.top;\r\n        else if (this.tb.options.labels.verticalAlignment === 'bottom')\r\n            y = rect.bottom;\r\n        else\r\n            y = (rect.top + rect.bottom) / 2;\r\n        let baseline = 'middle';\r\n        let align = 'center';\r\n        if (this.tb.options.swapAxes) {\r\n            [x, y] = [y, x];\r\n            if (this.tb.options.labels.verticalPosition === 'outside')\r\n                align = 'left';\r\n            else if (this.tb.options.labels.verticalPosition === 'inside')\r\n                align = 'right';\r\n        } else {\r\n            baseline = Tayberry.mapVerticalPosition(sign, this.tb.options.labels.verticalPosition);\r\n        }\r\n        if (this.tb.plotArea.containsPoint(x, y)) {\r\n            this.ctx.save();\r\n            this.ctx.textAlign = align;\r\n            this.ctx.textBaseline = baseline;\r\n            this.ctx.fillText(text, x, y);\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n\r\n    drawPlot() {\r\n    }\r\n\r\n    drawLabels() {\r\n    }\r\n\r\n    hitTest() {\r\n    }\r\n\r\n}\r\n\r\nclass Enumerator {\r\n    constructor(renderer, startCategoryIndex = 0) {\r\n        this.renderer = renderer;\r\n        this.tb = renderer.tb;\r\n\r\n        this.categoryCount = this.renderer.renderedSeries[0].data.length;\r\n        this.categoryIndex = 0;\r\n        this.seriesIndex = 0;\r\n        this.seriesCount = this.renderer.renderedSeries.length;\r\n        if (this.categoryCount) {\r\n            this.isHorizontal = this.tb.options.swapAxes;\r\n            this.plotArea = this.tb.plotArea.clone();\r\n            if (this.isHorizontal)\r\n                this.plotArea.swapXY();\r\n            this.startCategoryIndex = Math.max(startCategoryIndex, 0);\r\n            this.startCategoryIndex = Math.min(this.startCategoryIndex, this.categoryCount - 1);\r\n            this.categoryIndex = this.startCategoryIndex;\r\n        }\r\n    }\r\n\r\n    nextValue() {\r\n    }\r\n}\r\n\r\nclass ByCategoryEnumerator extends Enumerator {\r\n    onNewCategory() {}\r\n\r\n    nextValue() {\r\n\r\n        let value;\r\n        do {\r\n            if (this.seriesIndex + 1 === this.seriesCount) {\r\n                this.seriesIndex = 0;\r\n                this.categoryIndex++;\r\n                if (this.categoryIndex >= this.categoryCount)\r\n                    break;\r\n                this.onNewCategory();\r\n            } else {\r\n                this.seriesIndex++;\r\n            }\r\n            value = Tayberry.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]);\r\n        } while (Utils.isMissingValue(value));\r\n\r\n    }\r\n}\r\n\r\nclass BySeriesEnumerator extends Enumerator {\r\n    nextValue() {\r\n\r\n        let value;\r\n        do {\r\n            if (this.categoryIndex + 1 === this.categoryCount) {\r\n                this.categoryIndex = this.startCategoryIndex;\r\n                this.seriesIndex++;\r\n                if (this.seriesIndex >= this.seriesCount)\r\n                    break;\r\n            } else {\r\n                this.categoryIndex++;\r\n            }\r\n            value = Tayberry.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]);\r\n        } while (Utils.isMissingValue(value));\r\n\r\n    }\r\n}\r\n\r\nexports.Renderer = Renderer;\r\nexports.ByCategoryEnumerator = ByCategoryEnumerator;\r\nexports.BySeriesEnumerator = BySeriesEnumerator;","'use strict';\r\nvar Utils = require('./helpers/utils');\r\nvar Rect = require('./helpers/rect').Rect;\r\nvar renderer = require('./renderer.base');\r\nvar Tayberry = require('./base').Tayberry;\r\n\r\nvar autoMarkerIndex = 0;\r\nconst markers = ['square', 'diamond', 'circle', 'triangle', 'triangle-inversed'];\r\n\r\nclass LineRenderer extends renderer.Renderer {\r\n    setSeries(series) {\r\n        let totalPoints = 0;\r\n        for (var i = 0; i < series.length; i++) {\r\n            if (!series[i].markerType) {\r\n                series[i].markerType = markers[autoMarkerIndex % markers.length];\r\n                autoMarkerIndex++;\r\n            }\r\n            totalPoints += series[i].data.length;\r\n        }\r\n        const showMarkers = this.tb.options.linePlot.showMarkers;\r\n        this.showMarkers = showMarkers === 'auto' ? totalPoints < this.tb.options.linePlot.noMarkersThreshold : showMarkers;\r\n        super.setSeries(series);\r\n    }\r\n\r\n    drawMarker(type, x, y, size, ctx = this.ctx) {\r\n        if (type === 'square') {\r\n            ctx.fillRect(x - size / 2, y - size / 2, size, size);\r\n        } else if (type === 'diamond') {\r\n            ctx.save();\r\n            ctx.translate(x, y);\r\n            ctx.rotate(-Math.PI / 4);\r\n            ctx.fillRect(0 - size / 2, 0 - size / 2, size, size);\r\n            ctx.restore();\r\n        } else if (type === 'circle') {\r\n            size = Math.round(size * 1.2);\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, size / 2, 0, 2 * Math.PI);\r\n            ctx.fill();\r\n        } else if (type === 'triangle' || (type === 'triangle-inversed' && (size = -size))) {\r\n            size = Math.round(size * 1.2);\r\n            ctx.beginPath();\r\n            ctx.moveTo(x - size / 2, y + size / 2);\r\n            ctx.lineTo(x, y - size / 2);\r\n            ctx.lineTo(x + size / 2, y + size / 2);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n    }\r\n\r\n    drawPlot() {\r\n        this.ctx.save();\r\n        let pointEnumerator = new PointEnumerator(this);\r\n        let pt;\r\n        while ((pt = pointEnumerator.next())) {\r\n            if (pt.firstPoint) {\r\n                this.ctx.lineWidth = pt.seriesSelected ? this.tb.options.linePlot.highlightedLineWidth : this.tb.options.linePlot.lineWidth;\r\n                this.ctx.strokeStyle = pt.seriesSelected ? pt.renderedSeries.highlightColour : pt.renderedSeries.colour;\r\n                this.ctx.beginPath();\r\n                this.ctx.moveTo(pt.x, pt.y);\r\n            } else {\r\n                this.ctx.lineTo(pt.x, pt.y);\r\n            }\r\n            if (pt.lastPoint) {\r\n                this.ctx.stroke();\r\n            }\r\n        }\r\n        if (this.showMarkers) {\r\n            pointEnumerator = new PointEnumerator(this);\r\n            while ((pt = pointEnumerator.next())) {\r\n                if (pt.selected) {\r\n                    this.ctx.fillStyle = pt.renderedSeries.glowColour;\r\n                    this.drawMarker(pt.renderedSeries.markerType, pt.x, pt.y, this.tb.options.linePlot.highlightedMarkerSize);\r\n                }\r\n                this.ctx.fillStyle = pt.renderedSeries.colour;\r\n                this.drawMarker(pt.renderedSeries.markerType, pt.x, pt.y, this.tb.options.linePlot.markerSize);\r\n            }\r\n        }\r\n        this.ctx.restore();\r\n    }\r\n\r\n    drawLegendIndicator(ctx, series, rect) {\r\n        ctx.save();\r\n        ctx.lineWidth = 2;\r\n        ctx.strokeStyle = series.colour;\r\n        this.tb.drawLine(rect.left, rect.yMidpoint, rect.right, rect.yMidpoint);\r\n        ctx.fillStyle = series.colour;\r\n        this.drawMarker(series.markerType, rect.xMidpoint, rect.yMidpoint, this.tb.options.linePlot.markerSize, ctx);\r\n        ctx.restore();\r\n    }\r\n\r\n    drawLabels() {\r\n        if (this.tb.options.labels.enabled) {\r\n            this.ctx.save();\r\n            this.ctx.font = this.tb.labelFont;\r\n            this.ctx.fillStyle = this.tb.options.labels.font.colour;\r\n            let pointEnumerator = new PointEnumerator(this);\r\n            let pt;\r\n            while ((pt = pointEnumerator.next())) {\r\n                const rect = new Rect(pt.x, pt.y, pt.x, pt.y).inflate(this.tb.options.linePlot.markerSize / 2);\r\n                this.drawLabel(pt.value, pt.series.yAxis.options.labelFormatter(pt.value), rect);\r\n            }\r\n            this.ctx.restore();\r\n        }\r\n    }\r\n\r\n\r\n    hitTest(x, y) {\r\n        // TODO: Optimise\r\n        let ret = {\r\n            found: false,\r\n            plotType: 'line',\r\n            isXRange: false\r\n        };\r\n\r\n        let matches = [];\r\n\r\n        let pointEnumerator = new PointEnumerator(this);\r\n        let pt;\r\n        while ((pt = pointEnumerator.next())) {\r\n            const distance = Math.sqrt(Math.pow(pt.x - x, 2) + Math.pow(pt.y - y, 2));\r\n            const horizontalDistance = Math.abs(this.tb.options.swapAxes ? pt.y - y : pt.x - x);\r\n            matches.push({distance: distance, horizontalDistance: horizontalDistance, priority: 0, data: pt});\r\n            //if (!pt.firstPoint) {\r\n            //    if (x >= lastPt.x && x < pt.x) {\r\n            //const alpha = Math.arctan((pt.y - lastPt.y) / (pt.x - lastPt.x));\r\n            //const yAtX = (x - lastPt.x) * Math.tan(alpha) + lastPt.y;\r\n            //if (yAtX - 2 <= y < yAtX + 2) {\r\n            //    matches.push({\r\n            //        categoryIndex: pt.categoryIndex,\r\n            //        seriesIndex: pt.seriesIndex,\r\n            //        x: bar.rect,\r\n            //        series: this.series[bar.seriesIndex],\r\n            //        dataPoint: this.series[bar.seriesIndex].data[bar.categoryIndex]\r\n            //\r\n            //    })\r\n            //}\r\n            //}\r\n            //}\r\n            //lastPt = pt;\r\n\r\n        }\r\n        if (matches.length) {\r\n            matches.sort((e1, e2) => {\r\n                return (e1.horizontalDistance - e2.horizontalDistance) || (e1.distance - e2.distance);\r\n            });\r\n            if (true || matches[0].distance <= 5) {\r\n                pt = matches[0].data;\r\n                const rect = new Rect(pt.x, pt.y, pt.x, pt.y).inflate(this.tb.options.linePlot.markerSize / 2);\r\n                Utils.assign(ret, [{\r\n                    found: true,\r\n                    rect: rect,\r\n                    normalisedDistance: matches[0].distance + Math.sqrt(rect.area)\r\n                }, pt]);\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    }\r\n\r\n}\r\n\r\nclass PointEnumerator extends renderer.BySeriesEnumerator {\r\n    next() {\r\n        let ret;\r\n\r\n        if (this.seriesIndex < this.seriesCount) {\r\n            const series = this.renderer.renderedSeries[this.seriesIndex];\r\n            const value = Tayberry.getDataValue(series.data[this.categoryIndex]);\r\n            const xValue = Tayberry.getDataXValue(series.data, this.categoryIndex);\r\n            let x = series.xAxis.getValueDisplacement(xValue);\r\n            let y = series.yAxis.getValueDisplacement(value);\r\n\r\n            if (this.isHorizontal)\r\n                [x, y] = [y, x];\r\n\r\n            ret = {\r\n                firstPoint: this.categoryIndex === 0,\r\n                lastPoint: this.categoryIndex + 1 === this.categoryCount,\r\n                seriesIndex: this.seriesIndex,\r\n                categoryIndex: this.categoryIndex,\r\n                series: this.renderer.series[this.seriesIndex],\r\n                renderedSeries: this.renderer.renderedSeries[this.seriesIndex],\r\n                value: Tayberry.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),\r\n                renderedValue: Tayberry.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),\r\n                x: x,\r\n                y: y,\r\n                seriesSelected: !this.tb.options.tooltips.shared && this.tb.selectedItem.series === this.renderer.series[this.seriesIndex],\r\n                selected: this.tb.selectedItem.categoryIndex === this.categoryIndex && (this.tb.options.tooltips.shared || this.tb.selectedItem.series === this.renderer.series[this.seriesIndex])\r\n            };\r\n\r\n            this.nextValue();\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nexports.LineRenderer = LineRenderer;","'use strict';\r\nvar Rect = require('./helpers/rect').Rect;\r\nvar Tayberry = require('./base.js').Tayberry;\r\nvar Utils = require('./helpers/utils');\r\n\r\nTayberry.mapVerticalPosition = function (sign, position) {\r\n    switch (position) {\r\n        case \"outside\":\r\n            return sign > 0 ? \"bottom\" : \"top\";\r\n        case \"inside\":\r\n            return sign > 0 ? \"top\" : \"bottom\";\r\n        default:\r\n            return \"middle\";\r\n    }\r\n};\r\n\r\nTayberry.prototype.mapLogicalXUnit = function (x) {\r\n    return this.scaleFactorX * x;\r\n};\r\n\r\nTayberry.prototype.mapLogicalYUnit = function (x) {\r\n    return this.scaleFactorY * x;\r\n};\r\n\r\nTayberry.prototype.mapScreenUnit = function (x) {\r\n    return x / this.scaleFactor;\r\n};\r\n\r\nTayberry.prototype.calculatePlotArea = function () {\r\n    const MAX_AXIS_CALC_SIZE_ATTEMPTS = 5;\r\n\r\n    this.plotArea = new Rect(0, 0, this.labelsCanvas.width, this.labelsCanvas.height);\r\n    if (this.options.title.text) {\r\n        this.plotArea.top += this.mapLogicalYUnit(this.options.elementSmallPadding);\r\n        this.plotArea.top += this.getFontHeight(this.options.title.font) * this.getMultilineTextHeight(this.titleFont, this.labelsCanvas.width, this.options.title.text);\r\n    }\r\n    if (this.options.legend.enabled)\r\n        this.plotArea.bottom -= this.mapLogicalYUnit(this.options.elementSmallPadding + this.options.elementLargePadding + this.options.legend.indicatorSize);\r\n\r\n    this.yAxes.map(e => e.adjustSize(this.plotArea, true, true));\r\n    this.xAxes.map(e => e.adjustSize(this.plotArea, true, true));\r\n\r\n    for (let i = 0; i < MAX_AXIS_CALC_SIZE_ATTEMPTS; i++) {\r\n        this.yAxes.map(e => e.calculateExtent());\r\n        this.xAxes.map(e => e.calculateExtent());\r\n        this.yAxes.map(e => e.updateFormatter());\r\n        this.xAxes.map(e => e.updateFormatter());\r\n        if (Utils.none(this.yAxes.map(e => e.adjustSize(this.plotArea))) && Utils.none(this.xAxes.map(e => e.adjustSize(this.plotArea))))\r\n            break;\r\n    }\r\n    this.plotArea.left = Math.ceil(this.plotArea.left);\r\n    this.plotArea.top = Math.ceil(this.plotArea.top);\r\n    this.plotArea.right = Math.floor(this.plotArea.right);\r\n    this.plotArea.bottom = Math.floor(this.plotArea.bottom);\r\n};\r\n\r\nTayberry.prototype.hitTest = function (x, y) {\r\n    let ret = {\r\n        found: false\r\n    };\r\n    let matches = [];\r\n    for (let i = 0; i < this.renderers.length; i++) {\r\n        const hitTestResult = this.renderers[i].hitTest(x, y);\r\n        if (hitTestResult.found) {\r\n            matches.push(hitTestResult);\r\n        }\r\n    }\r\n    if (matches.length) {\r\n        matches.sort((a, b) => a.normalisedDistance - b.normalisedDistance);\r\n        ret = matches[0];\r\n    }\r\n    return ret;\r\n};","(function () {\r\n    'use strict';\r\n    var Tayberry = require('./base.js').Tayberry;\r\n    require('./axis.js');\r\n    require('./core.js');\r\n    require('./drawing.js');\r\n    require('./events.js');\r\n    require('./defaults.js');\r\n    require('./sizing.js');\r\n\r\n    module.exports = {\r\n        /**\r\n         * Creates a Tayberry chart\r\n         *\r\n         * @param element   ID of container div, or HTMLElement\r\n         * @param options   Options object\r\n         */\r\n        create: function (element, options) {\r\n            var chart = new Tayberry();\r\n            chart.create(element);\r\n            chart.setOptions(options);\r\n            chart.render();\r\n        }\r\n    };\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}