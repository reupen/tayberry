{"version":3,"sources":["/source/node_modules/browserify/node_modules/browser-pack/_prelude.js","tayberry.min.js","/source/src/colour.js","/source/src/easing.js","/source/src/rect.js","/source/src/tayberry.axes.js","/source/src/tayberry.base.js","/source/src/tayberry.core.js","/source/src/tayberry.defaults.js","/source/src/tayberry.drawing.js","/source/src/tayberry.events.js","/source/src/tayberry.js","/source/src/tayberry.sizing.js","/source/src/utils.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","Tayberry","e","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","Utils","Colour","arguments","arg1","parseString","b","value","str","regExHex","regExInt","groupsHex","exec","groupsInt","parseHex","ret","parseInt","parseFloat","component","Math","round","min","max","clipComponent","number","clip","formatString","get","colour","multiplyBy","toString","./utils.js",2,"linear","time","duration","inQuad","factor","outQuad",3,"Rect","rect","left","top","right","bottom","x","y","containsX","containsY","minY","maxY","minX","maxX","clipRect","_ref","_ref2",4,"_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","Array","isArray","_get","_x3","_x4","_x5","_again","object","property","receiver","desc","parent","getter","Function","getOwnPropertyDescriptor","getPrototypeOf","Axis","tayberry","index","options","axisType","tickStep","tickStart","tickEnd","calculatedSize","setPlacement","xYSwapped","type","LinearAxis","CategorialAxis","validAndSpecificPlacements","indexOf","placement","isYAxis","mapLogicalXUnit","mapLogicalYUnit","plotArea","fixedOnly","reset","size","tb","mapLogicalXOrYUnit","elementSmallPadding","title","font","maxLabelSize","isPlacedAtStart","drawTicksAndLabels","drawTitle","ctx","save","fillStyle","textAlign","textBaseline","height","translate","rotate","PI","fillText","width","startProperty","restore","abs","plotDisplacement","_Axis","apply","lastXEnd","categoryCount","categories","clone","swapXY","categoryWidth","series","data","labelPosition","floor","textWidth","getTextWidth","xStart","xEnd","reduce","bind","_Axis2","labelFormatter","callback","yValue","start","end","endProperty","getValueDisplacement","x1","y1","x2","y2","labelPaddingX","labelPaddingY","enumerateTicks","tick","drawLine","gridLines","targetTicks","approxStep","scale","targetStart","targetEnd","overriddenStart","overriddenEnd","_tayberry$getDataMinMax","getDataMinMax","_tayberry$getDataMinMax2","dataMin","dataMax","dataRange","targetRange","plotLength","mapLogicalYOrXUnit","pow","log","ceil","getOrigin",5,"selectedItem","containerElement","canvas","renderedSeries","scaleFactor","titleFont",6,"document","getElementById","createElement","style","appendChild","getContext","yAxis","xAxis","initialise","destroy","remove","tooltipElement","removeEventListener","onMouseMoveReal","onMouseLeaveReal","onTouchStartReal","onWindowResizeReal","devicePixelRatio","clientWidth","clientHeight","scaleFactorX","scaleFactorY","updateFonts","face","updateYFormatter","labelFormat","createPercentageFormatter","labelPrefix","labelSuffix","createFixedNumberFormatter","currencySymbol","createAutoNumberFormatter","setOptions","optionOverrides","defaultOptions","presets","deepAssign","setSeries","barChart","orientation","addEventListener","onMouseMove","onMouseLeave","onTouchStart","throttle","onWindowResize","calculateHighlightColour","newColour","increaseBy","sum","slice","actualSeries","defaultPalette","highlightColour","elem","assign","setCategories","categoryIndex","seriesIndex","seriesPositiveTotals","seriesNegativeTotals","seriesMinima","seriesMaxima","isMissingValue","barMode","createTooltip","className","position","zIndex","borderRadius","backgroundColor","border","padding","display","innerHTML","body","./colour","./tayberry.axes","./tayberry.base","./utils",7,"text","step","barPadding","elementLargePadding","categorySpacing","tooltips","shared","headerTemplate","valueTemplate","footerTemplate","legend","enabled","indicatorSize","labels","verticalAlignment","verticalPosition","histogram","./tayberry.base.js",8,"render","calculatePlotArea","animator","requestAnimationFrame","onAnimate","animatationStart","performance","now","animationLength","draw","clear","clearRect","drawLabel","sign","containsPoint","mapVerticalPosition","enumerateBars","bar","selected","fillRect","strokeStyle","beginPath","moveTo","lineTo","stroke","redraw","drawLegend","totalWidth","name",9,"Easing","timestamp","elapsed","yOrigin","event","currentTarget","relatedTarget","handleMouseMove","clientX","clientY","boundingRect","getBoundingClientRect","hitTestResult","hitTest","found","aboveZero","category","tooltipHtml","tooltipRect","borderColor","pageXOffset","mapScreenUnit","pageYOffset","targetTouches","touch","preventDefault","oldSelectedItem","./easing.js","./rect",10,"element","chart","./tayberry.axes.js","./tayberry.core.js","./tayberry.defaults.js","./tayberry.drawing.js","./tayberry.events.js","./tayberry.sizing.js",11,"measureText","MAX_AXIS_CALC_SIZE_ATTEMPTS","adjustSize","calculateExtent","matches","isOverlaid","minMatchIndex","minHeight","match","isStacked","isHorizontal","isNormal","barCount","categoryXStart","categoryXEnd","barXStart","barXEnd","yBottomPositive","yBottomNegative","yRunningTotalPositive","yRunningTotalNegative","barIndex","barWidth","yTop","stopEnumerating","renderedValue",12,"identity","obj","isNaN","array","func","ignoreMissing","Date","getTime","innerAssign","targetObject","sourceObjects","concat","to","currentSourceObject","keysArray","keys","nextIndex","len","nextKey","nextValue","formatValues","escapeAsHtml","replace","placeholder","stringToHtml","locateDecimalPoint","formatNumberThousands","decimalPlaces","parts","toFixed","split","join","prefix","suffix","precision","div","createTextNode","fn","threshold","last","deferTimer","context","args","clearTimeout","setTimeout"],"mappings":"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","file":"tayberry.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","!function(t){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var e;e=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,e.Tayberry=t()}}(function(){return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var l=\"function\"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error(\"Cannot find module '\"+o+\"'\");throw h.code=\"MODULE_NOT_FOUND\",h}var c=i[o]={exports:{}};e[o][0].call(c.exports,function(t){var i=e[o][1][t];return s(i?i:t)},c,c.exports,t,e,i,n)}return i[o].exports}for(var r=\"function\"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e,i){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=t(\"./utils.js\"),o=function(){function t(){if(n(this,t),1===arguments.length){var e=arguments[0];\"string\"==typeof e?this.parseString(e):(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}}return s(t,[{key:\"parseString\",value:function(t){var e=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,i=/^rgba?\\((\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})(\\s*,\\s*([0-9]*\\.?[0-9]+))+\\)$/i,n=e.exec(t),s=i.exec(t);if(n){var r=function(t){var e=parseInt(t,16);return e=16*e+e};this.r=n[1]?parseInt(n[1],16):r(n[4]),this.g=n[2]?parseInt(n[2],16):r(n[5]),this.b=n[3]?parseInt(n[3],16):r(n[6]),this.a=null}else s?(this.r=parseInt(s[1]),this.g=parseInt(s[2]),this.b=parseInt(s[3]),this.a=s[5]?parseFloat(s[5]):null):(this.r=null,this.g=null,this.b=null,this.a=null);return this}},{key:\"clipComponent\",value:function(t){return this[t]=Math.round(this[t]),this[t]=Math.min(this[t],255),this[t]=Math.max(this[t],0),this}},{key:\"clip\",value:function(){return this.clipComponent(\"r\"),this.clipComponent(\"g\"),this.clipComponent(\"b\"),this}},{key:\"multiplyBy\",value:function(t){return this.r*=t,this.g*=t,this.b*=t,this.clip(),this}},{key:\"increaseBy\",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this.clip(),this}},{key:\"toString\",value:function(){var t;return t=this.a?r.formatString(\"rgba({r},{g},{b},{a})\",this):r.formatString(\"rgb({r},{g},{b})\",this)}},{key:\"sum\",get:function(){return this.r+this.g+this.b}}],[{key:\"multiplyBy\",value:function(e,i){return new t(e).multiplyBy(i).toString()}}]),t}();i.Colour=o},{\"./utils.js\":12}],2:[function(t,e,i){\"use strict\";i.linear=function(t,e){return t/e},i.linear=function(t,e){return t/e},i.inQuad=function(t,e){var i=t/e;return i*i},i.outQuad=function(t,e){var i=t/e;return i*(2-i)}},{}],3:[function(t,e,i){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){n(this,t);var e;1===arguments.length?(e=arguments[0],this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):4===arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.right=arguments[2],this.bottom=arguments[3])}return s(t,[{key:\"containsPoint\",value:function(t,e){return this.containsX(t)&&this.containsY(e)}},{key:\"containsY\",value:function(t){return t>=this.minY&&t<this.maxY}},{key:\"containsX\",value:function(t){return t>=this.minX&&t<this.maxX}},{key:\"clip\",value:function(t){return this.left<t.minX?this.left=t.minX:this.left>t.maxX&&(this.left=t.maxX),this.right<t.minX?this.right=t.minX:this.right>t.maxX&&(this.right=t.maxX),this.top<t.minY?this.top=t.minY:this.top>t.maxY&&(this.top=t.maxY),this.bottom>t.maxY?this.bottom=t.maxY:this.bottom<t.minY&&(this.bottom=t.minY),this}},{key:\"width\",get:function(){return this.right-this.left}},{key:\"height\",get:function(){return this.bottom-this.top}},{key:\"maxY\",get:function(){return Math.max(this.bottom,this.top)}},{key:\"minY\",get:function(){return Math.min(this.bottom,this.top)}},{key:\"minX\",get:function(){return Math.min(this.left,this.right)}},{key:\"maxX\",get:function(){return Math.max(this.left,this.right)}}]),t}();i.Rect=r},{}],4:[function(t,e,i){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var s=function(){function t(t,e){var i=[],n=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(l){s=!0,r=l}finally{try{!n&&a[\"return\"]&&a[\"return\"]()}finally{if(s)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}}(),r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=(t(\"./utils.js\"),function(){function t(e,i,s){n(this,t),this.tayberry=e,this.options=i,this.axisType=s,this.tickStep=null,this.min=null,this.max=null,this.tickStart=null,this.tickEnd=null,this.calculatedSize=0}return r(t,[{key:\"adjustSize\",value:function(t){var e=0,i=this.tayberry,n=void 0;return this.options.title&&(e+=this.mapLogicalXUnit(this.options.elementLargePadding+this.options.font.size)),this.isYAxis()?\"linear\"===this.options.type&&(e+=Math.max(i.getTextWidth(this.options.labelFormatter(this.yAxis.tickStart)),i.getTextWidth(this.options.labelFormatter(this.tickEnd)))+i.mapLogicalXUnit(i.options.elementSmallPadding)):e+=i.mapLogicalYUnit(i.options.font.size),this.isYAxis()?this.isPlacedAtStart()?t.left+=e-this.calculatedSize:t.right-=e-this.calculatedSize:this.isPlacedAtStart()?t.top+=e-this.calculatedSize:t.bottom-=e-this.calculatedSize,n=this.calculatedSize!==e,this.calculatedSize=e,n}},{key:\"calculateExtent\",value:function(){var t,e,i,n=this.options.min,r=this.options.max,o=\"undefined\"!=typeof n,a=\"undefined\"!=typeof r;if(!o||!a){var l=this.tayberry.calculateYDataMinMax(),h=s(l,2),c=h[0],u=h[1],p=u-c;o||(n=c-.1*p,c>=0&&0>n&&(n=0)),a||(r=u+.1*p,0>=u&&n>0&&(r=0))}var d=r-n;t=this.tayberry.plotArea.height/this.tayberry.mapLogicalYUnit(this.options.tickStep),e=d/t,i=Math.pow(10,Math.floor(Math.log(e)/Math.log(10))),this.tickStep=Math.ceil(e/i)*i,this.min=n,this.max=r,o||(this.min=Math.floor(this.min/i)*i),a||(this.max=Math.ceil(this.max/i)*i),this.tickStart=Math.floor(this.min/this.tickStep)*this.tickStep,this.tickEnd=Math.ceil(this.max/this.tickStep)*this.tickStep}},{key:\"drawLinear\",value:function(){var t,e,i,n=this.tayberry,s=n.getYOrigin();for(n.ctx.save(),n.ctx.fillStyle=n.options.font.colour,n.ctx.textAlign=\"right\",n.ctx.textBaseline=\"middle\",t=this.tickStart;t<=this.tickEnd&&this.tickStep;){t=this.tickStart+Math.round((t+this.tickStep-this.tickStart)/this.tickStep)*this.tickStep,e=n.plotArea.left-n.mapLogicalXUnit(n.options.elementSmallPadding);var r=n.getYHeight(t);i=s-r,n.plotArea.containsY(i)&&(n.ctx.fillText(this.options.labelFormatter(t),e,i),n.drawLine(n.plotArea.left,i,n.plotArea.right,i,this.options.gridLines.colour))}e=0,i=n.plotArea.top+n.plotArea.height/2,n.ctx.textAlign=\"center\",n.ctx.textBaseline=\"top\",n.ctx.translate(e,i),n.ctx.rotate(-Math.PI/2),n.ctx.fillText(this.options.title,0,0),n.ctx.restore()}},{key:\"drawCategory\",value:function(){var t,e,i,n,s,r=this.tayberry,o=r.categories.length;e=Math.floor(r.plotArea.width/r.series[0].data.length),r.ctx.save(),r.ctx.fillStyle=r.options.font.colour,r.ctx.textAlign=\"center\",r.ctx.textBaseline=\"bottom\";var a=void 0;switch(this.options.labelPosition){case\"left\":a=0;break;case\"right\":a=0;break;default:a=.5}for(t=0;o>t;t++){i=r.plotArea.left+Math.floor(t*e+e*a),n=r.plotArea.bottom+r.mapLogicalYUnit(r.options.font.size+r.options.elementSmallPadding);var l=r.getTextWidth(r.categories[t]),h=i-l/2,c=i+l/2;(\"undefined\"==typeof s||h>s+1)&&(r.ctx.fillText(r.categories[t],i,n),s=c)}i=r.plotArea.left+r.plotArea.width/2,n=r.plotArea.bottom+r.mapLogicalYUnit(2*r.options.font.size+r.options.elementSmallPadding+r.options.elementLargePadding),r.ctx.fillText(this.options.title,i,n),r.ctx.restore()}},{key:\"isPlacedAtStart\",get:function(){return\"left\"===this.options.placement||\"bottom\"===this.options.placement||\"start\"===this.options.placement}},{key:\"isYAxis\",get:function(){return\"y\"===this.axisType}}]),t}());i.Axis=o},{\"./utils.js\":12}],5:[function(t,e,i){\"use strict\";function n(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(){n(this,t),this.selectedItem={},this.containerElement=null,this.canvas=null,this.ctx=null,this.renderedSeries=null,this.options=null,this.scaleFactor=null,this.titleFont=null,this.plotArea=null,this.series=[],this.categories=[]}return s(t,[{key:\"seriesCount\",get:function(){return this.series.length}},{key:\"categoryCount\",get:function(){return this.series.length?this.series[0].data.length:0}}]),t}();i.Tayberry=r},{}],6:[function(t,e,i){\"use strict\";var n=t(\"./colour\").Colour,s=t(\"./utils\"),r=t(\"./tayberry.base\").Tayberry,o=t(\"./tayberry.axes\").Axis;r.prototype.create=function(t){\"string\"==typeof t?this.containerElement=document.getElementById(t):this.containerElement=t,this.canvas=document.createElement(\"canvas\"),this.canvas.style.width=\"100%\",this.canvas.style.height=\"100%\",this.containerElement.appendChild(this.canvas),this.ctx=this.canvas.getContext(\"2d\"),this.renderedSeries=null,this.options={},this.yAxis=null,this.xAxis=null,this.initialise()},r.prototype.destroy=function(){this.canvas.remove(),this.tooltipElement.remove(),this.options={},this.series={},this.canvas.removeEventListener(\"mousemove\",this.onMouseMoveReal),this.canvas.removeEventListener(\"mouseleave\",this.onMouseLeaveReal),this.canvas.removeEventListener(\"touchstart\",this.onTouchStartReal),window.removeEventListener(\"resize\",this.onWindowResizeReal)},r.prototype.initialise=function(){this.scaleFactor=window.devicePixelRatio||1,this.canvas.width=Math.round(this.containerElement.clientWidth*this.scaleFactor),this.canvas.height=Math.round(this.containerElement.clientHeight*this.scaleFactor),this.scaleFactorX=this.canvas.width/this.containerElement.clientWidth,this.scaleFactorY=this.canvas.height/this.containerElement.clientHeight,this.selectedItem={},this.plotArea=null},r.prototype.updateFonts=function(){this.ctx.font=this.mapLogicalYUnit(this.options.font.size)+\"px \"+this.options.font.face,this.titleFont=this.mapLogicalYUnit(this.options.title.font.size)+\"px \"+this.options.font.face},r.prototype.updateYFormatter=function(){this.options.yAxis.labelFormatter||(\"percentage\"===this.options.yAxis.labelFormat?this.options.yAxis.labelFormatter=s.createPercentageFormatter(this.yAxis.max-this.yAxis.min,this.options.yAxis.labelPrefix,this.options.yAxis.labelSuffix):\"currency\"===this.options.yAxis.labelFormat?this.options.yAxis.labelFormatter=s.createFixedNumberFormatter(this.yAxis.max-this.yAxis.min,this.options.yAxis.labelPrefix||this.options.yAxis.currencySymbol,this.options.yAxis.labelSuffix):this.options.yAxis.labelFormatter=s.createAutoNumberFormatter(this.yAxis.max-this.yAxis.min,this.options.yAxis.labelPrefix,this.options.yAxis.labelSuffix))},r.prototype.setOptions=function(t){var e=[this.defaultOptions()];if(t.presets)for(var i=0;i<t.presets.length;i++)e.push(r.presets[t.presets[i]]);e.push(t),this.options=s.deepAssign({},e),this.setSeries(t.series),this.setCategories(t.xAxis.categories),this.updateFonts(),this.yAxis=new o(this,this.options.yAxis),this.xAxis=new o(this,this.options.xAxis),this.canvas.addEventListener(\"mousemove\",this.onMouseMoveReal=this.onMouseMove.bind(this)),this.canvas.addEventListener(\"mouseleave\",this.onMouseLeaveReal=this.onMouseLeave.bind(this)),this.canvas.addEventListener(\"touchstart\",this.onTouchStartReal=this.onTouchStart.bind(this)),window.addEventListener(\"resize\",this.onWindowResizeReal=s.throttle(this.onWindowResize,50).bind(this))},r.calculateHighlightColour=function(t){var e=new n(t);return e.increaseBy(30*(e.sum>=540?-1:1)).toString()},r.prototype.setSeries=function(t){var e;for(Array.isArray(t)?this.series=t:this.series=[t],this.renderedSeries=t.slice(0),e=0;e<this.renderedSeries.length;e++){var i=this.series[e];i.colour=i.colour||this.options.defaultPalette[e],i.highlightColour=i.highlightColour||r.calculateHighlightColour(i.colour);var n=s.assign({},i);n.data=this.renderedSeries[e].data.slice(0),this.renderedSeries[e]=n}},r.prototype.setCategories=function(t){this.categories=t},r.prototype.calculateYDataMinMax=function(){var t,e,i,n,r=[],o=[],a=[],l=[];if(this.series[0].data.length){for(t=0;t<this.series[0].data.length;t++)for(r[t]=0,o[t]=0,e=0;e<this.series.length;e++){var h=this.series[e].data[t];s.isMissingValue(h)||(0>h?o[t]+=h:r[t]+=h)}for(var c=0;c<this.series.length;c++){var u=this.series[c];a.push(s.reduce(u.data,Math.min,void 0,!0)),l.push(s.reduce(u.data,Math.max,void 0,!0))}\"stacked\"===this.options.barMode?(i=Math.min(0,s.reduce(o,Math.min,void 0,!0)),n=Math.max(s.reduce(r,Math.max,void 0,!0),0)):(i=s.reduce(a,Math.min,void 0,!0),n=s.reduce(l,Math.max,void 0,!0))}return[i,n]},r.prototype.createTooltip=function(){this.tooltipElement=document.createElement(\"div\"),this.tooltipElement.className=\"tayberry-tooltip\",this.tooltipElement.style.position=\"absolute\",this.tooltipElement.style.left=\"0px\",this.tooltipElement.style.top=\"0px\",this.tooltipElement.style.zIndex=\"99999\",this.tooltipElement.style.font=this.options.font.size+\"px \"+this.options.font.face,this.tooltipElement.style.borderRadius=\"3px\",this.tooltipElement.style.backgroundColor=\"white\",this.tooltipElement.style.border=\"2px solid black\",this.tooltipElement.style.padding=\"0.15em 0.4em\",this.tooltipElement.style.display=\"none\",this.tooltipElement.innerHTML=\"\",document.body.appendChild(this.tooltipElement),this.tooltipElement.addEventListener(\"mousemove\",this.onMouseMove.bind(this)),this.tooltipElement.addEventListener(\"mouseleave\",this.onMouseLeave.bind(this))}},{\"./colour\":1,\"./tayberry.axes\":4,\"./tayberry.base\":5,\"./utils\":12}],7:[function(t,e,i){\"use strict\";var n=t(\"./tayberry.base.js\").Tayberry;n.prototype.defaultOptions=function(){return{defaultPalette:[\"#6FE87B\",\"#FFAB51\",\"#51A8FF\",\"#B651FF\",\"#FF6051\",\"#636363\"],title:{text:\"\",font:{size:20}},font:{colour:\"#444\",size:12,face:\"sans-serif\"},xAxis:{title:\"\",type:\"category\",min:0,max:100,step:1,categories:[],labelPosition:\"middle\"},yAxis:{title:\"\",gridLines:{colour:\"#ccc\"},min:void 0,max:void 0,tickStep:30,labelFormat:\"number\",labelFormatter:void 0,labelPrefix:void 0,labelSuffix:void 0,currencySymbol:\"\"},series:[],barMode:\"normal\",barPadding:2,elementSmallPadding:5,elementLargePadding:10,categorySpacing:.3,presets:[],tooltips:{shared:!1,headerTemplate:\"<strong>{category}</strong><table>\",valueTemplate:'<tr><td style=\"padding-right: 0.5em\"><span style=\"color: {colour}\"></span> {name}</td><td style=\"text-align: right\">{value}</td></tr>',footerTemplate:\"</table>\"},legend:{enabled:!0,indicatorSize:15},labels:{enabled:!1,verticalAlignment:\"top\",verticalPosition:\"outside\"}}},n.presets={histogram:{xAxis:{labelPosition:\"left\"},barMode:\"overlaid\",categorySpacing:0,barPadding:1}}},{\"./tayberry.base.js\":5}],8:[function(t,e,i){\"use strict\";var n=t(\"./tayberry.base.js\").Tayberry;n.prototype.render=function(){this.calculatePlotArea(),this.yAxis.calculateExtent(),this.updateYFormatter(),this.finalisePlotArea(),this.animator=requestAnimationFrame(this.onAnimate.bind(this)),this.animatationStart=performance.now(),this.animationLength=500,this.xAxis.drawCategory(),this.yAxis.drawLinear(),this.createTooltip()},n.prototype.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},n.prototype.drawTitle=function(){if(this.options.title.text){var t=this.canvas.width/2,e=0;this.ctx.save(),this.ctx.textAlign=\"center\",this.ctx.textBaseline=\"top\",this.ctx.font=this.titleFont,this.ctx.fillStyle=this.options.font.colour,this.ctx.fillText(this.options.title.text,t,e),this.ctx.restore()}},n.prototype.drawLabel=function(t,e,i){var s=(i.left+i.right)/2,r=void 0;r=\"top\"===this.options.labels.verticalAlignment?i.top:\"bottom\"===this.options.labels.verticalAlignment?i.bottom:(i.top+i.bottom)/2,this.plotArea.containsPoint(s,r)&&(this.ctx.save(),this.ctx.textAlign=\"center\",this.ctx.textBaseline=n.mapVerticalPosition(t,this.options.labels.verticalPosition),this.ctx.fillStyle=this.options.font.colour,this.ctx.fillText(e,s,r),this.ctx.restore())},n.prototype.draw=function(){this.ctx.save(),this.enumerateBars(function(t){this.ctx.fillStyle=t.selected?t.renderedSeries.highlightColour:t.renderedSeries.colour,this.ctx.fillRect(t.rect.left,t.rect.top,t.rect.width,t.rect.height)}.bind(this)),this.ctx.restore(),this.options.labels.enabled&&(this.ctx.save(),this.enumerateBars(function(t){this.drawLabel(t.value,this.options.yAxis.labelFormatter(t.value),t.rect)}.bind(this)),this.ctx.restore())},n.prototype.drawLine=function(t,e,i,n,s){this.ctx.save(),s&&(this.ctx.strokeStyle=s),this.ctx.beginPath(),this.ctx.moveTo(t+.5,e+.5),this.ctx.lineTo(i+.5,n+.5),this.ctx.stroke(),this.ctx.restore()},n.prototype.redraw=function(){this.clear(),this.drawTitle(),this.xAxis.drawCategory(),this.yAxis.drawLinear(),this.drawLegend(),this.draw()},n.prototype.drawLegend=function(){if(this.options.legend.enabled){for(var t=0,e=this.mapLogicalXUnit(this.options.legend.indicatorSize),i=0;i<this.series.length;i++){var n=this.series[i];n.name&&(t+=this.getTextWidth(n.name)+e+this.mapLogicalXUnit(this.options.elementSmallPadding+this.options.elementLargePadding))}for(var s=this.plotArea.left+this.plotArea.width/2-t/2,r=this.canvas.height-e,i=0;i<this.renderedSeries.length;i++){var n=this.renderedSeries[i];n.name&&(this.ctx.fillStyle=n.colour,this.ctx.fillRect(s,r,e,e),this.ctx.textBaseline=\"middle\",this.ctx.fillStyle=this.options.font.colour,s+=e+this.mapLogicalXUnit(this.options.elementSmallPadding),this.ctx.fillText(n.name,s,r+e/2),s+=this.getTextWidth(n.name)+this.mapLogicalXUnit(this.options.elementLargePadding))}}}},{\"./tayberry.base.js\":5}],9:[function(t,e,i){\"use strict\";var n=t(\"./rect\").Rect,s=t(\"./easing.js\"),r=t(\"./utils.js\"),o=t(\"./tayberry.base.js\").Tayberry;o.prototype.onAnimate=function(t){var e,i;e=t-this.animatationStart,i=Math.min(s.inQuad(e,this.animationLength),1);for(var n=0;n<this.series[0].data.length;n++)for(var r=0;r<this.series.length;r++){var o=this.series[r].data[n],a=this.yAxis.min<=0&&0<=this.yAxis.max?0:this.yAxis.min>0?this.yAxis.min:this.yAxis.max;this.renderedSeries[r].data[n]=a+i*(o-a)}this.redraw(),1>i&&(this.animator=requestAnimationFrame(this.onAnimate.bind(this)))},o.prototype.onMouseLeave=function(t){(t.currentTarget==this.canvas&&t.relatedTarget!==this.tooltipElement||t.currentTarget==this.tooltipElement&&t.relatedTarget!==this.canvas)&&(this.selectedItem={},this.tooltipElement.style.display=\"none\",this.redraw())},o.prototype.handleMouseMove=function(t,e){var i=new n(this.canvas.getBoundingClientRect()),s=!1;if(i.containsPoint(t,e)){var o=t-i.left,a=e-i.top,l=this.hitTest(this.mapLogicalXUnit(o),this.mapLogicalYUnit(a));if(l.found){var h=l.rect.top<l.rect.bottom,c=this.categories[l.categoryIndex];this.tooltipElement.style.display=\"block\";var u=r.formatString(this.options.tooltips.headerTemplate,{category:c},!0);if(this.options.tooltips.shared)for(var p=0;p<this.series.length;p++){var d=this.series[p],f=d.data[l.categoryIndex];u+=r.formatString(this.options.tooltips.valueTemplate,{value:this.options.yAxis.labelFormatter(f),name:d.name,colour:d.colour},!0)}else{var d=this.series[l.seriesIndex],f=d.data[l.categoryIndex];u+=r.formatString(this.options.tooltips.valueTemplate,{value:this.options.yAxis.labelFormatter(f),name:d.name,colour:d.colour},!0)}u+=this.options.tooltips.footerTemplate,this.tooltipElement.innerHTML=u;var m=this.tooltipElement.getBoundingClientRect();this.tooltipElement.style.borderColor=this.renderedSeries[l.seriesIndex].colour,this.tooltipElement.style.left=window.pageXOffset+i.left+this.mapScreenUnit(l.rect.width)/2+l.rect.left/this.scaleFactor-m.width/2+\"px\",this.tooltipElement.style.top=window.pageYOffset+i.top+this.mapScreenUnit(l.rect.top)-m.height*(h?1:0)-this.options.elementSmallPadding*(h?1:-1)+\"px\",this.selectedItem=l,s=!0}}return s},o.prototype.onTouchStart=function(t){for(var e=0;e<t.targetTouches.length;e++){var i=t.targetTouches[e];if(this.handleMouseMove(i.clientX,i.clientY)){t.preventDefault(),this.redraw();break}}},o.prototype.onMouseMove=function(t){var e=r.assign({},this.selectedItem);this.handleMouseMove(t.clientX,t.clientY)||(this.selectedItem={}),(e.categoryIndex!==this.selectedItem.categoryIndex||e.seriesIndex!==this.selectedItem.seriesIndex)&&this.redraw()},o.prototype.onWindowResize=function(t){this.tooltipElement.style.display=\"none\",this.initialise(),this.updateFonts(),this.calculatePlotArea(),this.yAxis.calculateExtent(),this.finalisePlotArea(),this.redraw()}},{\"./easing.js\":2,\"./rect\":3,\"./tayberry.base.js\":5,\"./utils.js\":12}],10:[function(t,e,i){\"use strict\";!function(){var i=t(\"./tayberry.base.js\").Tayberry;t(\"./tayberry.axes.js\"),t(\"./tayberry.core.js\"),t(\"./tayberry.drawing.js\"),t(\"./tayberry.events.js\"),t(\"./tayberry.defaults.js\"),t(\"./tayberry.sizing.js\"),e.exports={create:function(t,e){var n=new i;n.create(t),n.setOptions(e),n.render()}}}()},{\"./tayberry.axes.js\":4,\"./tayberry.base.js\":5,\"./tayberry.core.js\":6,\"./tayberry.defaults.js\":7,\"./tayberry.drawing.js\":8,\"./tayberry.events.js\":9,\"./tayberry.sizing.js\":11}],11:[function(t,e,i){\"use strict\";var n=t(\"./rect\").Rect,s=t(\"./utils\"),r=t(\"./tayberry.base.js\").Tayberry;r.mapVerticalPosition=function(t,e){switch(e){case\"outside\":return t>0?\"bottom\":\"top\";case\"inside\":return t>0?\"top\":\"bottom\";default:return\"middle\"}},r.prototype.mapLogicalXUnit=function(t){return this.scaleFactorX*t},r.prototype.mapLogicalYUnit=function(t){return this.scaleFactorY*t},r.prototype.mapScreenUnit=function(t){return t/this.scaleFactor},r.prototype.getTextWidth=function(t){return this.ctx.measureText(t).width},r.prototype.calculatePlotArea=function(){this.plotArea=new n(0,0,this.canvas.width,this.canvas.height),this.options.title.text&&(this.plotArea.top+=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.title.font.size)),this.options.legend.enabled&&(this.plotArea.bottom-=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.elementLargePadding+this.options.legend.indicatorSize))},r.prototype.finalisePlotArea=function(){for(var t=5,e=0;t>e&&(this.yAxis.adjustSize(this.plotArea)||this.xAxis.adjustSize(this.plotArea));e++);this.plotArea.left=Math.floor(this.plotArea.left),this.plotArea.top=Math.floor(this.plotArea.top),this.plotArea.right=Math.ceil(this.plotArea.right),this.plotArea.bottom=Math.ceil(this.plotArea.bottom)},r.prototype.getYHeight=function(t){return Math.round(t*this.plotArea.height/(this.yAxis.max-this.yAxis.min))},r.prototype.hitTest=function(t,e){var i={found:!1,categoryIndex:void 0,seriesIndex:void 0,rect:void 0},n=[],r=\"overlaid\"===this.options.barMode;if(this.enumerateBars(function(i){return i.rect.containsPoint(t,e)&&(n.push({categoryIndex:i.categoryIndex,seriesIndex:i.seriesIndex,rect:i.rect}),!r)?!0:void 0}.bind(this)),n.length){i.found=!0;for(var o=0,a=n[0].rect.height,l=1;l<n.length;l++){var h=n[l];h.rect.height<a&&(o=l,a=h.rect.height)}i=s.assign(i,n[o])}return i},r.prototype.getYOrigin=function(){return this.plotArea.bottom-this.getYHeight(0-this.yAxis.min)},r.prototype.enumerateBars=function(t){var e=this.renderedSeries[0].data.length;if(e)for(var i=\"stacked\"===this.options.barMode,r=\"overlaid\"===this.options.barMode,o=!i&&!r,a=i||r?1:this.series.length,l=Math.floor(this.plotArea.width/e),h=Math.floor(l*(1-this.options.categorySpacing)/a),c=this.getYOrigin(),u=0;e>u;u++)for(var p=this.plotArea.left+Math.floor(u*l+l*this.options.categorySpacing/2),d=h,f=c,m=c,g=0,y=0,v=0;v<this.renderedSeries.length;v++){var x=this.renderedSeries[v].data[u];if(!s.isMissingValue(x)){var b=c-this.getYHeight(x+(x>0?g:y)),A=new n(p,b,p+d,x>0?f:m);A.left+=Math.ceil(this.options.barPadding*this.scaleFactor/2),A.right-=Math.floor(this.options.barPadding*this.scaleFactor/2),A.right<A.left&&(A.right=A.left),A.clip(this.plotArea);var S=t({seriesIndex:v,categoryIndex:u,series:this.renderedSeries[v],renderedSeries:this.renderedSeries[v],value:this.series[v].data[u],renderedValue:this.renderedSeries[v].data[u],rect:A,selected:this.selectedItem.categoryIndex===u&&this.selectedItem.seriesIndex===v});if(S)break;i?x>0?(g+=x,f=b):(y+=x,m=b):o&&(p+=h)}}}},{\"./rect\":3,\"./tayberry.base.js\":5,\"./utils\":12}],12:[function(t,e,i){\"use strict\";!function(){i.identity=function(t){return t},i.isMissingValue=function(t){return null===t||\"undefined\"==typeof t||isNaN(t)&&\"number\"==typeof t},i.reduce=function(t,e,n){var s,r,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(!t.reduce||n||o){if(n=n||i.identity,t.length)for(s=n(t[0]),r=1;r<t.length;r++){var a=n(t[r]);o&&i.isMissingValue(a)||(s=e(s,a))}}else s=t.reduce(function(t,i){return e(t,i)});return s},i.sign=Math.sign||function(t){return t>0?1:0>t?-1:0},i.now=\"undefined\"!=typeof performance&&\"undefined\"!=typeof performance.now?performance.now:function(){return(new Date).getTime()};var t=function e(t,i,n){if(Array.isArray(n)||(n=[n]),!t&&Object.assign)return Object.assign.apply(Object,[i].concat(n));if(void 0===i||null===i)throw new TypeError(\"Cannot convert first argument to object\");for(var s=Object(i),r=0;r<n.length;r++){var o=n[r];if(void 0!==o&&null!==o){o=Object(o);for(var a=Object.keys(o),l=0,h=a.length;h>l;l++){var c=a[l],u=o[c],p=Object.getOwnPropertyDescriptor(o,c);void 0!==p&&p.enumerable&&(t&&\"object\"==typeof s[c]&&!Array.isArray(u)&&\"object\"==typeof u?e(!0,s[c],u):s[c]=u)}}}return s};i.assign=function(e,i){return t(!1,e,i)},i.deepAssign=function(e,i){return t(!0,e,i)},i.formatString=function(t,e,n){return t.replace(/{(\\w+)}/g,function(t,s){var r=e[s];return\"undefined\"!=typeof r?n?i.stringToHtml(r):r:t})},i.locateDecimalPoint=function(t){return Math.floor(Math.log(t)/Math.log(10))},i.formatNumberThousands=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=t.toFixed(e).split(\".\");return i[0]=i[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\"),i.join(\".\")},i.createAutoNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],n=arguments.length<=2||void 0===arguments[2]?\"\":arguments[2],s=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(t);return r=0>r?-r+s-1:0,function(t){return e+i.formatNumberThousands(t,r)+n}},i.createFixedNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],n=arguments.length<=2||void 0===arguments[2]?\"\":arguments[2],s=arguments.length<=3||void 0===arguments[3]?2:arguments[3];return function(t){return e+i.formatNumberThousands(t,s)+n}},i.createPercentageFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?\"\":arguments[1],n=arguments.length<=2||void 0===arguments[2]?\"%\":arguments[2],s=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(100*t);return r=0>r?-r+s-1:0,function(t){return e+i.formatNumberThousands(100*t,r)+n}},i.stringToHtml=function(t){var e=document.createElement(\"div\");return e.appendChild(document.createTextNode(t)),e.innerHTML},i.throttle=function(t,e){var i,n;return function(){var s=this,r=Date.now(),o=arguments;i&&i+e>r?(clearTimeout(n),n=setTimeout(function(){i=r,t.apply(s,o)},e)):(i=r,t.apply(s,o))}}}()},{}]},{},[10])(10)});\n//# sourceMappingURL=tayberry.min.js.map\n","var Utils = require('./utils.js');\r\nclass Colour {\r\n    /**\r\n     * Constructs a Colour object.\r\n     *\r\n     * @param colourCode    an HTML colour code in hex or integer (rgb) form\r\n     */\r\n    constructor() {\r\n        if (arguments.length === 1) {\r\n            let arg1 = arguments[0];\r\n            if (typeof arg1 === 'string')\r\n                this.parseString(arg1);\r\n            else {\r\n                this.r = arg1.r;\r\n                this.g = arg1.g;\r\n                this.b = arg1.b;\r\n                this.a = arg1.a;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Parses an HTML colour code\r\n     * @param str\r\n     * @returns {Colour}\r\n     */\r\n    parseString (str) {\r\n        let regExHex = /^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i;\r\n        let regExInt = /^rgba?\\((\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})(\\s*,\\s*([0-9]*\\.?[0-9]+))+\\)$/i;\r\n        const groupsHex = regExHex.exec(str);\r\n        const groupsInt = regExInt.exec(str);\r\n        if (groupsHex) {\r\n            let parseHex = function(value) {\r\n                let ret = parseInt(value, 16);\r\n                ret = ret*0x10 + ret;\r\n                return ret;\r\n            };\r\n            this.r = groupsHex[1] ? parseInt(groupsHex[1], 16) : parseHex(groupsHex[4]);\r\n            this.g = groupsHex[2] ? parseInt(groupsHex[2], 16) : parseHex(groupsHex[5]);\r\n            this.b = groupsHex[3] ? parseInt(groupsHex[3], 16) : parseHex(groupsHex[6]);\r\n            this.a = null;\r\n        }\r\n        else if (groupsInt) {\r\n            this.r = parseInt(groupsInt[1]);\r\n            this.g = parseInt(groupsInt[2]);\r\n            this.b = parseInt(groupsInt[3]);\r\n            this.a = groupsInt[5] ? parseFloat(groupsInt[5]) : null;\r\n        } else {\r\n            this.r = null;\r\n            this.g = null;\r\n            this.b = null;\r\n            this.a = null;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clips a colour component to be in the range [0, 255], and round it them to\r\n     * the nearest integer\r\n     * @param component\r\n     * @returns {Colour}\r\n     */\r\n    clipComponent(component) {\r\n        this[component] = Math.round(this[component]);\r\n        this[component] = Math.min(this[component], 255);\r\n        this[component] = Math.max(this[component], 0);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Clips r,g,b colour components to be in the range [0, 255], and rounds them to\r\n     * the nearest integer\r\n     * @returns {Colour}\r\n     */\r\n    clip () {\r\n        this.clipComponent('r');\r\n        this.clipComponent('g');\r\n        this.clipComponent('b');\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Multiplies each colour component by a number\r\n     * @param number\r\n     * @returns {Colour}\r\n     */\r\n    multiplyBy (number) {\r\n        this.r *= number;\r\n        this.g *= number;\r\n        this.b *= number;\r\n        this.clip();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Adds a number to each colour component\r\n     * @param number\r\n     * @returns {Colour}\r\n     */\r\n    increaseBy (number) {\r\n        this.r += number;\r\n        this.g += number;\r\n        this.b += number;\r\n        this.clip();\r\n        return this;\r\n    }\r\n\r\n    get sum() {\r\n        return this.r + this.g + this.b;\r\n    }\r\n\r\n    /**\r\n     * Formats this colour as a string\r\n     * @returns {String}\r\n     */\r\n    toString() {\r\n        var ret;\r\n        if (this.a) {\r\n            ret = Utils.formatString('rgba({r},{g},{b},{a})', this);\r\n        } else {\r\n            ret = Utils.formatString('rgb({r},{g},{b})', this);\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Multiplies each colour component of a colour code by a number\r\n     * @param colour\r\n     * @param number\r\n     * @returns {String}\r\n     */\r\n    static multiplyBy(colour, number) {\r\n        return (new Colour(colour)).multiplyBy(number).toString();\r\n    }\r\n\r\n}\r\n\r\nexports.Colour = Colour;","exports.linear = function (time, duration) {\r\n    return (time / duration);\r\n};\r\n\r\nexports.linear = function (time, duration) {\r\n    return (time / duration);\r\n};\r\n\r\nexports.inQuad = function (time, duration) {\r\n    var factor = time / duration;\r\n    return factor * factor;\r\n};\r\n\r\nexports.outQuad = function (time, duration) {\r\n    var factor = time / duration;\r\n    return factor * (2 - factor);\r\n};\r\n","class Rect {\r\n    constructor() {\r\n        var rect;\r\n        if (arguments.length === 1) {\r\n            rect = arguments[0];\r\n            this.left = rect.left;\r\n            this.top = rect.top;\r\n            this.right = rect.right;\r\n            this.bottom = rect.bottom;\r\n        } else if (arguments.length === 4) {\r\n            this.left = arguments[0];\r\n            this.top = arguments[1];\r\n            this.right = arguments[2];\r\n            this.bottom = arguments[3];\r\n        }\r\n    }\r\n\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n\r\n    get maxY() {\r\n        return Math.max(this.bottom, this.top);\r\n    }\r\n\r\n    get minY() {\r\n        return Math.min(this.bottom, this.top);\r\n    }\r\n\r\n    get minX() {\r\n        return Math.min(this.left, this.right);\r\n    }\r\n\r\n    get maxX() {\r\n        return Math.max(this.left, this.right);\r\n    }\r\n\r\n    containsPoint(x, y) {\r\n        return this.containsX(x) && this.containsY(y);\r\n    }\r\n\r\n    containsY(y) {\r\n        return y >= this.minY && y < this.maxY;\r\n    }\r\n\r\n    containsX(x) {\r\n        return x >= this.minX && x < this.maxX;\r\n    }\r\n\r\n    clip(clipRect) {\r\n        if (this.left < clipRect.minX) this.left = clipRect.minX;\r\n        else if (this.left > clipRect.maxX) this.left = clipRect.maxX;\r\n\r\n        if (this.right < clipRect.minX) this.right = clipRect.minX;\r\n        else if (this.right > clipRect.maxX) this.right = clipRect.maxX;\r\n\r\n        if (this.top < clipRect.minY)\r\n            this.top = clipRect.minY;\r\n        else if (this.top > clipRect.maxY)\r\n            this.top = clipRect.maxY;\r\n\r\n        if (this.bottom > clipRect.maxY)\r\n            this.bottom = clipRect.maxY;\r\n        else if (this.bottom < clipRect.minY)\r\n            this.bottom = clipRect.minY;\r\n\r\n        return this;\r\n    }\r\n\r\n    clone() {\r\n        return new Rect(this);\r\n    }\r\n\r\n    swapXY() {\r\n        [this.left, this.top] = [this.top, this.left];\r\n        [this.bottom, this.right] = [this.right, this.bottom];\r\n        return this;\r\n    }\r\n}\r\n\r\nexports.Rect = Rect;","'use strict';\r\nvar Utils = require('./utils.js');\r\n\r\nclass Axis {\r\n    static create(tayberry, options, index, axisType, xYSwapped) {\r\n        if (xYSwapped) {\r\n            axisType = axisType === 'y' ? 'x' : 'y';\r\n        }\r\n        if (options.type === 'linear')\r\n            return new LinearAxis(tayberry, index, options, axisType);\r\n        else\r\n            return new CategorialAxis(tayberry, index, options, axisType);\r\n    }\r\n\r\n    constructor(tayberry, index, options, axisType) {\r\n        this.tayberry = tayberry;\r\n        this.options = options;\r\n        this.axisType = axisType;\r\n        this.index = index;\r\n        this.tickStep = null;\r\n        this.min = null;\r\n        this.max = null;\r\n        this.tickStart = null;\r\n        this.tickEnd = null;\r\n        this.calculatedSize = 0;\r\n\r\n        this.setPlacement();\r\n    }\r\n\r\n    setPlacement() {\r\n        const validAndSpecificPlacements = ['left', 'right', 'top', 'bottom', 'start', 'end'];\r\n        if (validAndSpecificPlacements.indexOf(this.options.placement) === -1) {\r\n            this.options.placement = this.isYAxis ^ (this.index > 0) ? 'start' : 'end';\r\n        }\r\n    }\r\n\r\n    get isPlacedAtStart() {\r\n        return this.options.placement === \"left\" || this.options.placement === \"bottom\" || this.options.placement === \"start\";\r\n    }\r\n\r\n    get isYAxis() {\r\n        return this.axisType === 'y';\r\n    }\r\n\r\n    maxLabelSize() {\r\n    }\r\n\r\n    mapLogicalXOrYUnit(x) {\r\n        return this.isYAxis ? this.tayberry.mapLogicalXUnit(x) : this.tayberry.mapLogicalYUnit(x);\r\n    }\r\n\r\n    mapLogicalYOrXUnit(x) {\r\n        return !this.isYAxis ? this.tayberry.mapLogicalXUnit(x) : this.tayberry.mapLogicalYUnit(x);\r\n    }\r\n\r\n    adjustSize(plotArea, fixedOnly = false, reset = false) {\r\n        let size = 0,\r\n            tb = this.tayberry,\r\n            ret;\r\n\r\n        if (reset)\r\n            this.calculatedSize = 0;\r\n\r\n        size += this.mapLogicalXOrYUnit(tb.options.elementSmallPadding);\r\n        if (this.options.title) {\r\n            size += this.mapLogicalXOrYUnit(tb.options.elementSmallPadding + tb.options.font.size);\r\n        }\r\n\r\n        if (!fixedOnly) {\r\n            if (this.isYAxis) {\r\n                size += this.maxLabelSize()\r\n            } else {\r\n                size += this.mapLogicalXOrYUnit(tb.options.font.size);\r\n            }\r\n        }\r\n\r\n        if (this.isPlacedAtStart) {\r\n            if (this.isYAxis) {\r\n                plotArea.left += size - this.calculatedSize;\r\n            } else {\r\n                plotArea.top += size - this.calculatedSize;\r\n            }\r\n        } else {\r\n            size *= -1;\r\n            if (this.isYAxis) {\r\n                plotArea.right += size - this.calculatedSize;\r\n            } else {\r\n                plotArea.bottom += size - this.calculatedSize;\r\n            }\r\n        }\r\n\r\n        ret = this.calculatedSize !== size;\r\n        this.calculatedSize = size;\r\n\r\n        return ret;\r\n    }\r\n\r\n    calculateExtent() {\r\n    }\r\n\r\n    draw() {\r\n        this.drawTicksAndLabels();\r\n        this.drawTitle();\r\n    }\r\n\r\n    drawTicksAndLabels() {\r\n    }\r\n\r\n    get startProperty() {\r\n        if (this.isYAxis)\r\n            return this.isPlacedAtStart ? 'left' : 'right';\r\n        else\r\n            return this.isPlacedAtStart ? 'top' : 'bottom';\r\n    }\r\n\r\n    get endProperty() {\r\n        if (this.isYAxis)\r\n            return !this.isPlacedAtStart ? 'left' : 'right';\r\n        else\r\n            return !this.isPlacedAtStart ? 'top' : 'bottom';\r\n    }\r\n\r\n    get plotDisplacement() {\r\n        return this.isYAxis ? (this.tayberry.plotArea.height) : -(this.tayberry.plotArea.width);\r\n    }\r\n\r\n    get plotLength() {\r\n        return Math.abs(this.plotDisplacement);\r\n    }\r\n\r\n    drawTitle() {\r\n        let tb = this.tayberry;\r\n        tb.ctx.save();\r\n        tb.ctx.fillStyle = tb.options.font.colour;\r\n        tb.ctx.textAlign = 'center';\r\n        tb.ctx.textBaseline = !this.isPlacedAtStart ? 'bottom' : 'top';\r\n\r\n        if (this.isYAxis) {\r\n            const x = 0;\r\n            const y = tb.plotArea.top + (tb.plotArea.height) / 2;\r\n            tb.ctx.translate(x, y);\r\n            tb.ctx.rotate(-Math.PI / 2);\r\n            tb.ctx.fillText(this.options.title, 0, 0);\r\n        } else {\r\n            const x = tb.plotArea.left + tb.plotArea.width / 2;\r\n            const y = tb.plotArea[this.startProperty] - this.calculatedSize;\r\n            //tb.mapLogicalYOrXUnit(tb.options.font.size * 2 + tb.options.elementSmallPadding + tb.options.elementLargePadding)\r\n            tb.ctx.fillText(this.options.title, x, y);\r\n        }\r\n        tb.ctx.restore();\r\n    }\r\n\r\n    getOrigin() {\r\n    }\r\n}\r\n\r\nclass CategorialAxis extends Axis {\r\n    drawTicksAndLabels() {\r\n        var i, x, y, lastXEnd;\r\n        let tb = this.tayberry;\r\n        const categoryCount = this.options.categories.length;\r\n        let plotArea = tb.plotArea.clone();\r\n        if (this.isYAxis)\r\n            plotArea.swapXY();\r\n        const categoryWidth = (plotArea.width / tb.series[0].data.length);\r\n        tb.ctx.save();\r\n        tb.ctx.fillStyle = tb.options.font.colour;\r\n        tb.ctx.textAlign = this.isYAxis ? 'right' : 'center';\r\n        tb.ctx.textBaseline = this.isYAxis ? 'top' : 'top';\r\n        let factor;\r\n        switch (this.options.labelPosition) {\r\n            case 'left':\r\n                factor = 0;\r\n                break;\r\n            case 'right':\r\n                factor = 1;\r\n                break;\r\n            default:\r\n                factor = 0.5;\r\n                break;\r\n        }\r\n        for (i = 0; i < categoryCount; i++) {\r\n            x = plotArea.left + Math.floor(i * categoryWidth + categoryWidth * factor);\r\n            y = (this.isPlacedAtStart ? plotArea.top : plotArea.bottom) + this.mapLogicalXOrYUnit(tb.options.elementSmallPadding) * (this.isPlacedAtStart ? -1 : 1);\r\n            const textWidth = tb.getTextWidth(this.options.categories[i]);\r\n            const xStart = x - textWidth / 2;\r\n            const xEnd = x + textWidth / 2;\r\n            if (typeof lastXEnd === 'undefined' || xStart > lastXEnd + 1) {\r\n                if (this.isYAxis)\r\n                    [x, y] = [y, x];\r\n                tb.ctx.fillText(this.options.categories[i], x, y);\r\n                lastXEnd = xEnd;\r\n            }\r\n        }\r\n        tb.ctx.restore();\r\n    }\r\n\r\n    maxLabelSize() {\r\n        let tb = this.tayberry;\r\n        return Utils.reduce(this.options.categories, Math.max, tb.getTextWidth.bind(tb));\r\n    }\r\n}\r\n\r\nclass LinearAxis extends Axis {\r\n    maxLabelSize() {\r\n        let tb = this.tayberry;\r\n        return Math.max(tb.getTextWidth(this.options.labelFormatter(this.tickStart)), tb.getTextWidth(this.options.labelFormatter(this.tickEnd)));\r\n    }\r\n\r\n    enumerateTicks(callback) {\r\n        var yValue, x, y;\r\n        let tb = this.tayberry;\r\n\r\n        const start = this.startProperty,\r\n            end = this.endProperty;\r\n\r\n        for (yValue = this.tickStart; yValue <= this.tickEnd && this.tickStep;) {\r\n            x = tb.plotArea[start] + this.mapLogicalXOrYUnit(tb.options.elementSmallPadding) * (this.isPlacedAtStart ? -1 : 1);\r\n            y = this.getValueDisplacement(yValue);\r\n            if (this.isYAxis) {\r\n                if (tb.plotArea.containsY(y)) {\r\n                    if (callback({\r\n                            value: yValue,\r\n                            x1: tb.plotArea[start],\r\n                            y1: y,\r\n                            x2: tb.plotArea[end],\r\n                            y2: y\r\n                        }))\r\n                        break;\r\n                }\r\n            } else {\r\n                if (tb.plotArea.containsX(y)) {\r\n                    if (callback({\r\n                            value: yValue,\r\n                            y1: tb.plotArea[start],\r\n                            x1: y,\r\n                            y2: tb.plotArea[end],\r\n                            x2: y\r\n                        }))\r\n                        break;\r\n                }\r\n            }\r\n            yValue = this.tickStart + Math.round((yValue + this.tickStep - this.tickStart) / this.tickStep) * this.tickStep;\r\n        }\r\n    }\r\n\r\n    drawTicksAndLabels() {\r\n        let tb = this.tayberry;\r\n        const labelPaddingX = this.isYAxis ? this.mapLogicalXOrYUnit(tb.options.elementSmallPadding)*(this.isPlacedAtStart ? -1 : 1) : 0;\r\n        const labelPaddingY = !this.isYAxis ? this.mapLogicalXOrYUnit(tb.options.elementSmallPadding)*(this.isPlacedAtStart ? -1 : 1) : 0;\r\n\r\n        tb.ctx.save();\r\n        tb.ctx.fillStyle = tb.options.font.colour;\r\n        tb.ctx.textAlign = this.isYAxis ? 'right' : 'center';\r\n        tb.ctx.textBaseline = this.isYAxis ? 'middle' : 'top';\r\n\r\n        this.enumerateTicks(function(tick) {\r\n            tb.ctx.fillText(this.options.labelFormatter(tick.value), tick.x1 + labelPaddingX, tick.y1 + labelPaddingY);\r\n            tb.drawLine(tick.x1, tick.y1, tick.x2, tick.y2, this.options.gridLines.colour);\r\n        }.bind(this));\r\n\r\n        tb.ctx.restore();\r\n    }\r\n\r\n    calculateExtent() {\r\n        if (this.options.type === 'linear') {\r\n            let targetTicks, approxStep, scale;\r\n\r\n            let targetStart = this.options.min;\r\n            let targetEnd = this.options.max;\r\n            const overriddenStart = typeof targetStart !== 'undefined';\r\n            const overriddenEnd = typeof targetEnd !== 'undefined';\r\n\r\n            if (!overriddenStart || !overriddenEnd) {\r\n                const [dataMin, dataMax] = this.tayberry.getDataMinMax(); //TODO: implement for x-axis\r\n                const dataRange = dataMax - dataMin;\r\n                if (!overriddenStart) {\r\n                    targetStart = dataMin - dataRange * 0.1;\r\n                    if (dataMin >= 0 && targetStart < 0)\r\n                        targetStart = 0;\r\n                }\r\n                if (!overriddenEnd) {\r\n                    targetEnd = dataMax + dataRange * 0.1;\r\n                    if (dataMax <= 0 && targetStart > 0)\r\n                        targetEnd = 0;\r\n                }\r\n            }\r\n\r\n            const targetRange = targetEnd - targetStart;\r\n\r\n            targetTicks = this.plotLength / this.mapLogicalYOrXUnit(this.options.tickStep);\r\n            approxStep = targetRange / targetTicks;\r\n            scale = Math.pow(10, Math.floor(Math.log(approxStep) / Math.log(10)));\r\n            this.tickStep = Math.ceil(approxStep / scale) * scale;\r\n            this.min = targetStart;\r\n            this.max = targetEnd;\r\n            if (!overriddenStart)\r\n                this.min = Math.floor(this.min / scale) * scale;\r\n            if (!overriddenEnd)\r\n                this.max = Math.ceil(this.max / scale) * scale;\r\n            this.tickStart = Math.floor(this.min / this.tickStep) * this.tickStep;\r\n            this.tickEnd = Math.ceil(this.max / this.tickStep) * this.tickStep;\r\n        }\r\n    }\r\n\r\n    getOrigin() {\r\n        let ret = this.tayberry.plotArea[this.isYAxis ? 'bottom' : 'left'] - (0 - this.min) * this.plotDisplacement / (this.max - this.min);\r\n        ret = this.isYAxis ? Math.floor(ret) : Math.ceil(ret);\r\n        return ret;\r\n    }\r\n\r\n    getValueDisplacement(value) {\r\n        let ret = this.getOrigin() - value * this.plotDisplacement / (this.max - this.min);\r\n        ret = this.isYAxis ? Math.floor(ret) : Math.ceil(ret);\r\n        return ret;\r\n    }\r\n}\r\n\r\nexports.Axis = Axis;","class Tayberry {\r\n    constructor() {\r\n        this.selectedItem = {};\r\n        this.containerElement = null;\r\n        this.canvas = null;\r\n        this.ctx = null;\r\n        this.renderedSeries = null;\r\n        this.options = null;\r\n        this.scaleFactor = null;\r\n        this.titleFont = null;\r\n        this.plotArea = null;\r\n        this.series = [];\r\n        this.categories = [];\r\n    }\r\n\r\n    get seriesCount() {\r\n        return this.series.length;\r\n    }\r\n\r\n    get categoryCount() {\r\n        return this.series.length ? this.series[0].data.length : 0;\r\n    }\r\n}\r\n\r\nexports.Tayberry = Tayberry;\r\n\r\n\r\n","'use strict';\r\nvar Colour = require('./colour').Colour;\r\nvar Utils = require('./utils');\r\n\r\nvar Tayberry = require('./tayberry.base').Tayberry;\r\nvar Axis = require('./tayberry.axes').Axis;\r\n\r\nTayberry.prototype.create = function (containerElement) {\r\n    if (typeof containerElement == 'string') {\r\n        this.containerElement = document.getElementById(containerElement);\r\n    } else {\r\n        this.containerElement = containerElement;\r\n    }\r\n    this.canvas = document.createElement('canvas');\r\n    this.canvas.style.width = '100%';\r\n    this.canvas.style.height = '100%';\r\n    this.containerElement.appendChild(this.canvas);\r\n    this.ctx = this.canvas.getContext('2d');\r\n    this.renderedSeries = null;\r\n    this.options = {};\r\n    this.yAxis = null;\r\n    this.xAxis = null;\r\n    this.initialise();\r\n};\r\n\r\nTayberry.prototype.destroy = function () {\r\n    this.canvas.remove();\r\n    this.tooltipElement.remove();\r\n    this.options = {};\r\n    this.series = {};\r\n    this.canvas.removeEventListener('mousemove', this.onMouseMoveReal);\r\n    this.canvas.removeEventListener('mouseleave', this.onMouseLeaveReal);\r\n    this.canvas.removeEventListener('touchstart', this.onTouchStartReal);\r\n    window.removeEventListener('resize', this.onWindowResizeReal);\r\n};\r\n\r\nTayberry.prototype.initialise = function () {\r\n    this.scaleFactor = window.devicePixelRatio || 1.0;\r\n    this.canvas.width = Math.round(this.containerElement.clientWidth * this.scaleFactor);\r\n    this.canvas.height = Math.round(this.containerElement.clientHeight * this.scaleFactor);\r\n    this.scaleFactorX = this.canvas.width / this.containerElement.clientWidth;\r\n    this.scaleFactorY = this.canvas.height / this.containerElement.clientHeight;\r\n    this.selectedItem = {};\r\n    this.plotArea = null;\r\n};\r\n\r\nTayberry.prototype.updateFonts = function () {\r\n    this.ctx.font = this.mapLogicalYUnit(this.options.font.size) + 'px ' + this.options.font.face;\r\n    this.titleFont = this.mapLogicalYUnit(this.options.title.font.size) + 'px ' + this.options.font.face;\r\n};\r\n\r\nTayberry.prototype.updateYFormatter = function () {\r\n    if (!this.options.yAxis.labelFormatter) {\r\n        if (this.options.yAxis.labelFormat === 'percentage') {\r\n            this.options.yAxis.labelFormatter = Utils.createPercentageFormatter(this.yAxis.max - this.yAxis.min, this.options.yAxis.labelPrefix, this.options.yAxis.labelSuffix);\r\n        }\r\n        else if (this.options.yAxis.labelFormat === 'currency') {\r\n            this.options.yAxis.labelFormatter = Utils.createFixedNumberFormatter(this.yAxis.max - this.yAxis.min, this.options.yAxis.labelPrefix || this.options.yAxis.currencySymbol, this.options.yAxis.labelSuffix);\r\n        }\r\n        else {\r\n            this.options.yAxis.labelFormatter = Utils.createAutoNumberFormatter(this.yAxis.max - this.yAxis.min, this.options.yAxis.labelPrefix, this.options.yAxis.labelSuffix);\r\n        }\r\n    }\r\n};\r\n\r\nTayberry.prototype.setOptions = function (options) {\r\n    let optionOverrides = [this.defaultOptions()];\r\n    if (options.presets) {\r\n        for (let index = 0; index < options.presets.length; index++) {\r\n            optionOverrides.push(Tayberry.presets[options.presets[index]]);\r\n        }\r\n    }\r\n    optionOverrides.push(options);\r\n    this.options = Utils.deepAssign({}, optionOverrides);\r\n    this.setSeries(options.series);\r\n    //this.setCategories(options.xAxis.categories);\r\n    this.updateFonts();\r\n    this.yAxis = Axis.create(this, this.options.yAxis, 0, 'y', this.options.barChart.orientation === 'horizontal');\r\n    this.xAxis = Axis.create(this, this.options.xAxis, 0, 'x', this.options.barChart.orientation === 'horizontal');\r\n    this.canvas.addEventListener('mousemove', this.onMouseMoveReal = this.onMouseMove.bind(this));\r\n    this.canvas.addEventListener('mouseleave', this.onMouseLeaveReal = this.onMouseLeave.bind(this));\r\n    this.canvas.addEventListener('touchstart', this.onTouchStartReal = this.onTouchStart.bind(this));\r\n    window.addEventListener('resize', this.onWindowResizeReal = Utils.throttle(this.onWindowResize, 50).bind(this));\r\n};\r\n\r\nTayberry.calculateHighlightColour = function (colour) {\r\n    let newColour = new Colour(colour);\r\n    return newColour.increaseBy(30 * (newColour.sum >= 180 * 3 ? -1 : 1)).toString();\r\n};\r\n\r\n/**\r\n * Format:\r\n * [{\r\n *   data: {array|object},\r\n *   name: {string}\r\n * },{\r\n *   data: {array|object},\r\n *   name: {string}\r\n * }]\r\n * @param series\r\n */\r\nTayberry.prototype.setSeries = function (series) {\r\n    var i;\r\n    if (!Array.isArray(series)) {\r\n        this.series = [series];\r\n    } else {\r\n        this.series = series;\r\n    }\r\n    this.renderedSeries = series.slice(0);\r\n    for (i = 0; i < this.renderedSeries.length; i++) {\r\n        let actualSeries = this.series[i];\r\n        actualSeries.colour = actualSeries.colour || this.options.defaultPalette[i];\r\n        actualSeries.highlightColour = actualSeries.highlightColour || Tayberry.calculateHighlightColour(actualSeries.colour);\r\n        let elem = Utils.assign({}, actualSeries);\r\n        elem.data = this.renderedSeries[i].data.slice(0);\r\n        this.renderedSeries[i] = elem;\r\n    }\r\n};\r\n\r\n\r\nTayberry.prototype.setCategories = function (categories) {\r\n    this.categories = (categories);\r\n    //if (this.options.xAxis.type === 'numeric' || this.options.xAxis.type === 'numerical') {\r\n    //    this.categories = [];\r\n    //    for (let i = this.options.xAxis.min; i <= this.options.xAxis.max; i += this.options.xAxis.step) {\r\n    //        i = Math.round(i / this.options.xAxis.step) * this.options.xAxis.step;\r\n    //        this.categories.push(i);\r\n    //    }\r\n    //}\r\n};\r\n\r\nTayberry.prototype.getDataMinMax = function () {\r\n    var categoryIndex, seriesIndex, min, max;\r\n    let seriesPositiveTotals = [];\r\n    let seriesNegativeTotals = [];\r\n    const seriesMinima = [];\r\n    const seriesMaxima = [];\r\n    if (this.series[0].data.length) {\r\n        for (categoryIndex = 0; categoryIndex < this.series[0].data.length; categoryIndex++) {\r\n            seriesPositiveTotals[categoryIndex] = 0;\r\n            seriesNegativeTotals[categoryIndex] = 0;\r\n            for (seriesIndex = 0; seriesIndex < this.series.length; seriesIndex++) {\r\n                const value = this.series[seriesIndex].data[categoryIndex];\r\n                if (!Utils.isMissingValue(value)) {\r\n                    if (value < 0) {\r\n                        seriesNegativeTotals[categoryIndex] += value;\r\n                    } else {\r\n                        seriesPositiveTotals[categoryIndex] += value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let index = 0; index < this.series.length; index++) {\r\n            const series = this.series[index];\r\n            seriesMinima.push(Utils.reduce(series.data, Math.min, undefined, true));\r\n            seriesMaxima.push(Utils.reduce(series.data, Math.max, undefined, true));\r\n        }\r\n        if (this.options.barMode === 'stacked') {\r\n            min = Math.min(0, Utils.reduce(seriesNegativeTotals, Math.min, undefined, true));\r\n            max = Math.max(Utils.reduce(seriesPositiveTotals, Math.max, undefined, true), 0);\r\n        } else {\r\n            min = Utils.reduce(seriesMinima, Math.min, undefined, true);\r\n            max = Utils.reduce(seriesMaxima, Math.max, undefined, true);\r\n        }\r\n    }\r\n    return [min, max];\r\n};\r\n\r\n\r\nTayberry.prototype.createTooltip = function () {\r\n\r\n    this.tooltipElement = document.createElement('div');\r\n    this.tooltipElement.className = 'tayberry-tooltip';\r\n    this.tooltipElement.style.position = 'absolute';\r\n    this.tooltipElement.style.left = '0px';\r\n    this.tooltipElement.style.top = '0px';\r\n    this.tooltipElement.style.zIndex = '99999';\r\n    this.tooltipElement.style.font = this.options.font.size + 'px ' + this.options.font.face;\r\n    this.tooltipElement.style.borderRadius = '3px';\r\n    this.tooltipElement.style.backgroundColor = 'white';\r\n    this.tooltipElement.style.border = '2px solid black';\r\n    this.tooltipElement.style.padding = '0.15em 0.4em';\r\n    this.tooltipElement.style.display = 'none';\r\n    this.tooltipElement.innerHTML = '';\r\n    document.body.appendChild(this.tooltipElement);\r\n    this.tooltipElement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n    this.tooltipElement.addEventListener('mouseleave', this.onMouseLeave.bind(this));\r\n};\r\n","'use strict';\r\nvar Tayberry = require('./tayberry.base.js').Tayberry;\r\n\r\nTayberry.prototype.defaultOptions = function () {\r\n    return {\r\n        defaultPalette: [\r\n            '#6FE87B', //green\r\n            '#FFAB51', //orange\r\n            '#51A8FF', //blue\r\n            '#B651FF', //purple\r\n            '#FF6051', //red\r\n            '#636363' //dark grey\r\n        ],\r\n        title: {\r\n            text: '',\r\n            font: {\r\n                size: 20\r\n            }\r\n        },\r\n        font: {\r\n            colour: '#444',\r\n            size: 12,\r\n            face: 'sans-serif'\r\n        },\r\n        xAxis: {\r\n            title: '',\r\n            type: 'categorial',\r\n            min: 0,\r\n            max: 100,\r\n            step: 1,\r\n            categories: [],\r\n            labelPosition: 'middle', //left|middle|right\r\n            placement: 'auto'\r\n        },\r\n        yAxis: {\r\n            title: '',\r\n            gridLines: {\r\n                colour: '#ccc'\r\n            },\r\n            min: undefined,\r\n            max: undefined,\r\n            tickStep: 30,\r\n            labelFormat: 'number', //[number|percentage|currency],\r\n            labelFormatter: undefined,\r\n            labelPrefix: undefined,\r\n            labelSuffix: undefined,\r\n            currencySymbol: '',\r\n            placement: 'auto',\r\n            type: 'linear'\r\n        },\r\n        series: [],\r\n        barChart: {\r\n            orientation: \"vertical\"\r\n        },\r\n        barMode: 'normal', //[normal|stacked|overlaid]\r\n        barPadding: 2,\r\n        elementSmallPadding: 5,\r\n        elementLargePadding: 10,\r\n        categorySpacing: 0.3,\r\n        presets: [],\r\n        tooltips: {\r\n            shared: false,\r\n            headerTemplate: '<strong>{category}</strong><table>',\r\n            valueTemplate: '<tr><td style=\"padding-right: 0.5em\"><span style=\"color: {colour}\">\\u25CF</span> {name}</td><td style=\"text-align: right\">{value}</td></tr>',\r\n            footerTemplate: '</table>'\r\n        },\r\n        legend: {\r\n            enabled: true,\r\n            indicatorSize: 15\r\n        },\r\n        labels: {\r\n            enabled: false,\r\n            verticalAlignment: 'top',\r\n            verticalPosition: 'outside'\r\n        }\r\n    }\r\n};\r\n\r\nTayberry.presets = {\r\n    histogram: {\r\n        xAxis: {\r\n            labelPosition: 'left'\r\n        },\r\n        barMode: 'overlaid',\r\n        categorySpacing: 0,\r\n        barPadding: 1\r\n    }\r\n};\r\n","'use strict';\r\nvar Tayberry = require('./tayberry.base.js').Tayberry;\r\n\r\nTayberry.prototype.render = function () {\r\n    this.calculatePlotArea();\r\n    this.animator = requestAnimationFrame(this.onAnimate.bind(this));\r\n    this.animatationStart = performance.now();\r\n    this.animationLength = 500;\r\n    this.xAxis.draw();\r\n    this.yAxis.draw();\r\n    this.createTooltip();\r\n};\r\n\r\nTayberry.prototype.clear = function () {\r\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n};\r\n\r\nTayberry.prototype.drawTitle = function () {\r\n    if (this.options.title.text) {\r\n        const x = (this.canvas.width) / 2, y = 0;\r\n        this.ctx.save();\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = 'top';\r\n        this.ctx.font = this.titleFont;\r\n        this.ctx.fillStyle = this.options.font.colour;\r\n        this.ctx.fillText(this.options.title.text, x, y);\r\n        this.ctx.restore();\r\n    }\r\n};\r\n\r\nTayberry.prototype.drawLabel = function (sign, text, rect) {\r\n    const x = (rect.left + rect.right) / 2;\r\n    let y;\r\n    if (this.options.labels.verticalAlignment === 'top')\r\n        y = rect.top;\r\n    else if (this.options.labels.verticalAlignment === 'bottom')\r\n        y = rect.bottom;\r\n    else\r\n        y = (rect.top + rect.bottom) / 2;\r\n    if (this.plotArea.containsPoint(x, y)) {\r\n        this.ctx.save();\r\n        this.ctx.textAlign = 'center';\r\n        this.ctx.textBaseline = Tayberry.mapVerticalPosition(sign, this.options.labels.verticalPosition);\r\n        this.ctx.fillStyle = this.options.font.colour;\r\n        this.ctx.fillText(text, x, y);\r\n        this.ctx.restore();\r\n    }\r\n};\r\n\r\n\r\nTayberry.prototype.draw = function () {\r\n\r\n    this.ctx.save();\r\n    this.enumerateBars(function (bar) {\r\n        this.ctx.fillStyle = bar.selected ? bar.renderedSeries.highlightColour : bar.renderedSeries.colour;\r\n        this.ctx.fillRect(bar.rect.left, bar.rect.top, bar.rect.width, bar.rect.height);\r\n    }.bind(this));\r\n    this.ctx.restore();\r\n\r\n    if (this.options.labels.enabled) {\r\n        this.ctx.save();\r\n        this.enumerateBars(function (bar) {\r\n            this.drawLabel(bar.value, this.options.yAxis.labelFormatter(bar.value), bar.rect);\r\n        }.bind(this));\r\n        this.ctx.restore();\r\n    }\r\n};\r\n\r\nTayberry.prototype.drawLine = function (x1, y1, x2, y2, colour) {\r\n    this.ctx.save();\r\n    if (colour) {\r\n        this.ctx.strokeStyle = colour;\r\n    }\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(x1 + 0.5, y1 + 0.5);\r\n    this.ctx.lineTo(x2 + 0.5, y2 + 0.5);\r\n    this.ctx.stroke();\r\n    this.ctx.restore();\r\n};\r\n\r\nTayberry.prototype.redraw = function () {\r\n    this.clear();\r\n    this.drawTitle();\r\n    this.xAxis.draw();\r\n    this.yAxis.draw();\r\n    this.drawLegend();\r\n    this.draw();\r\n};\r\n\r\n\r\nTayberry.prototype.drawLegend = function () {\r\n    if (this.options.legend.enabled) {\r\n        let totalWidth = 0;\r\n        const indicatorSize = this.mapLogicalXUnit(this.options.legend.indicatorSize);\r\n        for (let index = 0; index < this.series.length; index++) {\r\n            const series = this.series[index];\r\n            if (series.name) {\r\n                totalWidth += this.getTextWidth(series.name) + indicatorSize + this.mapLogicalXUnit(this.options.elementSmallPadding + this.options.elementLargePadding);\r\n            }\r\n        }\r\n        let x = this.plotArea.left + this.plotArea.width / 2 - totalWidth / 2,\r\n            y = this.canvas.height - indicatorSize;\r\n\r\n        for (let index = 0; index < this.renderedSeries.length; index++) {\r\n            const series = this.renderedSeries[index];\r\n            if (series.name) {\r\n                this.ctx.fillStyle = series.colour;\r\n                this.ctx.fillRect(x, y, indicatorSize, indicatorSize);\r\n                this.ctx.textBaseline = 'middle';\r\n                this.ctx.fillStyle = this.options.font.colour;\r\n                x += indicatorSize + this.mapLogicalXUnit(this.options.elementSmallPadding);\r\n                this.ctx.fillText(series.name, x, y + indicatorSize / 2);\r\n                x += this.getTextWidth(series.name) + this.mapLogicalXUnit(this.options.elementLargePadding);\r\n            }\r\n        }\r\n    }\r\n};\r\n","'use strict';\r\nvar Rect = require('./rect').Rect;\r\nvar Easing = require('./easing.js');\r\nvar Utils = require('./utils.js');\r\n\r\nvar Tayberry = require('./tayberry.base.js').Tayberry;\r\n\r\nTayberry.prototype.onAnimate = function (timestamp) {\r\n    var elapsed, scaleFactor;\r\n    elapsed = timestamp - this.animatationStart;\r\n    scaleFactor = Math.min(Easing.inQuad(elapsed, this.animationLength), 1);\r\n    for (let categoryIndex = 0; categoryIndex < this.series[0].data.length; categoryIndex++) {\r\n        for (let seriesIndex = 0; seriesIndex < this.series.length; seriesIndex++) {\r\n            const value = this.series[seriesIndex].data[categoryIndex];\r\n            const yOrigin = this.yAxis.min <= 0 && 0 <= this.yAxis.max ? 0 : (this.yAxis.min > 0 ? this.yAxis.min : this.yAxis.max);\r\n            this.renderedSeries[seriesIndex].data[categoryIndex] = yOrigin + scaleFactor * ((value - yOrigin));\r\n        }\r\n    }\r\n    this.redraw();\r\n    if (scaleFactor < 1) {\r\n        this.animator = requestAnimationFrame(this.onAnimate.bind(this));\r\n    }\r\n};\r\n\r\nTayberry.prototype.onMouseLeave = function (event) {\r\n    if ((event.currentTarget == this.canvas && event.relatedTarget !== this.tooltipElement) || (event.currentTarget == this.tooltipElement && event.relatedTarget !== this.canvas)) {\r\n        this.selectedItem = {};\r\n        this.tooltipElement.style.display = 'none';\r\n        this.redraw();\r\n    }\r\n};\r\n\r\nTayberry.prototype.handleMouseMove = function (clientX, clientY) {\r\n    let boundingRect = new Rect(this.canvas.getBoundingClientRect());\r\n    let ret = false;\r\n    if (boundingRect.containsPoint(clientX, clientY)) {\r\n        let x = clientX - boundingRect.left;\r\n        let y = clientY - boundingRect.top;\r\n\r\n        let hitTestResult = this.hitTest(this.mapLogicalXUnit(x), this.mapLogicalYUnit(y));\r\n        if (hitTestResult.found) {\r\n            const aboveZero = hitTestResult.rect.top < hitTestResult.rect.bottom;\r\n            const category = this.xAxis.options.categories[hitTestResult.categoryIndex];\r\n            this.tooltipElement.style.display = 'block';\r\n            let tooltipHtml = Utils.formatString(this.options.tooltips.headerTemplate, {category: category}, true);\r\n            if (this.options.tooltips.shared) {\r\n                for (let index = 0; index<this.series.length; index++) {\r\n                    const series = this.series[index];\r\n                    const value = series.data[hitTestResult.categoryIndex];\r\n                    tooltipHtml += Utils.formatString(this.options.tooltips.valueTemplate, {value: this.options.yAxis.labelFormatter(value), name: series.name, colour: series.colour}, true);\r\n                }\r\n            } else {\r\n                const series = this.series[hitTestResult.seriesIndex];\r\n                const value = series.data[hitTestResult.categoryIndex];\r\n                tooltipHtml += Utils.formatString(this.options.tooltips.valueTemplate, {value: this.options.yAxis.labelFormatter(value), name: series.name, colour: series.colour}, true);\r\n            }\r\n            tooltipHtml += this.options.tooltips.footerTemplate;\r\n            this.tooltipElement.innerHTML = tooltipHtml;\r\n            let tooltipRect = this.tooltipElement.getBoundingClientRect();\r\n            this.tooltipElement.style.borderColor = this.renderedSeries[hitTestResult.seriesIndex].colour;\r\n            this.tooltipElement.style.left = window.pageXOffset + boundingRect.left + this.mapScreenUnit(hitTestResult.rect.width) / 2 + hitTestResult.rect.left / this.scaleFactor - tooltipRect.width / 2 + 'px';\r\n            this.tooltipElement.style.top = window.pageYOffset + boundingRect.top + this.mapScreenUnit(hitTestResult.rect.top) - tooltipRect.height * (aboveZero ? 1 : 0) - this.options.elementSmallPadding * (aboveZero ? 1 : -1) + 'px';\r\n            this.selectedItem = hitTestResult;\r\n            ret = true;\r\n        }\r\n    }\r\n    return ret;\r\n};\r\n\r\nTayberry.prototype.onTouchStart = function (event) {\r\n    for (let index = 0; index < event.targetTouches.length; index++) {\r\n        let touch = event.targetTouches[index];\r\n        if (this.handleMouseMove(touch.clientX, touch.clientY)) {\r\n            event.preventDefault();\r\n            this.redraw();\r\n            break;\r\n        }\r\n    }\r\n};\r\n\r\n\r\nTayberry.prototype.onMouseMove = function (event) {\r\n    let oldSelectedItem = Utils.assign({}, this.selectedItem);\r\n    if (!this.handleMouseMove(event.clientX, event.clientY)) {\r\n        this.selectedItem = {};\r\n    }\r\n\r\n    if (oldSelectedItem.categoryIndex !== this.selectedItem.categoryIndex || oldSelectedItem.seriesIndex !== this.selectedItem.seriesIndex) {\r\n        this.redraw();\r\n    }\r\n};\r\n\r\nTayberry.prototype.onWindowResize = function () {\r\n    this.tooltipElement.style.display = 'none';\r\n    this.initialise();\r\n    this.updateFonts();\r\n    this.calculatePlotArea();\r\n    this.redraw();\r\n};\r\n","(function () {\r\n    'use strict';\r\n    var Tayberry = require('./tayberry.base.js').Tayberry;\r\n    require('./tayberry.axes.js');\r\n    require('./tayberry.core.js');\r\n    require('./tayberry.drawing.js');\r\n    require('./tayberry.events.js');\r\n    require('./tayberry.defaults.js');\r\n    require('./tayberry.sizing.js');\r\n\r\n    module.exports = {\r\n        /**\r\n         * Creates a Tayberry chart\r\n         *\r\n         * @param element   ID of container div, or HTMLElement\r\n         * @param options   Options object\r\n         */\r\n        create: function (element, options) {\r\n            var chart = new Tayberry();\r\n            chart.create(element);\r\n            chart.setOptions(options);\r\n            chart.render();\r\n        }\r\n    };\r\n\r\n})();\r\n","'use strict';\r\nvar Rect = require('./rect').Rect;\r\nvar Utils = require('./utils');\r\n\r\nvar Tayberry = require('./tayberry.base.js').Tayberry;\r\n\r\nTayberry.mapVerticalPosition = function (sign, position) {\r\n    switch (position) {\r\n        case \"outside\":\r\n            return sign > 0 ? \"bottom\" : \"top\";\r\n        case \"inside\":\r\n            return sign > 0 ? \"top\" : \"bottom\";\r\n        default:\r\n            return \"middle\";\r\n    }\r\n};\r\n\r\nTayberry.prototype.mapLogicalXUnit = function (x) {\r\n    return this.scaleFactorX * x;\r\n};\r\n\r\nTayberry.prototype.mapLogicalYUnit = function (x) {\r\n    return this.scaleFactorY * x;\r\n};\r\n\r\nTayberry.prototype.mapScreenUnit = function (x) {\r\n    return x / this.scaleFactor;\r\n};\r\n\r\nTayberry.prototype.getTextWidth = function (text) {\r\n    return this.ctx.measureText(text).width;\r\n};\r\n\r\nTayberry.prototype.calculatePlotArea = function () {\r\n    const MAX_AXIS_CALC_SIZE_ATTEMPTS = 5;\r\n\r\n    this.plotArea = new Rect(0, 0, this.canvas.width, this.canvas.height);\r\n    if (this.options.title.text) {\r\n        this.plotArea.top += this.mapLogicalYUnit(this.options.elementSmallPadding + this.options.title.font.size);\r\n    }\r\n    if (this.options.legend.enabled)\r\n        this.plotArea.bottom -= this.mapLogicalYUnit(this.options.elementSmallPadding + this.options.elementLargePadding + this.options.legend.indicatorSize);\r\n\r\n    this.yAxis.adjustSize(this.plotArea, true, true);\r\n    this.xAxis.adjustSize(this.plotArea, true, true);\r\n\r\n    for (let i = 0; i < MAX_AXIS_CALC_SIZE_ATTEMPTS; i++) {\r\n        this.yAxis.calculateExtent();\r\n        this.updateYFormatter();\r\n        if (!this.yAxis.adjustSize(this.plotArea) && !this.xAxis.adjustSize(this.plotArea))\r\n            break;\r\n    }\r\n    this.plotArea.left = Math.ceil(this.plotArea.left);\r\n    this.plotArea.top = Math.ceil(this.plotArea.top);\r\n    this.plotArea.right = Math.floor(this.plotArea.right);\r\n    this.plotArea.bottom = Math.floor(this.plotArea.bottom);\r\n};\r\n\r\nTayberry.prototype.hitTest = function (x, y) {\r\n    // TODO: Optimise\r\n    let ret = {\r\n        found: false,\r\n        categoryIndex: undefined,\r\n        seriesIndex: undefined,\r\n        rect: undefined\r\n    };\r\n\r\n    let matches = [];\r\n\r\n    const isOverlaid = this.options.barMode === 'overlaid';\r\n\r\n    this.enumerateBars(function (bar) {\r\n        if (bar.rect.containsPoint(x, y)) {\r\n            matches.push({\r\n                categoryIndex: bar.categoryIndex,\r\n                seriesIndex: bar.seriesIndex,\r\n                rect: bar.rect\r\n            });\r\n            if (!isOverlaid)\r\n                return true;\r\n        }\r\n    }.bind(this));\r\n\r\n    if (matches.length) {\r\n        ret.found = true;\r\n        let minMatchIndex = 0, minHeight = matches[0].rect.height;\r\n        for (let index = 1; index < matches.length; index++) {\r\n            const match = matches[index];\r\n            if (match.rect.height < minHeight) {\r\n                minMatchIndex = index;\r\n                minHeight = match.rect.height;\r\n            }\r\n        }\r\n        ret = Utils.assign(ret, matches[minMatchIndex]);\r\n    }\r\n    return ret;\r\n};\r\n\r\nTayberry.prototype.enumerateBars = function (callback) {\r\n    const categoryCount = this.renderedSeries[0].data.length;\r\n    if (categoryCount) {\r\n        const isStacked = this.options.barMode === 'stacked';\r\n        const isOverlaid = this.options.barMode === 'overlaid';\r\n        const isHorizontal = this.options.barChart.orientation === 'horizontal';\r\n        let plotArea = this.plotArea.clone();\r\n        if (isHorizontal)\r\n            plotArea.swapXY();\r\n        const isNormal = !isStacked && !isOverlaid;\r\n        const barCount = (isStacked || isOverlaid) ? 1 : this.series.length;\r\n        const categoryWidth = (plotArea.width / categoryCount);\r\n        // const barWidth = (categoryWidth * (1 - this.options.categorySpacing) / barCount);\r\n        const yOrigin = this.yAxis.getOrigin();\r\n\r\n        for (let categoryIndex = 0; categoryIndex < categoryCount; categoryIndex++) {\r\n            let categoryXStart = plotArea.left + Math.floor(categoryIndex * categoryWidth);\r\n            let categoryXEnd = plotArea.left + Math.floor((categoryIndex + 1) * categoryWidth);\r\n            let barXStart = categoryXStart + Math.ceil(categoryWidth * this.options.categorySpacing / 2);\r\n            let barXEnd = categoryXEnd - Math.floor(categoryWidth * this.options.categorySpacing / 2);\r\n            let x = barXStart;\r\n            let yBottomPositive = yOrigin,\r\n                yBottomNegative = yOrigin,\r\n                yRunningTotalPositive = 0,\r\n                yRunningTotalNegative = 0;\r\n            let barIndex = 0;\r\n            for (let seriesIndex = 0; seriesIndex < this.renderedSeries.length; seriesIndex++) {\r\n                const value = this.renderedSeries[seriesIndex].data[categoryIndex];\r\n                const barWidth = Math.floor((barXEnd - barXStart) / barCount);\r\n                const xStart = Math.floor(barXStart + barIndex*barWidth);\r\n                const xEnd = Math.ceil(barXStart + (barIndex+1)*barWidth);\r\n                if (Utils.isMissingValue(value))\r\n                    continue;\r\n                const yTop = this.yAxis.getValueDisplacement(value + (value > 0 ? yRunningTotalPositive : yRunningTotalNegative));\r\n                let rect = new Rect(xStart, yTop, xEnd, value > 0 ? yBottomPositive : yBottomNegative);\r\n                rect.left += Math.ceil(this.options.barPadding * this.scaleFactor / 2);\r\n                rect.right -= Math.floor(this.options.barPadding * this.scaleFactor / 2);\r\n                if (rect.right < rect.left)\r\n                    rect.right = rect.left;\r\n                if (isHorizontal)\r\n                    rect.swapXY();\r\n                rect.clip(this.plotArea);\r\n\r\n                const stopEnumerating = callback({\r\n                    seriesIndex: seriesIndex,\r\n                    categoryIndex: categoryIndex,\r\n                    series: this.renderedSeries[seriesIndex],\r\n                    renderedSeries: this.renderedSeries[seriesIndex],\r\n                    value: this.series[seriesIndex].data[categoryIndex],\r\n                    renderedValue: this.renderedSeries[seriesIndex].data[categoryIndex],\r\n                    rect: rect,\r\n                    selected: this.selectedItem.categoryIndex === categoryIndex && this.selectedItem.seriesIndex === seriesIndex\r\n                });\r\n                if (stopEnumerating)\r\n                    break;\r\n                if (isStacked) {\r\n                    if (value > 0) {\r\n                        yRunningTotalPositive += value;\r\n                        yBottomPositive = yTop;\r\n                    }\r\n                    else {\r\n                        yRunningTotalNegative += value;\r\n                        yBottomNegative = yTop;\r\n                    }\r\n                } else if (isNormal) {\r\n                    // x += barWidth;\r\n                    barIndex++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n","(function () {\r\n    \"use strict\";\r\n\r\n    exports.identity = function (obj) {\r\n        return obj;\r\n    };\r\n\r\n    exports.isMissingValue = function (n) {\r\n        return n === null || typeof n === 'undefined' || (isNaN(n) && typeof n === 'number');\r\n    };\r\n\r\n    exports.reduce = function (array, func, getter, ignoreMissing = false) {\r\n        var ret, i;\r\n        if (array.reduce && !getter && !ignoreMissing) {\r\n            ret = array.reduce(function (a, b) {\r\n                return func(a, b);\r\n            });\r\n        } else {\r\n            getter = getter || exports.identity;\r\n            if (array.length) {\r\n                ret = getter(array[0]);\r\n                for (i = 1; i < array.length; i++) {\r\n                    const value = getter(array[i]);\r\n                    if (!ignoreMissing || !exports.isMissingValue(value))\r\n                        ret = func(ret, value);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    };\r\n\r\n    exports.sign = Math.sign || function (n) {\r\n            return n > 0 ? 1 : (n < 0 ? -1 : 0);\r\n        };\r\n\r\n    exports.now = (typeof performance !== 'undefined' && typeof performance.now !== 'undefined') ? performance.now : function () {\r\n        return new Date().getTime();\r\n    };\r\n\r\n    var innerAssign = function (deepAssign, targetObject, sourceObjects) {\r\n        if (!Array.isArray(sourceObjects))\r\n            sourceObjects = [sourceObjects];\r\n        if (!deepAssign && Object.assign) {\r\n            return Object.assign.apply(Object, [targetObject].concat(sourceObjects));\r\n        } else {\r\n            if (targetObject === undefined || targetObject === null) {\r\n                throw new TypeError('Cannot convert first argument to object');\r\n            }\r\n\r\n            var to = Object(targetObject);\r\n            for (let i = 0; i < sourceObjects.length; i++) {\r\n                let currentSourceObject = sourceObjects[i];\r\n                if (currentSourceObject === undefined || currentSourceObject === null) {\r\n                    continue;\r\n                }\r\n                currentSourceObject = Object(currentSourceObject);\r\n\r\n                const keysArray = Object.keys(currentSourceObject);\r\n                for (let nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\r\n                    const nextKey = keysArray[nextIndex];\r\n                    const nextValue = currentSourceObject[nextKey];\r\n                    const desc = Object.getOwnPropertyDescriptor(currentSourceObject, nextKey);\r\n                    if (desc !== undefined && desc.enumerable) {\r\n                        if (deepAssign && typeof to[nextKey] === \"object\" && !Array.isArray(nextValue) && typeof nextValue === 'object')\r\n                            innerAssign(true, to[nextKey], nextValue);\r\n                        else\r\n                            to[nextKey] = nextValue;\r\n                    }\r\n                }\r\n            }\r\n            return to;\r\n        }\r\n    };\r\n\r\n    exports.assign = function (targetObject, sourceObjects) {\r\n        return innerAssign(false, targetObject, sourceObjects);\r\n    };\r\n\r\n    exports.deepAssign = function (targetObject, sourceObjects) {\r\n        return innerAssign(true, targetObject, sourceObjects);\r\n    };\r\n\r\n    exports.formatString = function (formatString, formatValues, escapeAsHtml) {\r\n        return formatString.replace(/{(\\w+)}/g, function (match, placeholder) {\r\n            const value = formatValues[placeholder];\r\n            return typeof value !== 'undefined' ? (escapeAsHtml ? exports.stringToHtml(value) : value) : match;\r\n        });\r\n    };\r\n\r\n    exports.locateDecimalPoint = function (number) {\r\n        return Math.floor(Math.log(number) / Math.log(10));\r\n    };\r\n\r\n    exports.formatNumberThousands = function (number, decimalPlaces = 0) {\r\n        var parts = number.toFixed(decimalPlaces).split(\".\");\r\n        parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n        return parts.join(\".\");\r\n    };\r\n\r\n    exports.createAutoNumberFormatter = function (scale, prefix = '', suffix = '', precision = 2) {\r\n        let decimalPlaces = exports.locateDecimalPoint(scale);\r\n        decimalPlaces = decimalPlaces < 0 ? -decimalPlaces + precision - 1 : 0;\r\n        return x => prefix + exports.formatNumberThousands(x, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.createFixedNumberFormatter = function (scale, prefix = '', suffix = '', decimalPlaces = 2) {\r\n        return x => prefix + exports.formatNumberThousands(x, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.createPercentageFormatter = function (scale, prefix = '', suffix = '%', precision = 2) {\r\n        let decimalPlaces = exports.locateDecimalPoint(scale * 100);\r\n        decimalPlaces = decimalPlaces < 0 ? -decimalPlaces + precision - 1 : 0;\r\n        return x => prefix + exports.formatNumberThousands(x * 100, decimalPlaces) + suffix;\r\n    };\r\n\r\n    exports.stringToHtml = function (str) {\r\n        var div = document.createElement('div');\r\n        div.appendChild(document.createTextNode(str));\r\n        return div.innerHTML;\r\n    };\r\n\r\n    exports.throttle = function (fn, threshold) {\r\n        var last,\r\n            deferTimer;\r\n        return function () {\r\n            var context = this;\r\n\r\n            var now = Date.now(),\r\n                args = arguments;\r\n            if (last && now < last + threshold) {\r\n                clearTimeout(deferTimer);\r\n                deferTimer = setTimeout(function () {\r\n                    last = now;\r\n                    fn.apply(context, args);\r\n                }, threshold);\r\n            } else {\r\n                last = now;\r\n                fn.apply(context, args);\r\n            }\r\n        };\r\n    }\r\n\r\n})();\r\n"],"sourceRoot":"/source/"}