!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Tayberry=t()}}(function(){return function t(e,i,s){function n(o,a){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[o]={exports:{}};e[o][0].call(c.exports,function(t){var i=e[o][1][t];return n(i?i:t)},c,c.exports,t,e,i,s)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=t("./utils.js"),o=function(){function t(){if(s(this,t),1===arguments.length){var e=arguments[0];"string"==typeof e?this.parseString(e):(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}}return n(t,[{key:"parseString",value:function(t){var e=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,i=/^rgba?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*([0-9]*\.?[0-9]+))+\)$/i,s=e.exec(t),n=i.exec(t);if(s){var r=function(t){var e=parseInt(t,16);return e=16*e+e};this.r=s[1]?parseInt(s[1],16):r(s[4]),this.g=s[2]?parseInt(s[2],16):r(s[5]),this.b=s[3]?parseInt(s[3],16):r(s[6]),this.a=null}else n?(this.r=parseInt(n[1]),this.g=parseInt(n[2]),this.b=parseInt(n[3]),this.a=n[5]?parseFloat(n[5]):null):(this.r=null,this.g=null,this.b=null,this.a=null);return this}},{key:"clipComponent",value:function(t){return this[t]=Math.round(this[t]),this[t]=Math.min(this[t],255),this[t]=Math.max(this[t],0),this}},{key:"clip",value:function(){return this.clipComponent("r"),this.clipComponent("g"),this.clipComponent("b"),this}},{key:"multiplyBy",value:function(t){return this.r*=t,this.g*=t,this.b*=t,this.clip(),this}},{key:"increaseBy",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this.clip(),this}},{key:"toString",value:function(){var t;return t=this.a?r.formatString("rgba({r},{g},{b},{a})",this):r.formatString("rgb({r},{g},{b})",this)}},{key:"sum",get:function(){return this.r+this.g+this.b}}],[{key:"multiplyBy",value:function(e,i){return new t(e).multiplyBy(i).toString()}}]),t}();i.Colour=o},{"./utils.js":12}],2:[function(t,e,i){"use strict";i.linear=function(t,e){return t/e},i.linear=function(t,e){return t/e},i.inQuad=function(t,e){var i=t/e;return i*i},i.outQuad=function(t,e){var i=t/e;return i*(2-i)}},{}],3:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=function(){function t(){s(this,t);var e;1===arguments.length?(e=arguments[0],this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom):4===arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.right=arguments[2],this.bottom=arguments[3])}return n(t,[{key:"containsPoint",value:function(t,e){return this.containsX(t)&&this.containsY(e)}},{key:"containsY",value:function(t){return t>=this.minY&&t<this.maxY}},{key:"containsX",value:function(t){return t>=this.minX&&t<this.maxX}},{key:"clip",value:function(t){return this.left<t.minX?this.left=t.minX:this.left>t.maxX&&(this.left=t.maxX),this.right<t.minX?this.right=t.minX:this.right>t.maxX&&(this.right=t.maxX),this.top<t.minY?this.top=t.minY:this.top>t.maxY&&(this.top=t.maxY),this.bottom>t.maxY?this.bottom=t.maxY:this.bottom<t.minY&&(this.bottom=t.minY),this}},{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"maxY",get:function(){return Math.max(this.bottom,this.top)}},{key:"minY",get:function(){return Math.min(this.bottom,this.top)}},{key:"minX",get:function(){return Math.min(this.left,this.right)}},{key:"maxX",get:function(){return Math.max(this.left,this.right)}}]),t}();i.Rect=r},{}],4:[function(t,e,i){"use strict";var s=function(){function t(t,e){var i=[],s=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){n=!0,r=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(n)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=(t("./utils.js"),t("./tayberry.base.js").Tayberry);n.prototype.calculateYAxisExtent=function(){var t,e,i,n=this.options.yAxis.min,r=this.options.yAxis.max,o="undefined"!=typeof n,a="undefined"!=typeof r;if(!o||!a){var l=this.calculateYDataMinMax(),h=s(l,2),c=h[0],u=h[1],p=u-c;o||(n=c-.1*p,c>=0&&0>n&&(n=0)),a||(r=u+.1*p,0>=u&&n>0&&(r=0))}var d=r-n;t=this.plotArea.height/this.mapLogicalYUnit(this.options.yAxis.tickStep),e=d/t,i=Math.pow(10,Math.floor(Math.log(e)/Math.log(10))),this.yTickStep=Math.ceil(e/i)*i,this.yMin=n,this.yMax=r,o||(this.yMin=Math.floor(this.yMin/i)*i),a||(this.yMax=Math.ceil(this.yMax/i)*i),this.yTickStart=Math.floor(this.yMin/this.yTickStep)*this.yTickStep,this.yTickEnd=Math.ceil(this.yMax/this.yTickStep)*this.yTickStep},n.prototype.drawXAxis=function(){var t,e,i,s,n,r=this.categories.length;e=Math.floor(this.plotArea.width/this.series[0].data.length),this.ctx.save(),this.ctx.fillStyle=this.options.font.colour,this.ctx.textAlign="center",this.ctx.textBaseline="bottom";var o=void 0;switch(this.options.xAxis.labelPosition){case"left":o=0;break;case"right":o=0;break;default:o=.5}for(t=0;r>t;t++){i=this.plotArea.left+Math.floor(t*e+e*o),s=this.plotArea.bottom+this.mapLogicalYUnit(this.options.font.size+this.options.elementSmallPadding);var a=this.getTextWidth(this.categories[t]),l=i-a/2,h=i+a/2;("undefined"==typeof n||l>n+1)&&(this.ctx.fillText(this.categories[t],i,s),n=h)}i=this.plotArea.left+this.plotArea.width/2,s=this.plotArea.bottom+this.mapLogicalYUnit(2*this.options.font.size+this.options.elementSmallPadding+this.options.elementLargePadding),this.ctx.fillText(this.options.xAxis.title,i,s),this.ctx.restore()},n.prototype.drawYAxis=function(){var t,e,i,s=this.getYOrigin();for(this.ctx.save(),this.ctx.fillStyle=this.options.font.colour,this.ctx.textAlign="right",this.ctx.textBaseline="middle",t=this.yTickStart;t<=this.yTickEnd&&this.yTickStep;){t=this.yTickStart+Math.round((t+this.yTickStep-this.yTickStart)/this.yTickStep)*this.yTickStep,e=this.plotArea.left-this.mapLogicalXUnit(this.options.elementSmallPadding);var n=this.getYHeight(t);i=s-n,this.plotArea.containsY(i)&&(this.ctx.fillText(this.options.yAxis.labelFormatter(t),e,i),this.drawLine(this.plotArea.left,i,this.plotArea.right,i,this.options.yAxis.gridLines.colour))}e=0,i=this.plotArea.top+this.plotArea.height/2,this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.translate(e,i),this.ctx.rotate(-Math.PI/2),this.ctx.fillText(this.options.yAxis.title,0,0),this.ctx.restore()}},{"./tayberry.base.js":5,"./utils.js":12}],5:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=function(){function t(){s(this,t),this.selectedItem={},this.containerElement=null,this.canvas=null,this.ctx=null,this.renderedSeries=null,this.options=null,this.scaleFactor=null,this.titleFont=null,this.plotArea=null,this.yTickStep=null,this.yTickStart=null,this.yTickEnd=null,this.yMin=null,this.yMax=null,this.series=[],this.categories=[]}return n(t,[{key:"seriesCount",get:function(){return this.series.length}},{key:"categoryCount",get:function(){return this.series.length?this.series[0].data.length:0}}]),t}();i.Tayberry=r},{}],6:[function(t,e,i){"use strict";var s=t("./colour").Colour,n=t("./utils.js"),r=t("./tayberry.base.js").Tayberry;r.prototype.create=function(t){"string"==typeof t?this.containerElement=document.getElementById(t):this.containerElement=t,this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.containerElement.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.renderedSeries=null,this.options={},this.initialise()},r.prototype.initialise=function(){this.scaleFactor=window.devicePixelRatio||1,this.canvas.width=Math.round(this.containerElement.clientWidth*this.scaleFactor),this.canvas.height=Math.round(this.containerElement.clientHeight*this.scaleFactor),this.scaleFactorX=this.canvas.width/this.containerElement.clientWidth,this.scaleFactorY=this.canvas.height/this.containerElement.clientHeight,this.selectedItem={},this.plotArea=null},r.prototype.updateFonts=function(){this.ctx.font=this.mapLogicalYUnit(this.options.font.size)+"px "+this.options.font.face,this.titleFont=this.mapLogicalYUnit(this.options.title.font.size)+"px "+this.options.font.face},r.prototype.updateYFormatter=function(){this.options.yAxis.labelFormatter||("percentage"===this.options.yAxis.labelFormat?this.options.yAxis.labelFormatter=n.createPercentageFormatter(this.yMax-this.yMin,this.options.yAxis.labelPrefix,this.options.yAxis.labelSuffix):"currency"===this.options.yAxis.labelFormat?this.options.yAxis.labelFormatter=n.createFixedNumberFormatter(this.yMax-this.yMin,this.options.yAxis.labelPrefix||this.options.yAxis.currencySymbol,this.options.yAxis.labelSuffix):this.options.yAxis.labelFormatter=n.createAutoNumberFormatter(this.yMax-this.yMin,this.options.yAxis.labelPrefix,this.options.yAxis.labelSuffix))},r.prototype.setOptions=function(t){var e=[this.defaultOptions()];if(t.presets)for(var i=0;i<t.presets.length;i++)e.push(r.presets[t.presets[i]]);e.push(t),this.options=n.deepAssign({},e),this.setSeries(t.series),this.setCategories(t.xAxis.categories),this.updateFonts(),this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this)),this.canvas.addEventListener("mouseleave",this.onMouseLeave.bind(this)),this.canvas.addEventListener("touchstart",this.onTouchStart.bind(this)),window.addEventListener("resize",n.throttle(this.onWindowResize,50).bind(this))},r.calculateHighlightColour=function(t){var e=new s(t);return e.increaseBy(30*(e.sum>=540?-1:1)).toString()},r.prototype.setSeries=function(t){var e;for(Array.isArray(t)?this.series=t:this.series=[t],this.renderedSeries=t.slice(0),e=0;e<this.renderedSeries.length;e++){var i=this.series[e];i.colour=i.colour||this.options.defaultPalette[e],i.highlightColour=i.highlightColour||r.calculateHighlightColour(i.colour);var s=n.assign({},i);s.data=this.renderedSeries[e].data.slice(0),this.renderedSeries[e]=s}},r.prototype.setCategories=function(t){this.categories=t},r.prototype.calculateYDataMinMax=function(){var t,e,i,s,r=[],o=[],a=[],l=[];if(this.series[0].data.length){for(t=0;t<this.series[0].data.length;t++)for(r[t]=0,o[t]=0,e=0;e<this.series.length;e++){var h=this.series[e].data[t];n.isMissingValue(h)||(0>h?o[t]+=h:r[t]+=h)}for(var c=0;c<this.series.length;c++){var u=this.series[c];a.push(n.reduce(u.data,Math.min,void 0,!0)),l.push(n.reduce(u.data,Math.max,void 0,!0))}"stacked"===this.options.barMode?(i=Math.min(0,n.reduce(o,Math.min,void 0,!0)),s=Math.max(n.reduce(r,Math.max,void 0,!0),0)):(i=n.reduce(a,Math.min,void 0,!0),s=n.reduce(l,Math.max,void 0,!0))}return[i,s]},r.prototype.createTooltip=function(){this.tooltipElement=document.createElement("div"),this.tooltipElement.className="tayberry-tooltip",this.tooltipElement.style.position="absolute",this.tooltipElement.style.left="0px",this.tooltipElement.style.top="0px",this.tooltipElement.style.zIndex="99999",this.tooltipElement.style.font=this.options.font.size+"px "+this.options.font.face,this.tooltipElement.style.borderRadius="3px",this.tooltipElement.style.backgroundColor="white",this.tooltipElement.style.border="2px solid black",this.tooltipElement.style.padding="0.15em 0.4em",this.tooltipElement.style.display="none",this.tooltipElement.innerHTML="",document.body.appendChild(this.tooltipElement),this.tooltipElement.addEventListener("mousemove",this.onMouseMove.bind(this)),this.tooltipElement.addEventListener("mouseleave",this.onMouseLeave.bind(this))}},{"./colour":1,"./tayberry.base.js":5,"./utils.js":12}],7:[function(t,e,i){"use strict";var s=t("./tayberry.base.js").Tayberry;s.prototype.defaultOptions=function(){return{defaultPalette:["#6FE87B","#FFAB51","#51A8FF","#B651FF","#FF6051","#636363"],title:{text:"",font:{size:20}},font:{colour:"#444",size:12,face:"sans-serif"},xAxis:{title:"",type:"category",min:0,max:100,step:1,categories:[],labelPosition:"middle"},yAxis:{title:"",gridLines:{colour:"#ccc"},min:void 0,max:void 0,tickStep:30,labelFormat:"number",labelFormatter:void 0,labelPrefix:void 0,labelSuffix:void 0,currencySymbol:"£"},series:[],barMode:"normal",barPadding:2,elementSmallPadding:5,elementLargePadding:10,categorySpacing:.3,presets:[],tooltips:{shared:!1,headerTemplate:"<strong>{category}</strong><table>",valueTemplate:'<tr><td style="padding-right: 0.5em"><span style="color: {colour}">●</span> {name}</td><td style="text-align: right">{value}</td></tr>',footerTemplate:"</table>"},legend:{enabled:!0,indicatorSize:15},labels:{enabled:!1,verticalAlignment:"top",verticalPosition:"outside"}}},s.presets={histogram:{xAxis:{labelPosition:"left"},barMode:"overlaid",categorySpacing:0,barPadding:1}}},{"./tayberry.base.js":5}],8:[function(t,e,i){"use strict";var s=t("./tayberry.base.js").Tayberry;s.prototype.render=function(){this.calculatePlotArea(),this.calculateYAxisExtent(),this.updateYFormatter(),this.finalisePlotArea(),this.animator=requestAnimationFrame(this.onAnimate.bind(this)),this.animatationStart=performance.now(),this.animationLength=500,this.drawXAxis(),this.drawYAxis(),this.createTooltip()},s.prototype.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},s.prototype.drawTitle=function(){if(this.options.title.text){var t=this.canvas.width/2,e=0;this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.font=this.titleFont,this.ctx.fillStyle=this.options.font.colour,this.ctx.fillText(this.options.title.text,t,e),this.ctx.restore()}},s.prototype.drawLabel=function(t,e,i){var n=(i.left+i.right)/2,r=void 0;r="top"===this.options.labels.verticalAlignment?i.top:"bottom"===this.options.labels.verticalAlignment?i.bottom:(i.top+i.bottom)/2,this.plotArea.containsPoint(n,r)&&(this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline=s.mapVerticalPosition(t,this.options.labels.verticalPosition),this.ctx.fillStyle=this.options.font.colour,this.ctx.fillText(e,n,r),this.ctx.restore())},s.prototype.draw=function(){this.ctx.save(),this.enumerateBars(function(t){this.ctx.fillStyle=t.selected?t.renderedSeries.highlightColour:t.renderedSeries.colour,this.ctx.fillRect(t.rect.left,t.rect.top,t.rect.width,t.rect.height)}.bind(this)),this.ctx.restore(),this.options.labels.enabled&&(this.ctx.save(),this.enumerateBars(function(t){this.drawLabel(t.value,this.options.yAxis.labelFormatter(t.value),t.rect)}.bind(this)),this.ctx.restore())},s.prototype.drawLine=function(t,e,i,s,n){this.ctx.save(),n&&(this.ctx.strokeStyle=n),this.ctx.beginPath(),this.ctx.moveTo(t+.5,e+.5),this.ctx.lineTo(i+.5,s+.5),this.ctx.stroke(),this.ctx.restore()},s.prototype.redraw=function(){this.clear(),this.drawTitle(),this.drawXAxis(),this.drawYAxis(),this.drawLegend(),this.draw()},s.prototype.drawLegend=function(){if(this.options.legend.enabled){for(var t=0,e=this.mapLogicalXUnit(this.options.legend.indicatorSize),i=0;i<this.series.length;i++){var s=this.series[i];s.name&&(t+=this.getTextWidth(s.name)+e+this.mapLogicalXUnit(this.options.elementSmallPadding+this.options.elementLargePadding))}for(var n=this.plotArea.left+this.plotArea.width/2-t/2,r=this.canvas.height-e,i=0;i<this.renderedSeries.length;i++){var s=this.renderedSeries[i];s.name&&(this.ctx.fillStyle=s.colour,this.ctx.fillRect(n,r,e,e),this.ctx.textBaseline="middle",this.ctx.fillStyle=this.options.font.colour,n+=e+this.mapLogicalXUnit(this.options.elementSmallPadding),this.ctx.fillText(s.name,n,r+e/2),n+=this.getTextWidth(s.name)+this.mapLogicalXUnit(this.options.elementLargePadding))}}}},{"./tayberry.base.js":5}],9:[function(t,e,i){"use strict";var s=t("./rect").Rect,n=t("./easing.js"),r=t("./utils.js"),o=t("./tayberry.base.js").Tayberry;o.prototype.onAnimate=function(t){var e,i;e=t-this.animatationStart,i=Math.min(n.inQuad(e,this.animationLength),1);for(var s=0;s<this.series[0].data.length;s++)for(var r=0;r<this.series.length;r++){var o=this.series[r].data[s],a=this.yMin<=0&&0<=this.yMax?0:this.yMin>0?this.yMin:this.yMax;this.renderedSeries[r].data[s]=a+i*(o-a)}this.redraw(),1>i&&(this.animator=requestAnimationFrame(this.onAnimate.bind(this)))},o.prototype.onMouseLeave=function(t){(t.currentTarget==this.canvas&&t.relatedTarget!==this.tooltipElement||t.currentTarget==this.tooltipElement&&t.relatedTarget!==this.canvas)&&(this.selectedItem={},this.tooltipElement.style.display="none",this.redraw())},o.prototype.handleMouseMove=function(t,e){var i=new s(this.canvas.getBoundingClientRect()),n=!1;if(i.containsPoint(t,e)){var o=t-i.left,a=e-i.top,l=this.hitTest(this.mapLogicalXUnit(o),this.mapLogicalYUnit(a));if(l.found){var h=l.rect.top<l.rect.bottom,c=this.categories[l.categoryIndex];this.tooltipElement.style.display="block";var u=r.formatString(this.options.tooltips.headerTemplate,{category:c},!0);if(this.options.tooltips.shared)for(var p=0;p<this.series.length;p++){var d=this.series[p],f=d.data[l.categoryIndex];u+=r.formatString(this.options.tooltips.valueTemplate,{value:this.options.yAxis.labelFormatter(f),name:d.name,colour:d.colour},!0)}else{var d=this.series[l.seriesIndex],f=d.data[l.categoryIndex];u+=r.formatString(this.options.tooltips.valueTemplate,{value:this.options.yAxis.labelFormatter(f),name:d.name,colour:d.colour},!0)}u+=this.options.tooltips.footerTemplate,this.tooltipElement.innerHTML=u;var m=this.tooltipElement.getBoundingClientRect();this.tooltipElement.style.borderColor=this.renderedSeries[l.seriesIndex].colour,this.tooltipElement.style.left=window.pageXOffset+i.left+this.mapScreenUnit(l.rect.width)/2+l.rect.left/this.scaleFactor-m.width/2+"px",this.tooltipElement.style.top=window.pageYOffset+i.top+this.mapScreenUnit(l.rect.top)-m.height*(h?1:0)-this.options.elementSmallPadding*(h?1:-1)+"px",this.selectedItem=l,n=!0}}return n},o.prototype.onTouchStart=function(t){for(var e=0;e<t.targetTouches.length;e++){var i=t.targetTouches[e];if(this.handleMouseMove(i.clientX,i.clientY)){t.preventDefault(),this.redraw();break}}},o.prototype.onMouseMove=function(t){var e=r.assign({},this.selectedItem);this.handleMouseMove(t.clientX,t.clientY)||(this.selectedItem={}),(e.categoryIndex!==this.selectedItem.categoryIndex||e.seriesIndex!==this.selectedItem.seriesIndex)&&this.redraw()},o.prototype.onWindowResize=function(t){this.tooltipElement.style.display="none",this.initialise(),this.updateFonts(),this.calculatePlotArea(),this.calculateYAxisExtent(),this.finalisePlotArea(),this.redraw()}},{"./easing.js":2,"./rect":3,"./tayberry.base.js":5,"./utils.js":12}],10:[function(t,e,i){"use strict";!function(){var i=t("./tayberry.base.js").Tayberry;t("./tayberry.axes.js"),t("./tayberry.core.js"),t("./tayberry.drawing.js"),t("./tayberry.events.js"),t("./tayberry.defaults.js"),t("./tayberry.sizing.js"),e.exports={create:function(t,e){var s=new i;s.create(t),s.setOptions(e),s.render()}}}()},{"./tayberry.axes.js":4,"./tayberry.base.js":5,"./tayberry.core.js":6,"./tayberry.defaults.js":7,"./tayberry.drawing.js":8,"./tayberry.events.js":9,"./tayberry.sizing.js":11}],11:[function(t,e,i){"use strict";var s=t("./rect").Rect,n=t("./utils"),r=t("./tayberry.base.js").Tayberry;r.mapVerticalPosition=function(t,e){switch(e){case"outside":return t>0?"bottom":"top";case"inside":return t>0?"top":"bottom";default:return"middle"}},r.prototype.mapLogicalXUnit=function(t){return this.scaleFactorX*t},r.prototype.mapLogicalYUnit=function(t){return this.scaleFactorY*t},r.prototype.mapScreenUnit=function(t){return t/this.scaleFactor},r.prototype.getTextWidth=function(t){return this.ctx.measureText(t).width},r.prototype.calculatePlotArea=function(){this.plotArea=new s(0,0,this.canvas.width,this.canvas.height),this.options.title.text&&(this.plotArea.top+=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.title.font.size)),this.options.yAxis.title&&(this.plotArea.left+=this.mapLogicalXUnit(this.options.elementLargePadding+this.options.font.size)),this.options.xAxis.title&&(this.plotArea.bottom-=this.mapLogicalYUnit(this.options.elementLargePadding+this.options.font.size)),this.plotArea.bottom-=this.mapLogicalYUnit(this.options.font.size),this.options.legend.enabled&&(this.plotArea.bottom-=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.elementLargePadding+this.options.legend.indicatorSize))},r.prototype.finalisePlotArea=function(){this.plotArea.left+=Math.max(this.getTextWidth(this.options.yAxis.labelFormatter(this.yTickStart)),this.getTextWidth(this.options.yAxis.labelFormatter(this.yTickEnd)))+this.mapLogicalXUnit(this.options.elementSmallPadding),this.plotArea.left=Math.floor(this.plotArea.left),this.plotArea.top=Math.floor(this.plotArea.top),this.plotArea.right=Math.ceil(this.plotArea.right),this.plotArea.bottom=Math.ceil(this.plotArea.bottom)},r.prototype.getYHeight=function(t){return Math.round(t*this.plotArea.height/(this.yMax-this.yMin))},r.prototype.hitTest=function(t,e){var i={found:!1,categoryIndex:void 0,seriesIndex:void 0,rect:void 0},s=[],r="overlaid"===this.options.barMode;if(this.enumerateBars(function(i){return i.rect.containsPoint(t,e)&&(s.push({categoryIndex:i.categoryIndex,seriesIndex:i.seriesIndex,rect:i.rect}),!r)?!0:void 0}.bind(this)),s.length){i.found=!0;for(var o=0,a=s[0].rect.height,l=1;l<s.length;l++){var h=s[l];h.rect.height<a&&(o=l,a=h.rect.height)}i=n.assign(i,s[o])}return i},r.prototype.getYOrigin=function(){return this.plotArea.bottom-this.getYHeight(0-this.yMin)},r.prototype.enumerateBars=function(t){var e=this.renderedSeries[0].data.length;if(e)for(var i="stacked"===this.options.barMode,r="overlaid"===this.options.barMode,o=!i&&!r,a=i||r?1:this.series.length,l=Math.floor(this.plotArea.width/e),h=Math.floor(l*(1-this.options.categorySpacing)/a),c=this.getYOrigin(),u=0;e>u;u++)for(var p=this.plotArea.left+Math.floor(u*l+l*this.options.categorySpacing/2),d=h,f=c,m=c,g=0,y=0,x=0;x<this.renderedSeries.length;x++){var v=this.renderedSeries[x].data[u];if(!n.isMissingValue(v)){var b=c-this.getYHeight(v+(v>0?g:y)),A=new s(p,b,p+d,v>0?f:m);A.left+=Math.ceil(this.options.barPadding*this.scaleFactor/2),A.right-=Math.floor(this.options.barPadding*this.scaleFactor/2),A.right<A.left&&(A.right=A.left),A.clip(this.plotArea);var M=t({seriesIndex:x,categoryIndex:u,series:this.renderedSeries[x],renderedSeries:this.renderedSeries[x],value:this.series[x].data[u],renderedValue:this.renderedSeries[x].data[u],rect:A,selected:this.selectedItem.categoryIndex===u&&this.selectedItem.seriesIndex===x});if(M)break;i?v>0?(g+=v,f=b):(y+=v,m=b):o&&(p+=h)}}}},{"./rect":3,"./tayberry.base.js":5,"./utils":12}],12:[function(t,e,i){"use strict";!function(){i.identity=function(t){return t},i.isMissingValue=function(t){return null===t||"undefined"==typeof t||isNaN(t)&&"number"==typeof t},i.reduce=function(t,e,s){var n,r,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(!t.reduce||s||o){if(s=s||i.identity,t.length)for(n=s(t[0]),r=1;r<t.length;r++){var a=s(t[r]);o&&i.isMissingValue(a)||(n=e(n,a))}}else n=t.reduce(function(t,i){return e(t,i)});return n},i.sign=Math.sign||function(t){return t>0?1:0>t?-1:0},i.now="undefined"!=typeof performance&&"undefined"!=typeof performance.now?performance.now:function(){return(new Date).getTime()};var t=function e(t,i,s){if(Array.isArray(s)||(s=[s]),!t&&Object.assign)return Object.assign.apply(Object,[i].concat(s));if(void 0===i||null===i)throw new TypeError("Cannot convert first argument to object");for(var n=Object(i),r=0;r<s.length;r++){var o=s[r];if(void 0!==o&&null!==o){o=Object(o);for(var a=Object.keys(o),l=0,h=a.length;h>l;l++){var c=a[l],u=o[c],p=Object.getOwnPropertyDescriptor(o,c);void 0!==p&&p.enumerable&&(t&&"object"==typeof n[c]&&!Array.isArray(u)&&"object"==typeof u?e(!0,n[c],u):n[c]=u)}}}return n};i.assign=function(e,i){return t(!1,e,i)},i.deepAssign=function(e,i){return t(!0,e,i)},i.formatString=function(t,e,s){return t.replace(/{(\w+)}/g,function(t,n){var r=e[n];return"undefined"!=typeof r?s?i.stringToHtml(r):r:t})},i.locateDecimalPoint=function(t){return Math.floor(Math.log(t)/Math.log(10))},i.formatNumberThousands=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=t.toFixed(e).split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")},i.createAutoNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(t);return r=0>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(t,r)+s}},i.createFixedNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3];return function(t){return e+i.formatNumberThousands(t,n)+s}},i.createPercentageFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"%":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(100*t);return r=0>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(100*t,r)+s}},i.stringToHtml=function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML},i.throttle=function(t,e){var i,s;return function(){var n=this,r=Date.now(),o=arguments;i&&i+e>r?(clearTimeout(s),s=setTimeout(function(){i=r,t.apply(n,o)},e)):(i=r,t.apply(n,o))}}}()},{}]},{},[10])(10)});
//# sourceMappingURL=tayberry.min.js.map