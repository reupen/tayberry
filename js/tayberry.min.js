!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.Tayberry=t()}}(function(){return function t(e,i,s){function n(o,a){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return n(i?i:t)},u,u.exports,t,e,i,s)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,e,i){"use strict";function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){var i=[],s=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);s=!0);}catch(l){n=!0,r=l}finally{try{!s&&a["return"]&&a["return"]()}finally{if(n)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),l=t("./helpers/utils.js"),h=function(){function t(e,i,s,n,o){r(this,t),this.tayberry=e,this.options=s,this.axisType=n,this.isHorizontal=o,this.index=i,this.tickStep=null,this.min=null,this.max=null,this.tickStart=null,this.tickEnd=null,this.calculatedSize=0,this.topAdjustment=0,this.rightAdjustment=0,this.titleFont=null,this.labelFont=null,this.numLabelLines=1,this.setPlacement()}return a(t,null,[{key:"create",value:function(t,e,i,s,n){var r="x"===s&&!n||"y"===s&&n;return"linear"===e.type?new c(t,i,e,s,r):new u(t,i,e,s,r)}}]),a(t,[{key:"updateFonts",value:function(){this.labelFont=this.tayberry.createFontString(this.options.font),this.titleFont=this.tayberry.createFontString(this.options.title.font)}},{key:"setPlacement",value:function(){var t=["left","right","top","bottom","start","end"];-1===t.indexOf(this.options.placement)&&(this.options.placement=this.isVertical^this.index>0?"start":"end")}},{key:"maxLabelSize",value:function(){var t=this,e=this.tayberry,i=this.getTicks();return l.reduce(i,Math.max,function(i){return e.getTextWidth(t.options.labelFormatter(i.value),t.labelFont)})}},{key:"mapLogicalXOrYUnit",value:function(t){return this.isVertical?this.tayberry.mapLogicalXUnit(t):this.tayberry.mapLogicalYUnit(t)}},{key:"mapLogicalYOrXUnit",value:function(t){return this.isVertical?this.tayberry.mapLogicalYUnit(t):this.tayberry.mapLogicalXUnit(t)}},{key:"adjustSize",value:function(t,e,i){var s=0,n=this.tayberry,r=void 0,o=n.getFontHeight(this.options.title.font),a=n.getFontHeight(this.options.font);if(i&&(this.calculatedSize=0,this.topAdjustment=0,this.rightAdjustment=0,this.numLabelLines=1),s+=this.mapLogicalXOrYUnit(n.options.elementSmallPadding),this.options.title.text&&(s+=this.mapLogicalXOrYUnit(n.options.elementSmallPadding)+o),!e){var l=this.getTicks(!1);if(this.isVertical){if(l.length){var h=l[l.length-1],u=h.y-a/2;if(u<t.top-this.topAdjustment){var c=t.top-u-this.topAdjustment+1;t.top+=c,this.topAdjustment+=c}}s+=this.maxLabelSize()}else{for(var p=void 0,d=0;d<l.length;d++){var f=l[d],g=n.getTextWidth(this.options.labelFormatter(f.value),this.labelFont),y=f.x-g/2,m=f.x+g/2;if("undefined"!=typeof p&&p+1>=y){this.numLabelLines=2;break}p=m}if(l.length){var h=l[l.length-1],g=n.getTextWidth(this.options.labelFormatter(h.value),this.labelFont),b=h.x+g/2;if(b>=t.right+this.rightAdjustment){var c=b-t.right-this.rightAdjustment+1;t.right-=c,this.rightAdjustment+=c}}s+=a*this.numLabelLines}}return this.isPlacedAtStart?this.isVertical?t.left+=s-this.calculatedSize:t.top+=s-this.calculatedSize:(s*=-1,this.isVertical?t.right+=s-this.calculatedSize:t.bottom+=s-this.calculatedSize),r=this.calculatedSize!==s,this.calculatedSize=s,r}},{key:"calculateExtent",value:function(){}},{key:"getCategoryLabel",value:function(){}},{key:"draw",value:function(t){this.drawTicksAndLabels(t),this.drawTitle(t)}},{key:"drawTicksAndLabels",value:function(t){var e=this,i=this.tayberry,s=this.mapLogicalXOrYUnit(i.options.elementSmallPadding),n=this.isVertical?s*(this.isPlacedAtStart?-1:1):0,r=this.isVertical?0:s*(this.isPlacedAtStart?-1:1),o=i.getFontHeight(this.options.font),a=this.isVertical?t[this.startProperty]:0,l=this.isVertical?0:t[this.startProperty];i.labelsCtx.save(),i.labelsCtx.font=this.labelFont,i.labelsCtx.fillStyle=this.options.font.colour,i.labelsCtx.textAlign=this.isVertical?this.isPlacedAtStart?"right":"left":"center",i.labelsCtx.textBaseline=this.isVertical?"middle":this.isPlacedAtStart?"bottom":"top";var h=[],u=0,c=0;this.enumerateTicks(function(t){var s=void 0,p=void 0,d=e.options.labelFormatter(t.value),f=u%e.numLabelLines,g=e.isVertical?0:o*f,y=i.getTextWidth(d,e.labelFont);e.isVertical||(s=t.x-y/2,p=t.x+y/2),(e.isVertical||("undefined"==typeof h[f]||s>h[f]+1)&&s>=0&&p<i.labelsCanvas.width)&&(c=Math.max(c,y),i.labelsCtx.fillText(d,t.x+n+a,t.y+r+g+l),h[f]=p),e.options.gridLines.colour&&i.drawLine(t.x1,t.y1,t.x2,t.y2,e.options.gridLines.colour),u++}),this.adjustOffsetRect(t,this.isVertical?c+s:o+s),i.labelsCtx.restore()}},{key:"adjustOffsetRect",value:function(t,e){t[this.startProperty]+=this.isPlacedAtStart?-e:e}},{key:"drawTitle",value:function(t){if(this.options.title.text){var e=this.tayberry;e.labelsCtx.save(),e.labelsCtx.font=this.titleFont,e.labelsCtx.fillStyle=this.options.title.font.colour,e.labelsCtx.textAlign="center";var i=this.mapLogicalXOrYUnit(e.options.elementSmallPadding),s=i*(this.isPlacedAtStart?-1:1),n=this.isVertical?t[this.startProperty]:0,r=this.isVertical?0:t[this.startProperty],o=e.getFontHeight(this.options.title.font);if(this.isVertical){e.labelsCtx.textBaseline="bottom";var a=e.plotArea[this.startProperty]+n+s,l=e.plotArea.yMidpoint+r;e.labelsCtx.translate(a,l),e.labelsCtx.rotate((this.isPlacedAtStart?-1:1)*Math.PI/2),e.labelsCtx.fillText(this.options.title.text,0,0)}else{e.labelsCtx.textBaseline=this.isPlacedAtStart?"bottom":"top";var a=e.plotArea.xMidpoint+n,l=e.plotArea[this.startProperty]+s+r;e.labelsCtx.fillText(this.options.title.text,a,l)}this.adjustOffsetRect(t,o+i),e.labelsCtx.restore()}}},{key:"getTicks",value:function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],e=[];return this.enumerateTicks(function(t){e.push(t)},t),e}},{key:"getOrigin",value:function(){}},{key:"updateFormatter",value:function(){}},{key:"isPlacedAtStart",get:function(){return"left"===this.options.placement||"bottom"===this.options.placement||"start"===this.options.placement}},{key:"isYAxis",get:function(){return"y"===this.axisType}},{key:"isVertical",get:function(){return!this.isHorizontal}},{key:"startProperty",get:function(){return this.isVertical?this.isPlacedAtStart?"left":"right":this.isPlacedAtStart?"top":"bottom"}},{key:"endProperty",get:function(){return this.isVertical?this.isPlacedAtStart?"right":"left":this.isPlacedAtStart?"bottom":"top"}}]),t}(),u=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),a(e,[{key:"enumerateTicks",value:function(t){var e=this.tayberry,i=this.options.categories.length,s=e.plotArea.clone();this.isVertical&&s.swapXY();var n=s.width/e.categoryCount,r=.5;if(!this.isVertical)switch(this.options.labelPosition){case"left":r=0;break;case"right":r=1}for(var o=0;i>o;o++){var a=this.options.categories[o],l=this.isPlacedAtStart?s.top:s.bottom,h=this.isPlacedAtStart?s.bottom:s.top,u=s.left+Math.floor(o*n),c=u,p=s.left+Math.floor(o*n+n*r),d=l;if(this.isVertical){var f=[l,u,h,c,d,p];u=f[0],l=f[1],c=f[2],h=f[3],p=f[4],d=f[5]}t({value:a,x1:u,y1:l,x2:c,y2:h,x:p,y:d})}}},{key:"updateFormatter",value:function(){this.options.labelFormatter||(this.options.labelFormatter=l.identity)}},{key:"getCategoryLabel",value:function(t){return this.options.labelFormatter(this.options.categories[t])}},{key:"getOrigin",value:function(){return this.tayberry.plotArea[this.isVertical?"bottom":"left"]}},{key:"getValueDisplacement",value:function(t){var e=this.getOrigin()+this.plotDisplacement*(t+.5)/this.options.categories.length;return e=this.isVertical?Math.floor(e):Math.ceil(e)}},{key:"plotDisplacement",get:function(){return this.isVertical?-this.tayberry.plotArea.height:this.tayberry.plotArea.width}}]),e}(h),c=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),a(e,[{key:"updateFormatter",value:function(){this.options.labelFormatter||("percentage"===this.options.labelFormat?this.options.labelFormatter=l.createPercentageFormatter(this.max-this.min,this.options.labelPrefix,this.options.labelSuffix):"currency"===this.options.labelFormat?this.options.labelFormatter=l.createFixedNumberFormatter(this.max-this.min,this.options.labelPrefix||this.options.currencySymbol,this.options.labelSuffix):this.options.labelFormatter=l.createAutoNumberFormatter(this.max-this.min,this.options.labelPrefix,this.options.labelSuffix))}},{key:"enumerateTicks",value:function(t){for(var e=this.tayberry,i=this.startProperty,s=this.endProperty,n=this.tickStart;n<=this.tickEnd&&this.tickStep;){var r=this.getValueDisplacement(n);if(this.isVertical){if(t({value:n,x1:e.plotArea[i],y1:r,x2:e.plotArea[s],y2:r,x:e.plotArea[i],y:r}))break}else if(t({value:n,y1:e.plotArea[i],x1:r,y2:e.plotArea[s],x2:r,y:e.plotArea[i],x:r}))break;n=this.tickStart+Math.round((n+this.tickStep-this.tickStart)/this.tickStep)*this.tickStep}}},{key:"calculateExtent",value:function(){var t=void 0,i=void 0,s=void 0,n=this.options.min,r=this.options.max,a=!l.isMissingValue(n),h=!l.isMissingValue(r);if(!a||!h){var u=this.isYAxis?this.tayberry.getDataMinMax(this):this.tayberry.getDataXMinMax(this),c=o(u,2),p=c[0],d=c[1],f=d-p;a||(n=p,this.isYAxis&&(n-=.1*f,p>=0&&0>n&&(n=0))),h||(r=d,this.isYAxis&&(r=d+.1*f,0>=d&&n>0&&(r=0)))}if(this.options.tickStepValue)this.tickStep=this.options.tickStepValue,this.min=n,this.max=r;else{var g=r-n;t=this.plotLength/this.mapLogicalYOrXUnit(this.options.tickStep),i=g/t,s=Math.pow(10,Math.floor(Math.log(i)/Math.log(10)));var y=e.snapScaledValue(Math.ceil(i/s));this.tickStep=y*s,this.min=n,this.max=r}this.tickStart=this.options.tickStepValue&&a?this.min:Math.floor(this.min/this.tickStep)*this.tickStep,this.tickEnd=this.options.tickStepValue&&h?this.max:Math.ceil(this.max/this.tickStep)*this.tickStep,!a&&this.isYAxis&&(this.min=this.tickStart),!h&&this.isYAxis&&(this.max=this.tickEnd)}},{key:"getOrigin",value:function(){var t=this.tayberry.plotArea[this.isVertical?"bottom":"left"]-(0-this.min)*this.plotDisplacement/(this.max-this.min);return this.isVertical&&t--,t=this.isVertical?Math.floor(t):Math.ceil(t)}},{key:"getValueDisplacement",value:function(t){var e=this.getOrigin()-t*this.plotDisplacement/(this.max-this.min);return e=this.isVertical?Math.floor(e):Math.ceil(e)}},{key:"getCategoryLabel",value:function(t,e,i){if(i){var s=t/e,n=(t+1)/e,r=this.max-this.min;return l.formatString("{0} ≤ x < {1}",[this.options.labelFormatter(this.min+s*r),this.options.labelFormatter(this.min+n*r)])}return this.options.labelFormatter(t)}},{key:"plotDisplacement",get:function(){return this.isVertical?this.tayberry.plotArea.height-1:-(this.tayberry.plotArea.width-1)}},{key:"plotLength",get:function(){return Math.abs(this.plotDisplacement)}}],[{key:"snapScaledValue",value:function(t){return t=1>t?1:2>t?2:2.5>t?2.5:5>t?5:10}}]),e}(h);i.Axis=h},{"./helpers/utils.js":10}],2:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=function(){function t(){s(this,t),this.selectedItem={},this.containerElement=null,this.labelsCanvas=null,this.labelsCtx=null,this.renderedSeries=null,this.options=null,this.scaleFactor=null,this.titleFont=null,this.plotArea=null,this.categories=[],this.titleFont=null,this.labelFont=null,this.legendFont=null,this.renderers=[]}return n(t,[{key:"seriesCount",get:function(){return this.options.series.length}},{key:"categoryCount",get:function(){return this.options.series.length?this.options.series[0].data.length:0}}]),t}();i.Tayberry=r},{}],3:[function(t,e,i){"use strict";var s=t("./helpers/colour").Colour,n=t("./helpers/utils"),r=t("./base").Tayberry,o=t("./axis").Axis,a=t("./renderer.bar").BarRenderer,l=t("./renderer.line").LineRenderer,h=0;r.getAutoColour=function(){var t=r.defaultColours[h%r.defaultColours.length];return h++,t},r.getDataValue=function(t){var e=void 0;return e=Array.isArray(t)?t[1]:t},r.getDataXValue=function(t,e){var i=void 0;return i=Array.isArray(t[e])?t[e][0]:e},r.setDataValue=function(t,e,i){Array.isArray(t[e])?t[e][1]=i:t[e]=i},r.prototype.createCanvas=function(){var t=document.createElement("canvas");return t.style.width=Math.floor(this.containerElement.clientWidth)+"px",t.style.width=Math.floor(this.containerElement.clientWidth)+"px",t.style.height=Math.floor(this.containerElement.clientHeight)+"px",t.style.position="absolute",this.containerElement.appendChild(t),t},r.prototype.create=function(t){"string"==typeof t?this.containerElement=document.getElementById(t):this.containerElement=t,this.labelsCanvas=this.createCanvas(),this.labelsCtx=this.labelsCanvas.getContext("2d"),this.plotCanvas=this.createCanvas(),this.plotCtx=this.plotCanvas.getContext("2d"),this.renderedSeries=null,this.options={},this.yAxes=null,this.xAxes=null,this.initialise()},r.prototype.destroy=function(){this.labelsCanvas.parentNode.removeChild(this.labelsCanvas),this.tooltipElement.parentNode.removeChild(this.tooltipElement),this.options={},this.plotCanvas.removeEventListener("mousemove",this.onMouseMoveReal),this.plotCanvas.removeEventListener("mouseleave",this.onMouseLeaveReal),window.removeEventListener("resize",this.onWindowResizeReal)},r.prototype.initialise=function(){this.scaleFactor=window.devicePixelRatio||1,this.labelsCanvas.width=Math.round(this.labelsCanvas.clientWidth*this.scaleFactor),this.labelsCanvas.height=Math.round(this.labelsCanvas.clientHeight*this.scaleFactor),this.plotCanvas.width=this.labelsCanvas.width,this.plotCanvas.height=this.labelsCanvas.height,this.scaleFactorX=this.labelsCanvas.width/this.labelsCanvas.clientWidth,this.scaleFactorY=this.labelsCanvas.height/this.labelsCanvas.clientHeight,this.selectedItem={},this.plotArea=null},r.prototype.getFontHeight=function(t,e){var i=t.size;return t.autoScale&&(i*=Math.pow(this.labelsCanvas.width/800,.25)),e||(i=this.mapLogicalYUnit(i)),i},r.prototype.createFontString=function(t,e){return(t.style?t.style+" ":"")+this.getFontHeight(t,e).toFixed(1)+"px "+t.face},r.prototype.updateFonts=function(){this.titleFont=this.createFontString(this.options.title.font),this.labelFont=this.createFontString(this.options.labels.font),this.legendFont=this.createFontString(this.options.legend.font),this.yAxes.map(function(t){return t.updateFonts()}),this.xAxes.map(function(t){return t.updateFonts()})},r.prototype.setOptions=function(t){var e=[this.defaultOptions()];if(t.presets||(t.presets=["default"]),t.presets)for(var i=0;i<t.presets.length;i++)e.push(r.presets[t.presets[i]]);e.push(t),this.options=n.deepAssign({},e),this.options.title.font=n.deepAssign({},[this.options.font,this.options.title.font]),this.options.tooltips.font=n.deepAssign({},[this.options.font,this.options.tooltips.font]),this.options.labels.font=n.deepAssign({},[this.options.font,this.options.labels.font]),this.options.legend.font=n.deepAssign({},[this.options.font,this.options.legend.font]),this.options.allAxes.font=n.deepAssign({},[this.options.font,this.options.allAxes.font]),this.options.allAxes.title.font=n.deepAssign({},[this.options.font,this.options.allAxes.title.font]),Array.isArray(this.options.yAxis)||(this.options.yAxis=[this.options.yAxis||{}]),Array.isArray(this.options.xAxis)||(this.options.xAxis=[this.options.xAxis||{}]);for(var s=0;s<this.options.yAxis.length;s++)this.options.yAxis[s]=n.deepAssign({},[0===s?r.defaultPrimaryYAxis:r.defaultSecondaryYAxis,this.options.allAxes,this.options.yAxis[s]]);for(var s=0;s<this.options.xAxis.length;s++)this.options.xAxis[s]=n.deepAssign({},[r.defaultXAxis,this.options.allAxes,this.options.xAxis[s]]);this.yAxes=[],this.xAxes=[];for(var s=0;s<this.options.xAxis.length;s++)this.xAxes.push(o.create(this,this.options.xAxis[s],s,"x",this.options.swapAxes));for(var s=0;s<this.options.yAxis.length;s++)this.yAxes.push(o.create(this,this.options.yAxis[s],s,"y",this.options.swapAxes));this.createRenderers(),this.updateFonts(),this.plotCanvas.addEventListener("mousemove",this.onMouseMoveReal=this.onMouseMove.bind(this)),this.plotCanvas.addEventListener("mouseleave",this.onMouseLeaveReal=this.onMouseLeave.bind(this)),window.addEventListener("resize",this.onWindowResizeReal=n.throttle(this.onWindowResize,50).bind(this))},r.calculateHighlightColour=function(t){var e=new s(t);return e.increaseBy(30*(e.sum>=540?-1:1)).toString()},r.calculateGlowColour=function(t){var e=new s(t);return e.a=.4,e.toString()},r.prototype.createRenderers=function(){var t=void 0,e={bar:[],line:[]};t=Array.isArray(this.options.series)?this.options.series:[this.options.series];for(var i=0;i<t.length;i++){var s=t[i];s.index=i,s.colour=s.colour||r.getAutoColour(),s.highlightColour=s.highlightColour||r.calculateHighlightColour(s.colour),s.glowColour=s.glowColour||r.calculateGlowColour(s.highlightColour),s.xAxis=this.xAxes[s.xAxisIndex||0],s.yAxis=this.yAxes[s.yAxisIndex||0],s.plotType=s.plotType||this.options.plotType,e.hasOwnProperty(s.plotType)&&e[s.plotType].push(s)}e.bar.length&&this.renderers.push(new a(this.plotCtx,this,e.bar)),e.line.length&&this.renderers.push(new l(this.plotCtx,this,e.line))},r.prototype.getDataMinMax=function(t){var e,i,s,o;if("stacked"===this.options.barPlot.mode){var a=[],l=[],h=this.options.series.filter(function(e){return"bar"===e.plotType&&e.yAxis===t});if(h.length)for(var u=0;u<h[0].data.length;u++){a[u]=0,l[u]=0;for(var c=0;c<h.length;c++){var p=r.getDataValue(h[c].data[u]);n.isMissingValue(p)||(0>p?l[u]+=p:a[u]+=p)}}s=Math.min(0,n.reduce(l,Math.min,void 0,!0)),o=Math.max(n.reduce(a,Math.max,void 0,!0),0)}for(var d=[],f=[],g=0;g<this.options.series.length;g++){var y=this.options.series[g];y.yAxis!==t||"bar"===y.plotType&&"stacked"===this.options.barPlot.mode||(d.push(n.reduce(y.data,Math.min,r.getDataValue,!0)),f.push(n.reduce(y.data,Math.max,r.getDataValue,!0)))}e=n.reduce(d,Math.min,void 0,!0),i=n.reduce(f,Math.max,void 0,!0);var m=n.reduce([e,s],Math.min,void 0,!0),b=n.reduce([i,o],Math.max,void 0,!0);return[m,b]},r.prototype.getDataXMinMax=function(t){for(var e,i,s=[],o=[],a=0;a<this.options.series.length;a++){var l=this.options.series[a];l.xAxis===t&&(s.push(n.reduce(l.data,Math.min,r.getDataXValue,!0)),o.push(n.reduce(l.data,Math.max,r.getDataXValue,!0)))}return e=n.reduce(s,Math.min,void 0,!0),i=n.reduce(o,Math.max,void 0,!0),[e,i]},r.prototype.createTooltip=function(){this.tooltipElement&&(this.tooltipElement.parentNode.removeChild(this.tooltipElement),this.tooltipElement=null),this.tooltipElement=document.createElement("div"),this.tooltipElement.className="tayberry-tooltip",this.tooltipElement.style.position="absolute",this.tooltipElement.style.left="0px",this.tooltipElement.style.top="0px",this.tooltipElement.style.zIndex="99999",this.tooltipElement.style.font=this.createFontString(this.options.tooltips.font,!0),this.tooltipElement.style.borderRadius="3px",this.tooltipElement.style.backgroundColor="white",this.tooltipElement.style.border="2px solid #bbb",this.tooltipElement.style.padding="0.15em 0.4em",this.tooltipElement.style.display="none",this.tooltipElement.innerHTML="",document.body.appendChild(this.tooltipElement),this.tooltipElement.addEventListener("mousemove",this.onMouseMove.bind(this)),this.tooltipElement.addEventListener("mouseleave",this.onMouseLeave.bind(this))}},{"./axis":1,"./base":2,"./helpers/colour":7,"./helpers/utils":10,"./renderer.bar":11,"./renderer.line":13}],4:[function(t,e,i){"use strict";var s=t("./base.js").Tayberry,n=t("./helpers/utils");s.prototype.defaultOptions=function(){return{title:{text:"",font:{size:20}},font:{colour:"#444",size:12,face:"sans-serif",style:"",autoScale:!0},allAxes:{font:{},title:{font:{}}},xAxis:[],yAxis:[],animations:{enabled:!0},series:[],backgroundColour:void 0,swapAxes:!1,plotType:"bar",barPlot:{mode:"normal",barPadding:2,categorySpacing:.3},linePlot:{lineWidth:2,highlightedLineWidth:4,showMarkers:"auto",noMarkersThreshold:100,markerSize:10,highlightedMarkerSize:18},elementSmallPadding:5,elementLargePadding:10,presets:[],tooltips:{shared:!1,headerTemplate:"<strong>{category}</strong><table>",valueTemplate:'<tr><td style="padding-right: 0.5em"><span style="color: {colour}">●</span> {name}</td><td style="text-align: right">{value}</td></tr>',footerTemplate:"</table>",font:{}},legend:{enabled:!0,indicatorSize:15,font:{}},labels:{enabled:!1,verticalAlignment:"top",verticalPosition:"outside",font:{}}}},s.defaultXAxis={title:{text:"",font:{}},type:"categorial",min:null,max:null,tickStep:40,tickStepValue:null,font:{},categories:[],labelPosition:"middle",placement:"auto",gridLines:{}},s.defaultYAxis={title:{text:"",font:{}},min:void 0,max:void 0,tickStep:40,tickStepValue:null,font:{},labelFormat:"number",labelFormatter:void 0,labelPrefix:void 0,labelSuffix:void 0,currencySymbol:"£",placement:"auto",type:"linear",gridLines:{}},s.defaultPrimaryYAxis=n.deepAssign({},[s.defaultYAxis,{gridLines:{colour:"#ccc"}}]),s.defaultSecondaryYAxis=s.defaultYAxis,s.presets={histogram:{barPlot:{mode:"overlaid",categorySpacing:0,barPadding:1}},darkGrid:{allAxes:{gridLines:{colour:"rgba(255, 255, 255, 0.6)"}},plotBackgroundColour:"#E5E5E5"}},s.defaultColours=["#6FE87B","#FFAB51","#51A8FF","#B651FF","#FF6051","#636363","#FFE314","#A88572","#B7B7B7"]},{"./base.js":2,"./helpers/utils":10}],5:[function(t,e,i){"use strict";var s=t("./base").Tayberry,n=t("./helpers/rect").Rect;t("./helpers/utils");s.prototype.getTextWidth=function(t,e){var i=void 0;return e&&(this.labelsCtx.save(),this.labelsCtx.font=e),i=this.labelsCtx.measureText(t).width,e&&this.labelsCtx.restore(),i},s.prototype.getMultilineTextHeight=function(t,e,i){var s=void 0;return t&&(this.labelsCtx.save(),this.labelsCtx.font=t),s=this.splitMultilineText(e,i).length,t&&this.labelsCtx.restore(),s},s.prototype.splitMultilineText=function(t,e){for(var i=[],s=0,n="",r=this.labelsCtx.measureText(" ").width,o=0;o<e.length;){for(var a=o;o<e.length&&" "!==e[o]&&"\r"!==e[o]&&"\n"!==e[o];)o++;for(var l=o;o<e.length&&(" "===e[o]||"\r"===e[o]||"\n"===e[o]);)o++;if(l>a){var h=e.substring(a,l),u=this.labelsCtx.measureText(h).width;s+u>t?(s||(n=h),i.push(n),s&&(s=0,n=h)):(n+=(n?" ":"")+h,s+=u+r)}}return n&&i.push(n),i},s.prototype.drawTextMultiline=function(t,e,i,s,n){for(var r=this.splitMultilineText(s,n),o=0;o<r.length;o++){var a=r[o];this.labelsCtx.fillText(a,e,i+t*o)}},s.prototype.render=function(){this.calculatePlotArea(),this.drawLabelLayer(),this.createTooltip(),this.options.animations.enabled?(this.animator=requestAnimationFrame(this.onAnimate.bind(this)),this.animationStart="undefined"!=typeof performance&&"undefined"!=typeof performance.now?performance.now():null,this.animationLength=500):this.drawPlotLayer()},s.prototype.clear=function(){var t=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];t&&this.plotCtx.clearRect(0,0,this.plotCanvas.width,this.plotCanvas.height),e&&this.labelsCtx.clearRect(0,0,this.labelsCanvas.width,this.labelsCanvas.height)},s.prototype.drawBackground=function(){this.options.plotBackgroundColour&&(this.labelsCtx.save(),this.labelsCtx.fillStyle=this.options.plotBackgroundColour,this.labelsCtx.fillRect(this.plotArea.left,this.plotArea.top,this.plotArea.width,this.plotArea.height),this.labelsCtx.restore())},s.prototype.drawTitle=function(){if(this.options.title.text){var t=this.labelsCanvas.width/2,e=0;this.labelsCtx.save(),this.labelsCtx.textAlign="center",this.labelsCtx.textBaseline="top",this.labelsCtx.font=this.titleFont,this.labelsCtx.fillStyle=this.options.title.font.colour,this.drawTextMultiline(this.getFontHeight(this.options.title.font),t,e,this.labelsCanvas.width,this.options.title.text),this.labelsCtx.restore()}},s.prototype.drawPlotLayer=function(){for(var t=0;t<this.renderers.length;t++)this.renderers[t].drawPlot();for(var t=0;t<this.renderers.length;t++)this.renderers[t].drawLabels()},s.prototype.drawLine=function(t,e,i,s,n){var r=arguments.length<=5||void 0===arguments[5]?this.labelsCtx:arguments[5];r.save(),n&&(r.strokeStyle=n),r.beginPath(),r.moveTo(t+.5,e+.5),r.lineTo(i+.5,s+.5),r.stroke(),r.restore()},s.prototype.drawLabelLayer=function(){this.drawBackground(),this.drawTitle();var t=new n(0);this.xAxes.map(function(e){return e.draw(t)}),this.yAxes.map(function(e){return e.draw(t)}),this.drawLegend()},s.prototype.redraw=function(t){this.clear(!0,!t),t||this.drawLabelLayer(),this.drawPlotLayer()},s.prototype.drawLegend=function(){if(this.options.legend.enabled){this.labelsCtx.save(),this.labelsCtx.font=this.legendFont;for(var t=0,e=this.mapLogicalXUnit(this.options.legend.indicatorSize),i=0;i<this.options.series.length;i++){var s=this.options.series[i];s.name&&(t+=this.getTextWidth(s.name,this.legendFont)+e+this.mapLogicalXUnit(this.options.elementSmallPadding+this.options.elementLargePadding))}for(var r=this.plotArea.left+this.plotArea.width/2-t/2,o=this.labelsCanvas.height-e,i=0;i<this.options.series.length;i++){var s=this.options.series[i];s.name&&(s.renderer.drawLegendIndicator(this.labelsCtx,s,new n(r,o,r+e,o+e)),this.labelsCtx.textBaseline="middle",this.labelsCtx.fillStyle=this.options.legend.font.colour,r+=e+this.mapLogicalXUnit(this.options.elementSmallPadding),this.labelsCtx.fillText(s.name,r,o+e/2),r+=this.getTextWidth(s.name,this.legendFont)+this.mapLogicalXUnit(this.options.elementLargePadding))}this.labelsCtx.restore()}}},{"./base":2,"./helpers/rect":9,"./helpers/utils":10}],6:[function(t,e,i){"use strict";var s=t("./helpers/rect").Rect,n=t("./helpers/utils"),r=t("./base").Tayberry;r.prototype.onAnimate=function(t){var e;null===this.animationStart&&(this.animationStart=t),e=t-this.animationStart;for(var i=0;i<this.renderers.length;i++)this.renderers[i].onAnimationFrame(e,this.animationLength);this.redraw(!0),e<this.animationLength&&(this.animator=requestAnimationFrame(this.onAnimate.bind(this)))},r.prototype.onMouseLeave=function(t){(t.currentTarget==this.plotCanvas&&t.relatedTarget!==this.tooltipElement||t.currentTarget==this.tooltipElement&&t.relatedTarget!==this.plotCanvas)&&(this.selectedItem={},this.tooltipElement.style.display="none",this.redraw())},r.prototype.handleMouseMove=function(t,e){var i=new s(this.plotCanvas.getBoundingClientRect()),o=!1;if(i.containsPoint(t,e)){var a=t-i.left,l=e-i.top,h=this.hitTest(this.mapLogicalXUnit(a),this.mapLogicalYUnit(l));if(h.found){var u="",c=h.rect.top<h.rect.bottom;if(this.tooltipElement.style.display="block",this.options.tooltips.shared){var p=this.xAxes[0].getCategoryLabel(h.categoryIndex,this.categoryCount,h.isXRange);u+=n.formatString(this.options.tooltips.headerTemplate,{category:p},!0);for(var d=0;d<this.seriesCount;d++){var f=this.options.series[d],g=r.getDataValue(f.data[h.categoryIndex]);u+=n.formatString(this.options.tooltips.valueTemplate,{value:f.yAxis.options.labelFormatter(g),name:f.name,colour:f.colour},!0)}}else{var f=h.series,g=h.value,p=f.xAxis.getCategoryLabel(h.categoryIndex,this.categoryCount,h.isXRange);u+=n.formatString(this.options.tooltips.headerTemplate,{category:p},!0),u+=n.formatString(this.options.tooltips.valueTemplate,{value:f.yAxis.options.labelFormatter(g),name:f.name,colour:f.colour},!0)}u+=this.options.tooltips.footerTemplate,this.tooltipElement.innerHTML=u;var y=this.tooltipElement.getBoundingClientRect();this.options.tooltips.shared||(this.tooltipElement.style.borderColor=h.series.colour),this.tooltipElement.style.left=window.pageXOffset+i.left+this.mapScreenUnit(h.rect.width)/2+h.rect.left/this.scaleFactor-y.width/2+"px",this.tooltipElement.style.top=window.pageYOffset+i.top+this.mapScreenUnit(h.rect.top)-y.height*(c?1:0)-this.options.elementSmallPadding*(c?1:-1)+"px",this.selectedItem=h,o=!0}}return o},r.prototype.onMouseMove=function(t){var e=n.assign({},this.selectedItem);this.handleMouseMove(t.clientX,t.clientY)||(this.selectedItem={}),(e.categoryIndex!==this.selectedItem.categoryIndex||e.series!==this.selectedItem.series)&&this.redraw()},r.prototype.onWindowResize=function(){this.tooltipElement.style.display="none",this.labelsCanvas.style.width=Math.floor(this.containerElement.clientWidth)+"px",this.labelsCanvas.style.height=Math.floor(this.containerElement.clientHeight)+"px",this.plotCanvas.style.width=Math.floor(this.containerElement.clientWidth)+"px",this.plotCanvas.style.height=Math.floor(this.containerElement.clientHeight)+"px",this.initialise(),this.updateFonts(),this.calculatePlotArea(),this.createTooltip(),this.redraw()}},{"./base":2,"./helpers/rect":9,"./helpers/utils":10}],7:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),r=t("./utils"),o=function(){function t(){if(s(this,t),1===arguments.length){var e=arguments[0];"string"==typeof e?this.parseString(e):(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}}return n(t,[{key:"parseString",value:function(t){var e=/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})|^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,i=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*([0-9]*\.?[0-9]+)\s*)?\)$/i,s=e.exec(t),n=i.exec(t);if(s){var r=function(t){var e=parseInt(t,16);return e=16*e+e};this.r=s[1]?parseInt(s[1],16):r(s[4]),this.g=s[2]?parseInt(s[2],16):r(s[5]),this.b=s[3]?parseInt(s[3],16):r(s[6]),this.a=null}else{if(!n)throw new RangeError(t+" is not a valid HTML colour");this.r=parseInt(n[1]),this.g=parseInt(n[2]),this.b=parseInt(n[3]),this.a=n[5]?parseFloat(n[5]):null}return this}},{key:"clipComponent",value:function(t){return this[t]=Math.round(this[t]),this[t]=Math.min(this[t],255),this[t]=Math.max(this[t],0),this}},{key:"clip",value:function(){return this.clipComponent("r"),this.clipComponent("g"),this.clipComponent("b"),this}},{key:"increaseBy",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this.clip(),this}},{key:"toString",value:function(){var t;return t=this.a?r.formatString("rgba({r},{g},{b},{a})",this):r.formatString("rgb({r},{g},{b})",this)}},{key:"sum",get:function(){return this.r+this.g+this.b}}]),t}();i.Colour=o},{"./utils":10}],8:[function(t,e,i){"use strict";i.linear=function(t,e){return t/e},i.linear=function(t,e){return t/e},i.inQuad=function(t,e){var i=t/e;return i*i},i.outQuad=function(t,e){var i=t/e;return i*(2-i)}},{}],9:[function(t,e,i){
"use strict";function s(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=function(){function t(){if(n(this,t),1===arguments.length)if("object"===s(arguments[0])){var e=arguments[0];this.left=e.left,this.top=e.top,this.right=e.right,this.bottom=e.bottom}else{var i=arguments[0];this.left=i,this.top=i,this.right=i,this.bottom=i}else 4===arguments.length&&(this.left=arguments[0],this.top=arguments[1],this.right=arguments[2],this.bottom=arguments[3])}return r(t,[{key:"containsPoint",value:function(t,e){return this.containsX(t)&&this.containsY(e)}},{key:"containsY",value:function(t){return t>=this.top&&t<this.bottom||t>=this.bottom&&t<this.top}},{key:"containsX",value:function(t){return t>=this.left&&t<this.right||t>=this.right&&t<this.left}},{key:"inflate",value:function(t){return this.left-=t,this.top-=t,this.right+=t,this.bottom+=t,this}},{key:"clip",value:function(t){return this.left<t.minX?this.left=t.minX:this.left>t.maxX&&(this.left=t.maxX),this.right<t.minX?this.right=t.minX:this.right>t.maxX&&(this.right=t.maxX),this.top<t.minY?this.top=t.minY:this.top>t.maxY&&(this.top=t.maxY),this.bottom>t.maxY?this.bottom=t.maxY:this.bottom<t.minY&&(this.bottom=t.minY),this}},{key:"clone",value:function(){return new t(this)}},{key:"swapXY",value:function(){var t=[this.top,this.left];this.left=t[0],this.top=t[1];var e=[this.right,this.bottom];return this.bottom=e[0],this.right=e[1],this}},{key:"width",get:function(){return this.right-this.left}},{key:"height",get:function(){return this.bottom-this.top}},{key:"maxY",get:function(){return Math.max(this.bottom,this.top)}},{key:"minY",get:function(){return Math.min(this.bottom,this.top)}},{key:"minX",get:function(){return Math.min(this.left,this.right)}},{key:"maxX",get:function(){return Math.max(this.left,this.right)}},{key:"xMidpoint",get:function(){return(this.left+this.right)/2}},{key:"yMidpoint",get:function(){return(this.top+this.bottom)/2}},{key:"area",get:function(){return this.width*this.height}}]),t}();i.Rect=o},{}],10:[function(t,e,i){"use strict";function s(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}!function(){i.identity=function(t){return t},i.isMissingValue=function(t){return null===t||"undefined"==typeof t||isNaN(t)&&"number"==typeof t},i.reduce=function(t,e,s){var n,r,o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];if(!t.reduce||s||o){var a=!1;for(s=s||i.identity,r=0;r<t.length;r++){var l=s(t[r],r);o&&i.isMissingValue(l)||(n=a?e(n,l):l,a=!0)}}else n=t.reduce(function(t,i){return e(t,i)});return n},i.sign=Math.sign||function(t){return t>0?1:0>t?-1:0};var t=function e(t,i,n){if(Array.isArray(n)||(n=[n]),!t&&Object.assign)return Object.assign.apply(Object,[i].concat(n));if(void 0===i||null===i)throw new TypeError("Cannot convert first argument to object");for(var r=Object(i),o=0;o<n.length;o++){var a=n[o];if(void 0!==a&&null!==a){a=Object(a);for(var l=Object.keys(a),h=0,u=l.length;u>h;h++){var c=l[h],p=a[c],d=Object.getOwnPropertyDescriptor(a,c);void 0!==d&&d.enumerable&&(t&&!Array.isArray(p)&&"object"===("undefined"==typeof p?"undefined":s(p))&&null!==p?r[c]=e(!0,{},[r[c],p]):r[c]=p)}}}return r};i.none=function(t){return t.every(function(t){return!t})},i.assign=function(e,i){return t(!1,e,i)},i.deepAssign=function(e,i){return t(!0,e,i)},i.formatString=function(t,e,s){return t.replace(/{(\w+)}/g,function(t,n){var r=e[n];return"undefined"!=typeof r?s?i.stringToHtml(r):r:t})},i.locateDecimalPoint=function(t){return Math.floor(Math.log(t)/Math.log(10))},i.formatNumberThousands=function(t){var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=t.toFixed(e).split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")},i.createAutoNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(t);return r=0>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(t,r)+s}},i.createFixedNumberFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3];return function(t){return e+i.formatNumberThousands(t,n)+s}},i.createPercentageFormatter=function(t){var e=arguments.length<=1||void 0===arguments[1]?"":arguments[1],s=arguments.length<=2||void 0===arguments[2]?"%":arguments[2],n=arguments.length<=3||void 0===arguments[3]?2:arguments[3],r=i.locateDecimalPoint(100*t);return r=n>r?-r+n-1:0,function(t){return e+i.formatNumberThousands(100*t,r)+s}},i.stringToHtml=function(t){var e=document.createElement("div");return e.appendChild(document.createTextNode(t)),e.innerHTML},i.throttle=function(t,e){var i,s;return function(){var n=this,r=Date.now(),o=arguments;i&&i+e>r?(clearTimeout(s),s=setTimeout(function(){i=r,t.apply(n,o)},e)):(i=r,t.apply(n,o))}}}()},{}],11:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=t("./helpers/rect").Rect,l=t("./helpers/utils"),h=t("./renderer.base"),u=t("./base.js").Tayberry,c=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"drawPlot",value:function(){this.ctx.save();for(var t=new p(this),e=void 0;e=t.next();)this.ctx.fillStyle=e.selected?e.renderedSeries.highlightColour:e.renderedSeries.colour,this.ctx.fillRect(e.rect.left,e.rect.top,e.rect.width,e.rect.height);this.ctx.restore()}},{key:"drawLabels",value:function(){if(this.tb.options.labels.enabled){this.ctx.save();for(var t=new p(this),e=void 0;e=t.next();)this.ctx.font=this.tb.labelFont,this.ctx.fillStyle=this.tb.options.labels.font.colour,this.drawLabel(e.value,e.series.yAxis.options.labelFormatter(e.value),e.rect);this.ctx.restore()}}},{key:"hitTest",value:function(t,e){var i={found:!1,plotType:"bar",isXRange:!0},s=this.renderedSeries[0].data.length,n=this.tb.options.swapAxes,r=this.tb.plotArea.clone();n&&r.swapXY();for(var o=Math.floor(s*((n?e:t)-r.left)/r.width),a=[],h=new p(this,o),c=void 0;(c=h.next())&&!(c.categoryIndex>o);){var d=void 0,f=void 0,g=void 0;if(c.rect.containsPoint(t,e))d=0,f=0;else if(c.rect.containsX(t))d=e<c.rect.top?c.rect.top-e:e-c.rect.bottom,f=n?2:1;else if(c.rect.containsY(e))d=t<c.rect.left?c.rect.left-t:t-c.rect.right,f=n?1:2;else{var y=Math.min(Math.abs(t-c.rect.left),Math.abs(t-c.rect.right)),m=Math.min(Math.abs(e-c.rect.top),Math.abs(e-c.rect.bottom));g=Math.sqrt(Math.pow(y,2)+Math.pow(m,2)),d=n?m:y,f=3}"undefined"==typeof g&&(g=d),a.push({sortDistance:d,distance:g,priority:f,data:{categoryIndex:c.categoryIndex,seriesIndex:c.seriesIndex,rect:c.rect,series:this.series[c.seriesIndex],value:u.getDataValue(this.series[c.seriesIndex].data[c.categoryIndex])}})}return a.length&&(a.sort(function(t,e){var i=t.priority-e.priority;return i||(i=t.sortDistance-e.sortDistance),i||(i=t.data.rect.height-e.data.rect.height),i}),i.found=!0,i.normalisedDistance=a[0].distance+Math.sqrt(a[0].data.rect.area),i=l.assign(i,a[0].data)),i}}]),e}(h.Renderer),p=function(t){function e(t){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];s(this,e);var r=n(this,Object.getPrototypeOf(e).call(this,t,i));return r.categoryCount&&(r.isStacked="stacked"===r.tb.options.barPlot.mode,r.isOverlaid="overlaid"===r.tb.options.barPlot.mode,r.isNormal=!r.isStacked&&!r.isOverlaid,r.barCount=r.isStacked||r.isOverlaid?1:r.seriesCount,r.categoryWidth=r.plotArea.width/r.categoryCount,r.yOrigin=r.renderer.series[0].yAxis.getOrigin(),r.onNewCategory()),r}return r(e,t),o(e,[{key:"onNewCategory",value:function(){this.yBottomPositive=this.yOrigin,this.yBottomNegative=this.yOrigin,this.yRunningTotalPositive=0,this.yRunningTotalNegative=0,this.barIndex=0}},{key:"next",value:function(){var t=void 0;if(this.categoryIndex<this.categoryCount){var e=this.renderer.renderedSeries[this.seriesIndex],i=u.getDataValue(e.data[this.categoryIndex]),s=this.plotArea.left+Math.floor(this.categoryIndex*this.categoryWidth),n=this.plotArea.left+Math.floor((this.categoryIndex+1)*this.categoryWidth),r=s+Math.ceil(this.categoryWidth*this.tb.options.barPlot.categorySpacing/2),o=n-Math.floor(this.categoryWidth*this.tb.options.barPlot.categorySpacing/2),l=Math.floor((o-r)/this.barCount),h=Math.floor(r+this.barIndex*l),c=Math.ceil(r+(this.barIndex+1)*l),p=e.yAxis.getValueDisplacement(i+(i>0?this.yRunningTotalPositive:this.yRunningTotalNegative)),d=new a(h,p,c,this.isStacked?i>0?this.yBottomPositive:this.yBottomNegative:e.yAxis.getOrigin());d.left+=Math.ceil(e.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding)/2),d.right-=Math.floor(e.xAxis.mapLogicalXOrYUnit(this.tb.options.barPlot.barPadding)/2),d.right<d.left&&(d.right=d.left),this.isHorizontal&&d.swapXY(),d.clip(this.tb.plotArea),t={seriesIndex:this.seriesIndex,categoryIndex:this.categoryIndex,series:this.renderer.series[this.seriesIndex],renderedSeries:this.renderer.renderedSeries[this.seriesIndex],value:u.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),renderedValue:u.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),rect:d,selected:this.tb.selectedItem.categoryIndex===this.categoryIndex&&(this.tb.options.tooltips.shared||this.tb.selectedItem.series===this.renderer.series[this.seriesIndex])},this.isStacked?i>0?(this.yRunningTotalPositive+=i,this.yBottomPositive=p):(this.yRunningTotalNegative+=i,this.yBottomNegative=p):this.isNormal&&this.barIndex++,this.nextValue()}return t}}]),e}(h.ByCategoryEnumerator);i.BarRenderer=c},{"./base.js":2,"./helpers/rect":9,"./helpers/utils":10,"./renderer.base":12}],12:[function(t,e,i){"use strict";function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=t("./helpers/utils"),l=t("./helpers/easing"),h=t("./base").Tayberry,u=function(){function t(e,i,s){r(this,t),this.ctx=e,this.tb=i,this.series=null,this.renderedSeries=null,this.setSeries(s)}return o(t,[{key:"setSeries",value:function(t){var e;for(this.series=t,this.renderedSeries=t.slice(0),e=0;e<this.renderedSeries.length;e++){var i=this.series[e];i.renderer=this;var s=a.assign({},i);if(s.data=this.renderedSeries[e].data.slice(0),s.data.length&&Array.isArray(s.data[0]))for(var n=0;n<s.data.length;n++)s.data[n]=s.data[n].slice(0);this.renderedSeries[e]=s}}},{key:"onAnimationFrame",value:function(t,e){var i;i=Math.min(l.inQuad(t,e),1);for(var s=0;s<this.series[0].data.length;s++)for(var n=0;n<this.series.length;n++){var r=this.series[n],o=h.getDataValue(r.data[s]),a=r.yAxis.min<=0&&0<=r.yAxis.max?0:r.yAxis.min>0?r.yAxis.min:r.yAxis.max;h.setDataValue(this.renderedSeries[n].data,s,a+i*(o-a))}}},{key:"drawLegendIndicator",value:function(t,e,i){t.fillStyle=e.colour,t.fillRect(i.left,i.top,i.width,i.height)}},{key:"drawLabel",value:function(t,e,i){this.tb.options.swapAxes&&(i=i.clone().swapXY());var s=(i.left+i.right)/2,n=void 0;n="top"===this.tb.options.labels.verticalAlignment?i.top:"bottom"===this.tb.options.labels.verticalAlignment?i.bottom:(i.top+i.bottom)/2;var r="middle",o="center";if(this.tb.options.swapAxes){var a=[n,s];s=a[0],n=a[1],"outside"===this.tb.options.labels.verticalPosition?o="left":"inside"===this.tb.options.labels.verticalPosition&&(o="right")}else r=h.mapVerticalPosition(t,this.tb.options.labels.verticalPosition);this.tb.plotArea.containsPoint(s,n)&&(this.ctx.save(),this.ctx.textAlign=o,this.ctx.textBaseline=r,this.ctx.fillText(e,s,n),this.ctx.restore())}},{key:"drawPlot",value:function(){}},{key:"drawLabels",value:function(){}},{key:"hitTest",value:function(){}}]),t}(),c=function(){function t(e){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];r(this,t),this.renderer=e,this.tb=e.tb,this.categoryCount=this.renderer.renderedSeries[0].data.length,this.categoryIndex=0,this.seriesIndex=0,this.seriesCount=this.renderer.renderedSeries.length,this.categoryCount&&(this.isHorizontal=this.tb.options.swapAxes,this.plotArea=this.tb.plotArea.clone(),this.isHorizontal&&this.plotArea.swapXY(),this.startCategoryIndex=Math.max(i,0),this.startCategoryIndex=Math.min(this.startCategoryIndex,this.categoryCount-1),this.categoryIndex=this.startCategoryIndex)}return o(t,[{key:"nextValue",value:function(){}}]),t}(),p=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),o(e,[{key:"onNewCategory",value:function(){}},{key:"nextValue",value:function(){var t=void 0;do{if(this.seriesIndex+1===this.seriesCount){if(this.seriesIndex=0,this.categoryIndex++,this.categoryIndex>=this.categoryCount)break;this.onNewCategory()}else this.seriesIndex++;t=h.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex])}while(a.isMissingValue(t))}}]),e}(c),d=function(t){function e(){return r(this,e),s(this,Object.getPrototypeOf(e).apply(this,arguments))}return n(e,t),o(e,[{key:"nextValue",value:function(){var t=void 0;do{if(this.categoryIndex+1===this.categoryCount){if(this.categoryIndex=this.startCategoryIndex,this.seriesIndex++,this.seriesIndex>=this.seriesCount)break}else this.categoryIndex++;t=h.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex])}while(a.isMissingValue(t))}}]),e}(c);i.Renderer=u,i.ByCategoryEnumerator=p,i.BySeriesEnumerator=d},{"./base":2,"./helpers/easing":8,"./helpers/utils":10}],13:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=function y(t,e,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var n=Object.getPrototypeOf(t);return null===n?void 0:y(n,e,i)}if("value"in s)return s.value;var r=s.get;return void 0===r?void 0:r.call(i)},l=t("./helpers/utils"),h=t("./helpers/rect").Rect,u=t("./renderer.base"),c=t("./base").Tayberry,p=0,d=["square","diamond","circle","triangle","triangle-inversed"],f=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"setSeries",value:function(t){for(var i=0,s=0;s<t.length;s++)t[s].markerType||(t[s].markerType=d[p%d.length],p++),i+=t[s].data.length;var n=this.tb.options.linePlot.showMarkers;this.showMarkers="auto"===n?i<this.tb.options.linePlot.noMarkersThreshold:n,a(Object.getPrototypeOf(e.prototype),"setSeries",this).call(this,t)}},{key:"drawMarker",value:function(t,e,i,s){var n=arguments.length<=4||void 0===arguments[4]?this.ctx:arguments[4];"square"===t?n.fillRect(e-s/2,i-s/2,s,s):"diamond"===t?(n.save(),n.translate(e,i),n.rotate(-Math.PI/4),n.fillRect(0-s/2,0-s/2,s,s),n.restore()):"circle"===t?(s=Math.round(1.2*s),n.beginPath(),n.arc(e,i,s/2,0,2*Math.PI),n.fill()):("triangle"===t||"triangle-inversed"===t&&(s=-s))&&(s=Math.round(1.2*s),n.beginPath(),n.moveTo(e-s/2,i+s/2),n.lineTo(e,i-s/2),n.lineTo(e+s/2,i+s/2),n.closePath(),n.fill())}},{key:"drawPlot",value:function(){this.ctx.save();for(var t=new g(this),e=void 0;e=t.next();)e.firstPoint?(this.ctx.lineWidth=e.seriesSelected?this.tb.options.linePlot.highlightedLineWidth:this.tb.options.linePlot.lineWidth,this.ctx.strokeStyle=e.seriesSelected?e.renderedSeries.highlightColour:e.renderedSeries.colour,this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y)):this.ctx.lineTo(e.x,e.y),e.lastPoint&&this.ctx.stroke();if(this.showMarkers)for(t=new g(this);e=t.next();)e.selected&&(this.ctx.fillStyle=e.renderedSeries.glowColour,this.drawMarker(e.renderedSeries.markerType,e.x,e.y,this.tb.options.linePlot.highlightedMarkerSize)),this.ctx.fillStyle=e.renderedSeries.colour,this.drawMarker(e.renderedSeries.markerType,e.x,e.y,this.tb.options.linePlot.markerSize);this.ctx.restore()}},{key:"drawLegendIndicator",value:function(t,e,i){t.save(),t.lineWidth=2,t.strokeStyle=e.colour,this.tb.drawLine(i.left,i.yMidpoint,i.right,i.yMidpoint),t.fillStyle=e.colour,this.drawMarker(e.markerType,i.xMidpoint,i.yMidpoint,this.tb.options.linePlot.markerSize,t),t.restore()}},{key:"drawLabels",value:function(){if(this.tb.options.labels.enabled){this.ctx.save(),this.ctx.font=this.tb.labelFont,this.ctx.fillStyle=this.tb.options.labels.font.colour;for(var t=new g(this),e=void 0;e=t.next();){var i=new h(e.x,e.y,e.x,e.y).inflate(this.tb.options.linePlot.markerSize/2);this.drawLabel(e.value,e.series.yAxis.options.labelFormatter(e.value),i)}this.ctx.restore()}}},{key:"hitTest",value:function(t,e){for(var i={found:!1,plotType:"line",isXRange:!1},s=[],n=new g(this),r=void 0;r=n.next();){var o=Math.sqrt(Math.pow(r.x-t,2)+Math.pow(r.y-e,2)),a=Math.abs(this.tb.options.swapAxes?r.y-e:r.x-t);s.push({distance:o,horizontalDistance:a,priority:0,data:r})}if(s.length){s.sort(function(t,e){return t.horizontalDistance-e.horizontalDistance||t.distance-e.distance}),r=s[0].data;var u=new h(r.x,r.y,r.x,r.y).inflate(this.tb.options.linePlot.markerSize/2);l.assign(i,[{found:!0,rect:u,normalisedDistance:s[0].distance+Math.sqrt(u.area)},r])}return i}}]),e}(u.Renderer),g=function(t){function e(){return s(this,e),n(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,t),o(e,[{key:"next",value:function(){var t=void 0;if(this.seriesIndex<this.seriesCount){var e=this.renderer.renderedSeries[this.seriesIndex],i=c.getDataValue(e.data[this.categoryIndex]),s=c.getDataXValue(e.data,this.categoryIndex),n=e.xAxis.getValueDisplacement(s),r=e.yAxis.getValueDisplacement(i);if(this.isHorizontal){var o=[r,n];n=o[0],r=o[1]}t={firstPoint:0===this.categoryIndex,lastPoint:this.categoryIndex+1===this.categoryCount,seriesIndex:this.seriesIndex,categoryIndex:this.categoryIndex,series:this.renderer.series[this.seriesIndex],renderedSeries:this.renderer.renderedSeries[this.seriesIndex],value:c.getDataValue(this.renderer.series[this.seriesIndex].data[this.categoryIndex]),renderedValue:c.getDataValue(this.renderer.renderedSeries[this.seriesIndex].data[this.categoryIndex]),x:n,y:r,seriesSelected:!this.tb.options.tooltips.shared&&this.tb.selectedItem.series===this.renderer.series[this.seriesIndex],selected:this.tb.selectedItem.categoryIndex===this.categoryIndex&&(this.tb.options.tooltips.shared||this.tb.selectedItem.series===this.renderer.series[this.seriesIndex])},this.nextValue()}return t}}]),e}(u.BySeriesEnumerator);i.LineRenderer=f},{"./base":2,"./helpers/rect":9,"./helpers/utils":10,"./renderer.base":12}],14:[function(t,e,i){"use strict";var s=t("./helpers/rect").Rect,n=t("./base.js").Tayberry,r=t("./helpers/utils");n.mapVerticalPosition=function(t,e){switch(e){case"outside":return t>0?"bottom":"top";case"inside":return t>0?"top":"bottom";default:return"middle"}},n.prototype.mapLogicalXUnit=function(t){return this.scaleFactorX*t},n.prototype.mapLogicalYUnit=function(t){return this.scaleFactorY*t},n.prototype.mapScreenUnit=function(t){return t/this.scaleFactor},n.prototype.calculatePlotArea=function(){var t=this,e=5;this.plotArea=new s(0,0,this.labelsCanvas.width,this.labelsCanvas.height),this.options.title.text&&(this.plotArea.top+=this.mapLogicalYUnit(this.options.elementSmallPadding),this.plotArea.top+=this.getFontHeight(this.options.title.font)*this.getMultilineTextHeight(this.titleFont,this.labelsCanvas.width,this.options.title.text)),this.options.legend.enabled&&(this.plotArea.bottom-=this.mapLogicalYUnit(this.options.elementSmallPadding+this.options.elementLargePadding+this.options.legend.indicatorSize)),this.yAxes.map(function(e){return e.adjustSize(t.plotArea,!0,!0)}),this.xAxes.map(function(e){return e.adjustSize(t.plotArea,!0,!0)});for(var i=0;e>i&&(this.yAxes.map(function(t){return t.calculateExtent()}),this.xAxes.map(function(t){return t.calculateExtent()}),this.yAxes.map(function(t){return t.updateFormatter()}),this.xAxes.map(function(t){return t.updateFormatter()}),!r.none(this.yAxes.map(function(e){return e.adjustSize(t.plotArea)}))||!r.none(this.xAxes.map(function(e){return e.adjustSize(t.plotArea)})));i++);this.plotArea.left=Math.ceil(this.plotArea.left),this.plotArea.top=Math.ceil(this.plotArea.top),this.plotArea.right=Math.floor(this.plotArea.right),this.plotArea.bottom=Math.floor(this.plotArea.bottom)},n.prototype.hitTest=function(t,e){for(var i={found:!1},s=[],n=0;n<this.renderers.length;n++){var r=this.renderers[n].hitTest(t,e);r.found&&s.push(r)}return s.length&&(s.sort(function(t,e){return t.normalisedDistance-e.normalisedDistance}),i=s[0]),i}},{"./base.js":2,"./helpers/rect":9,"./helpers/utils":10}],15:[function(t,e,i){"use strict";!function(){var i=t("./base.js").Tayberry;t("./axis.js"),t("./core.js"),t("./drawing.js"),t("./events.js"),t("./defaults.js"),t("./sizing.js"),e.exports={create:function(t,e){var s=new i;s.create(t),s.setOptions(e),s.render()}}}()},{"./axis.js":1,"./base.js":2,"./core.js":3,"./defaults.js":4,"./drawing.js":5,"./events.js":6,"./sizing.js":14}]},{},[15])(15)});
//# sourceMappingURL=tayberry.min.js.map
